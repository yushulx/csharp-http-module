// 04/13/2018 120011 
var Dynamsoft=Dynamsoft||{Lib:{}},dynamsoft=dynamsoft||{};(function(b,c){var a=b.WebTwainEnv||(b.WebTwainEnv={});a.initQueue=[];a.inited=!1;c.initOrder=c.initOrder||[]})(Dynamsoft,dynamsoft);
Dynamsoft.WebTwainEnv.IfUseActiveXForIE10Plus=false;
var dynamsoft=dynamsoft||{};dynamsoft.lib=dynamsoft.lib||{};dynamsoft.lib.win=window;(function(lib,undefined){var OP=Object.prototype,AP=Array.prototype,_utilities_ver=20180115,toString=OP.toString,win=lib.win,_host=lib.win,nil=undefined,EMPTY_STR="",FALSE=!1,TRUE=!0,_console=FALSE,class2TypeMap={},mix,each,navInfo,isNil,types,mixIsFunctions;if(dynamsoft.lib._utilities_ver){if(dynamsoft.lib._utilities_ver>=_utilities_ver){return}}dynamsoft.lib._utilities_ver=_utilities_ver;lib.mix=mix=function(dest,source){for(var i in source){dest[i]=source[i]}return dest};isNil=function(o){return o===nil};isDef=function(o){return o!==nil};mix(lib,{isDef:isDef,isUndef:isNil,isUndefined:isNil,isNull:function(o){return(o===null)},isNaN:function(o){return isNaN(o)},type:function(o){if(o===null||o===nil){return String(o)}return class2TypeMap[toString.call(o)]||"object"},isPlainObject:function(obj){if(!obj||lib.type(obj)!=="object"||obj.nodeType||obj.window==obj){return FALSE}var key,objConstructor;try{if((objConstructor=obj.constructor)&&!hasOwnProperty(obj,"constructor")&&!hasOwnProperty(objConstructor.prototype,"isPrototypeOf")){return FALSE}}catch(e){return FALSE}for(key in obj){}return(isNil(key)||hasOwnProperty(obj,key))}});mixIsFunctions=function(name,lc){class2TypeMap["[object "+name+"]"]=(lc=name.toLowerCase());lib["is"+name]=function(o){return lib.type(o)===lc}};mixIsFunctions("Function");lib.each=each=function(object,fn,context){if(object){var key,val,keys,i=0,length=object.length,isObj=isNil(length)||lib.isFunction(object);context=context||null;if(isObj){keys=lib.keys(object);for(;i<keys.length;i++){key=keys[i];if(fn.call(context,object[key],key,object)===FALSE){break}}}else{for(val=object[0];i<length;val=object[++i]){if(fn.call(context,val,i,object)===FALSE){break}}}}return object};types=["String","Object","Boolean","Number"];if(Array.isArray){lib.isArray=Array.isArray}else{types.push("Array")}each(types,mixIsFunctions);if(!isNil(win.console)){_console=win.console;if(!lib.isFunction(_console.log)||!lib.isFunction(_console.error)){_console=false}}mix(lib,{debug:FALSE,log:function(txt){if(lib.debug&&_console){_console.log(txt)}},error:function(txt){if(lib.debug&&_console){_console.error(txt)}},getLogger:function(){var _=lib.log;return{warn:_,log:_,info:_,debug:_}},nil:nil,noop:function(){}});mix(lib,{startsWith:function(str,prefix){return str.lastIndexOf(prefix,0)===0},endsWith:function(str,suffix){var ind=str.length-suffix.length;return ind>=0&&str.indexOf(suffix,ind)===ind},replaceAll:function(str,sFind,sReplace){return str.replace(eval("/"+sFind+"/gi"),sReplace)},upperCaseFirst:function(str){return str.charAt(0).toUpperCase()+str.substr(1)},makeArray:function(o){if(o==null){return[]}if(lib.isArray(o)){return o}var lengthType=typeof o.length,oType=typeof o;if(lengthType!=="number"||o.alert||oType==="string"||(oType==="function"&&!("item" in o&&lengthType==="number"))){return[o]}var ret=[];for(var i=0,l=o.length;i<l;i++){ret[i]=o[i]}return ret}});var hasEnumBug=!({toString:1}.propertyIsEnumerable("toString")),enumProperties=["constructor","hasOwnProperty","isPrototypeOf","propertyIsEnumerable","toString","toLocaleString","valueOf"];lib.keys=Object.keys||function(o){var result=[],p,i;for(p in o){if(o.hasOwnProperty(p)){result.push(p)}}if(hasEnumBug){for(i=enumProperties.length-1;i>=0;i--){p=enumProperties[i];if(o.hasOwnProperty(p)){result.push(p)}}}return result};function hasOwnProperty(o,p){return OP.hasOwnProperty.call(o,p)}var doc=win.document,docElement=doc&&doc.documentElement,head=doc.getElementsByTagName("head")[0]||docElement,scriptOnload=doc.createElement("script").readyState?function(node,callback){var oldCallback=node.onreadystatechange;node.onreadystatechange=function(){var rs=node.readyState;if(rs==="loaded"||rs==="complete"){node.onreadystatechange=null;oldCallback&&oldCallback();callback.call(this)}}}:function(node,callback){node.addEventListener("load",callback,FALSE);node.addEventListener("error",callback,FALSE)};lib.getScript=function(url,isAsync,callback){var node,u;if(!lib.isFunction(callback)){callback=function(){}}if(!lib.isString(url)||url==EMPTY_STR){callback();return}node=doc.createElement("script");u=["",url].join(EMPTY_STR);node.src=u;if(isAsync){node.async=TRUE}node.charset="utf-8";scriptOnload(node,callback);head.insertBefore(node,head.firstChild);return node};lib.getCss=function(url,callback){var node,u,c=callback;if(!lib.isFunction(c)){c=!1}if(!lib.isString(url)||url==EMPTY_STR){c&&c();return}node=doc.createElement("link");node.href=url;node.rel="stylesheet";node.async=TRUE;c&&scriptOnload(node,c);head.insertBefore(node,head.firstChild);return node};lib.getRandom=function(){var a=new Date().getTime()%10000,b=[],tmp;for(var i=0;i<5;i++){tmp=Math.floor(Math.random()*10);if(i==0&&tmp==0){i=-1;continue}b.push(tmp)}if(a<10){b.push("000")}else{if(a<100){b.push("00")}else{if(a<1000){b.push("0")}}}b.push(a);return b.join("")};mix(lib,{get:function(id){return doc.getElementById(id)},hide:function(id){var o=lib.isString(id)?lib.get(id):id;if(o){o.style.display="none"}},show:function(id){var o=lib.isString(id)?lib.get(id):id;if(o){o.style.display=EMPTY_STR}},toggle:function(id){var o=lib.isString(id)?lib.get(id):id;if(o){if(o.style.display==="none"){o.style.display=EMPTY_STR}else{o.style.display="none"}}},empty:function(el){if(!el){return}while(el.firstChild){el.removeChild(el.firstChild)}},getOffset:function(evt,_parent,target){evt=evt||window.event;var el=target||evt.target,x=0,y=0,parentLeft=0,parentTop=0,scrollTop,scrollLeft,bFixed=false;while(el&&!isNaN(el.offsetLeft)&&!isNaN(el.offsetTop)){scrollLeft=el.scrollLeft;scrollTop=el.scrollTop;if(el.tagName==="BODY"){if(bFixed){scrollLeft=0;scrollTop=0}else{scrollLeft=scrollLeft|document.documentElement.scrollLeft;scrollTop=scrollTop|document.documentElement.scrollTop}}else{if(el.style.position==="fixed"){bFixed=true}}x+=el.offsetLeft-scrollLeft;y+=el.offsetTop-scrollTop;el=el.offsetParent}if(_parent){parentLeft=_parent.left;parentTop=_parent.top}x=evt.clientX-x-parentLeft;y=evt.clientY-y-parentTop;return{x:x,y:y}},getElDimensions:function(el,bOffset){var displayFormat,elDimensions;if(!el){return false}displayFormat=el.style.display;el.style.display="";elDimensions=bOffset?{offsetTop:el.offsetTop,offsetLeft:el.offsetLeft,offsetWidth:el.offsetWidth,offsetHeight:el.offsetHeight}:{clientTop:el.clientTop,clientLeft:el.clientLeft,clientWidth:el.clientWidth?el.clientWidth:(parseInt(el.style.width)?parseInt(el.style.width):0),clientHeight:el.clientHeight?el.clientHeight:(parseInt(el.style.height)?parseInt(el.style.height):0)};el.style.display=displayFormat;return elDimensions}});var ua=navigator.userAgent.toLowerCase(),_platform=navigator.platform.toLowerCase(),_protocol=doc.location.protocol,_ssl=(_protocol==="https:"),_bFileSystem=(_protocol!=="https:"&&_protocol!=="http:"),_bWin=(_platform=="win32")||(_platform=="win64")||(_platform=="windows"),_bMac=(_platform=="mac68k")||(_platform=="macppc")||(_platform=="macintosh")||(_platform=="macintel")||(_platform=="iphone"),_bLinux=(_platform.indexOf("linux")>=0),_isX64=(_platform=="win64")||(ua.indexOf("WOW64")>=0)||(ua.indexOf("x86_64")>=0)||(ua.indexOf("win64")>=0)||(ua.indexOf("x64")>=0),_nMSIE=ua.indexOf("msie"),_nTrident=ua.indexOf("trident"),_nRV=ua.indexOf("rv:"),_nEdge=ua.indexOf("edge"),_tmp=ua.match(/version\/([\d.]+).*safari/),_bSafari=_tmp?TRUE:FALSE,_nSafari=_tmp?_tmp[1]:0,_nFirefox=ua.indexOf("firefox"),_bFirefox=(_nFirefox!=-1),_bEdge=_bWin&&!_bFirefox&&(_nEdge!=-1),_indexOfChrome=ua.indexOf("chrome"),_bChrome=!_bEdge&&(_indexOfChrome!=-1),_bIE=_bWin&&!_bFirefox&&!_bEdge&&!_bChrome&&(_nMSIE!=-1||_nTrident!=-1||_nRV!=-1),_strIEVersion="",_IEMode=0,_bGecko=ua.match(/Gecko/)?TRUE:FALSE,_bHTML5Edition=FALSE,_strBrowserVersion=EMPTY_STR,_bQuerySelector=FALSE,_nativeJson=win.JSON,guidNum=0;if(_bEdge){_tmp=ua.slice(_nEdge+5);_tmp=_tmp.slice(0,_tmp.indexOf(" "));_strIEVersion=_tmp;_tmp=_tmp.slice(0,_tmp.indexOf("."));if(_tmp>=27){_bHTML5Edition=TRUE}}else{if(_bChrome){_tmp=ua.slice(_indexOfChrome+7);_tmp=_tmp.slice(0,_tmp.indexOf(" "));_strBrowserVersion=_tmp;_tmp=_tmp.slice(0,_tmp.indexOf("."));if(_tmp>=27){_bHTML5Edition=TRUE}}else{if(_bFirefox){_tmp=ua.slice(_nFirefox+8);_tmp=_tmp.slice(0,_tmp.indexOf(" "));_strBrowserVersion=_tmp;_tmp=_tmp.slice(0,_tmp.indexOf("."));if(_tmp>=27){_bHTML5Edition=TRUE}}else{if(_bIE){if(_nMSIE!=-1){_tmp=ua.slice(_nMSIE+4);_tmp=_tmp.slice(0,_tmp.indexOf(";"));_strIEVersion=_tmp}else{if(_nRV!=-1){_tmp=ua.slice(_nRV+3);_tmp=_tmp.slice(0,_tmp.indexOf(";"));_tmp=_tmp.slice(0,_tmp.indexOf(")"));_strIEVersion=_tmp}else{if(_nTrident!=-1){_tmp=ua.slice(_nTrident+7);_tmp=_tmp.slice(0,_tmp.indexOf(";"));_strIEVersion=_tmp}}}if(_strIEVersion===""||_strIEVersion>8){_bHTML5Edition=TRUE}_strBrowserVersion=_tmp}else{if(_bSafari){if(_tmp){_strBrowserVersion=_tmp[1]}_tmp=_nSafari;_tmp=_tmp.slice(0,_tmp.indexOf("."));if(_tmp>=7){_bHTML5Edition=TRUE}}}}}}if(_bEdge||_bIE){if(doc.documentMode){_IEMode=doc.documentMode}else{_IEMode=5;if(doc.compatMode){if(doc.compatMode=="CSS1Compat"){_IEMode=7}}}}if(docElement&&docElement.querySelector&&(!_bIE||_bIE&&(_strBrowserVersion>8))){_bQuerySelector=TRUE}if(_bIE&&_strBrowserVersion<9){_nativeJson=null}dynamsoft.navInfo=navInfo={host:_host,bSSL:_ssl,bFileSystem:_bFileSystem,bWin:_bWin,bMac:_bMac,bLinux:_bLinux,isX64:_isX64,bIE:_bIE,bEdge:_bEdge,bChrome:_bChrome,bFirefox:_bFirefox,bSafari:_bSafari,bGecko:_bGecko,bHTML5Edition:_bHTML5Edition,strBrowserVersion:_strBrowserVersion,IEMode:_IEMode,bQuerySelectorSupported:_bQuerySelector,nativeJson:_nativeJson,nodejs:FALSE,scrollBarWidth:false};var RE_TRIM=/^[\s\xa0]+|[\s\xa0]+$/g,trim=String.prototype.trim,indexOf=AP.indexOf,lastIndexOf=AP.lastIndexOf,filter=AP.filter,every=AP.every,some=AP.some,map=AP.map;mix(lib,{now:Date.now||function(){return +new Date()},guid:function(pre){return(pre||EMPTY_STR)+guidNum++},trim:trim?function(str){return str==null?EMPTY_STR:trim.call(str)}:function(str){return str==null?EMPTY_STR:(str+"").replace(RE_TRIM,EMPTY_STR)},filter:filter?function(arr,fn,context){return filter.call(arr,fn,context||this)}:function(arr,fn,context){var ret=[];each(arr,function(item,i,arr){if(fn.call(context||this,item,i,arr)){ret.push(item)}});return ret},indexOf:indexOf?function(item,arr){return indexOf.call(arr,item)}:function(item,arr){each(arr,function(v,k){if(v===item){return k}});return -1}});var logger=lib.getLogger(),SEP="&",EQ="=",HEX_BASE=16,htmlEntities={"&amp;":"&","&gt;":">","&lt;":"<","&#x60;":"`","&#x2F;":"/","&quot;":'"',"&#x27;":"'"},reverseEntities={},escapeReg,unEscapeReg,escapeRegExp=/[\-#$\^*()+\[\]{}|\\,.?\s]/g;(function(){for(var k in htmlEntities){reverseEntities[htmlEntities[k]]=k}})();function isValidParamValue(val){var t=typeof val;return val==null||(t!=="object"&&t!=="function")}function getEscapeReg(){if(escapeReg){return escapeReg}var str=EMPTY_STR;each(htmlEntities,function(entity){str+=entity+"|"});str=str.slice(0,-1);escapeReg=new RegExp(str,"g");return escapeReg}function getUnEscapeReg(){if(unEscapeReg){return unEscapeReg}var str=EMPTY_STR;each(reverseEntities,function(entity){str+=entity+"|"});str+="&#(\\d{1,5});";unEscapeReg=new RegExp(str,"g");return unEscapeReg}lib.mix(lib,{urlEncode:function(s){return encodeURIComponent(String(s))},urlDecode:function(s){return decodeURIComponent(s.replace(/\+/g," "))},fromUnicode:function(str){return str.replace(/\\u([a-f\d]{4})/ig,function(m,u){return String.fromCharCode(parseInt(u,HEX_BASE))})},escapeHtml:function(str){return(str+"").replace(getEscapeReg(),function(m){return reverseEntities[m]})},escapeRegExp:function(str){return str.replace(escapeRegExp,"\\$&")},unEscapeHtml:function(str){return str.replace(getUnEscapeReg(),function(m,n){return htmlEntities[m]||String.fromCharCode(+n)})},param:function(o,sep,eq,serializeArray){sep=sep||SEP;eq=eq||EQ;if(isNil(serializeArray)){serializeArray=TRUE}var buf=[],key,i,v,len,val,encode=lib.urlEncode;for(key in o){val=o[key];key=encode(key);if(isValidParamValue(val)){buf.push(key);if(isDef(val)){buf.push(eq,encode(val+EMPTY_STR))}buf.push(sep)}else{if(lib.isArray(val)&&val.length){for(i=0,len=val.length;i<len;++i){v=val[i];if(isValidParamValue(v)){buf.push(key,(serializeArray?encode("[]"):EMPTY_STR));if(isDef(v)){buf.push(eq,encode(v+EMPTY_STR))}buf.push(sep)}}}}}buf.pop();return buf.join(EMPTY_STR)},unparam:function(str,sep,eq){if(!lib.isString(str)||!(str=lib.trim(str))){return{}}sep=sep||SEP;eq=eq||EQ;var ret={},eqIndex,decode=lib.urlDecode,pairs=str.split(sep),key,val,i=0,len=pairs.length;for(;i<len;++i){eqIndex=lib.indexOf(eq,pairs[i]);if(eqIndex===-1){key=decode(pairs[i]);val=nil}else{key=decode(pairs[i].substring(0,eqIndex));val=pairs[i].substring(eqIndex+1);try{val=decode(val)}catch(e){logger.error("decodeURIComponent error : "+val);logger.error(e)}if(lib.endsWith(key,"[]")){key=key.substring(0,key.length-2)}}if(key in ret){if(lib.isArray(ret[key])){ret[key].push(val)}else{ret[key]=[ret[key],val]}}else{ret[key]=val}}return ret}});var splitPathRe=/^(\/?)([\s\S]+\/(?!$)|\/)?((?:\.{1,2}$|[\s\S]+?)?(\.[^.\/]*)?)$/;function normalizeArray(parts,allowAboveRoot){var up=0,i=parts.length-1,newParts=[],last;for(;i>=0;i--){last=parts[i];if(last!=="."){if(last===".."){up++}else{if(up){up--}else{newParts[newParts.length]=last}}}}if(allowAboveRoot){for(;up--;up){newParts[newParts.length]=".."}}newParts=newParts.reverse();return newParts}var Path=lib.Path={resolve:function(){var resolvedPath="",resolvedPathStr,i,args=(arguments),path,absolute=0;for(i=args.length-1;i>=0&&!absolute;i--){path=args[i];if(lib.isString(path)&&!!path){resolvedPath=path+"/"+resolvedPath;absolute=path.charAt(0)==="/"}}resolvedPathStr=normalizeArray(lib.filter(resolvedPath.split("/"),function(p){return !!p}),!absolute).join("/");return((absolute?"/":"")+resolvedPathStr)||"."},normalize:function(path){var absolute=path.charAt(0)==="/",trailingSlash=path.slice(-1)==="/";path=normalizeArray(lib.filter(path.split("/"),function(p){return !!p}),!absolute).join("/");if(!path&&!absolute){path="."}if(path&&trailingSlash){path+="/"}return(absolute?"/":"")+path},join:function(){var args=lib.makeArray(arguments);return Path.normalize(lib.filter(args,function(p){return p&&(lib.isString(p))}).join("/"))},relative:function(from,to){from=Path.normalize(from);to=Path.normalize(to);var fromParts=lib.filter(from.split("/"),function(p){return !!p}),path=[],sameIndex,sameIndex2,toParts=lib.filter(to.split("/"),function(p){return !!p}),commonLength=Math.min(fromParts.length,toParts.length);for(sameIndex=0;sameIndex<commonLength;sameIndex++){if(fromParts[sameIndex]!==toParts[sameIndex]){break}}sameIndex2=sameIndex;while(sameIndex<fromParts.length){path.push("..");sameIndex++}path=path.concat(toParts.slice(sameIndex2));path=path.join("/");return path},basename:function(path,ext){var result=path.match(splitPathRe)||[],basename;basename=result[3]||"";if(ext&&basename&&basename.slice(-1*ext.length)===ext){basename=basename.slice(0,-1*ext.length)}return basename},dirname:function(path){var result=path.match(splitPathRe)||[],root=result[1]||"",dir=result[2]||"";if(!root&&!dir){return"."}if(dir){dir=dir.substring(0,dir.length-1)}return root+dir},extname:function(path){return(path.match(splitPathRe)||[])[4]||""}};var logger=lib.getLogger(),reDisallowedInSchemeOrUserInfo=/[#\/\?@]/g,reDisallowedInPathName=/[#\?]/g,reDisallowedInQuery=/[#@]/g,reDisallowedInFragment=/#/g,URI_SPLIT_REG=new RegExp("^(?:([\\w\\d+.-]+):)?(?://(?:([^/?#@]*)@)?([\\w\\d\\-\\u0100-\\uffff.+%]*|\\[[^\\]]+\\])(?::([0-9]+))?)?([^?#]+)?(?:\\?([^#]*))?(?:#(.*))?$"),Path=lib.Path,REG_INFO={scheme:1,userInfo:2,hostname:3,port:4,path:5,query:6,fragment:7};function parseQuery(self){if(!self._queryMap){self._queryMap=lib.unparam(self._query)}}function Query(query){this._query=query||""}Query.prototype={constructor:Query,clone:function(){return new Query(this.toString())},reset:function(query){var self=this;self._query=query||"";self._queryMap=null;return self},count:function(){var self=this,count=0,_queryMap,k;parseQuery(self);_queryMap=self._queryMap;for(k in _queryMap){if(lib.isArray(_queryMap[k])){count+=_queryMap[k].length}else{count++}}return count},has:function(key){var self=this,_queryMap;parseQuery(self);_queryMap=self._queryMap;if(key){return key in _queryMap}else{return !lib.isEmptyObject(_queryMap)}},get:function(key){var self=this,_queryMap;parseQuery(self);_queryMap=self._queryMap;if(key){return _queryMap[key]}else{return _queryMap}},keys:function(){var self=this;parseQuery(self);return lib.keys(self._queryMap)},set:function(key,value){var self=this,_queryMap;parseQuery(self);_queryMap=self._queryMap;if(lib.isString(key)){self._queryMap[key]=value}else{if(key instanceof Query){key=key.get()}each(key,function(v,k){_queryMap[k]=v})}return self},remove:function(key){var self=this;parseQuery(self);if(key){delete self._queryMap[key]}else{self._queryMap={}}return self},add:function(key,value){var self=this,_queryMap,currentValue;if(lib.isString(key)){parseQuery(self);_queryMap=self._queryMap;currentValue=_queryMap[key];if(isNil(currentValue)){currentValue=value}else{currentValue=[].concat(currentValue).concat(value)}_queryMap[key]=currentValue}else{if(key instanceof Query){key=key.get()}for(var k in key){self.add(k,key[k])}}return self},toString:function(serializeArray){var self=this;parseQuery(self);return lib.param(self._queryMap,nil,nil,serializeArray)}};function padding2(str){return str.length===1?"0"+str:str}function equalsIgnoreCase(str1,str2){return str1.toLowerCase()===str2.toLowerCase()}function encodeSpecialChars(str,specialCharsReg){return encodeURI(str).replace(specialCharsReg,function(m){return"%"+padding2(m.charCodeAt(0).toString(16))})}function Uri(uriStr){if(uriStr instanceof Uri){return uriStr.clone()}var components,self=this;lib.mix(self,{scheme:"",userInfo:"",hostname:"",port:"",path:"",query:"",fragment:""});components=Uri.getComponents(uriStr);each(components,function(v,key){v=v||"";if(key==="query"){self.query=new Query(v)}else{try{v=lib.urlDecode(v)}catch(e){logger.error(e+"urlDecode error : "+v)}self[key]=v}});return self}Uri.prototype={constructor:Uri,clone:function(){var uri=new Uri(),self=this;each(REG_INFO,function(index,key){uri[key]=self[key]});uri.query=uri.query.clone();return uri},resolve:function(relativeUri){if(lib.isString(relativeUri)){relativeUri=new Uri(relativeUri)}var self=this,override=0,lastSlashIndex,order=["scheme","userInfo","hostname","port","path","query","fragment"],target=self.clone();each(order,function(o){if(o==="path"){if(override){target[o]=relativeUri[o]}else{var path=relativeUri.path;if(path){override=1;if(!lib.startsWith(path,"/")){if(target.hostname&&!target.path){path="/"+path}else{if(target.path){lastSlashIndex=target.path.lastIndexOf("/");if(lastSlashIndex!==-1){path=target.path.slice(0,lastSlashIndex+1)+path}}}}target.path=Path.normalize(path)}}}else{if(o==="query"){if(override||relativeUri.query.toString()){target.query=relativeUri.query.clone();override=1}}else{if(override||relativeUri[o]){target[o]=relativeUri[o];override=1}}}});return target},getScheme:function(){return this.scheme},setScheme:function(scheme){this.scheme=scheme;return this},getHostname:function(){return this.hostname},setHostname:function(hostname){this.hostname=hostname;return this},setUserInfo:function(userInfo){this.userInfo=userInfo;return this},getUserInfo:function(){return this.userInfo},setPort:function(port){this.port=port;return this},getPort:function(){return this.port},setPath:function(path){this.path=path;return this},getPath:function(){return this.path},setQuery:function(query){if(lib.isString(query)){if(lib.startsWith(query,"?")){query=query.slice(1)}query=new Query(encodeSpecialChars(query,reDisallowedInQuery))}this.query=query;return this},getQuery:function(){return this.query},getFragment:function(){return this.fragment},setFragment:function(fragment){var self=this;if(lib.startsWith(fragment,"#")){fragment=fragment.slice(1)}self.fragment=fragment;return self},isSameOriginAs:function(other){var self=this;return equalsIgnoreCase(self.hostname,other.hostname)&&equalsIgnoreCase(self.scheme,other.scheme)&&equalsIgnoreCase(self.port,other.port)},toString:function(serializeArray){var out=[],self=this,scheme,hostname,path,port,fragment,query,userInfo;if((scheme=self.scheme)){out.push(encodeSpecialChars(scheme,reDisallowedInSchemeOrUserInfo));out.push(":")}if((hostname=self.hostname)){out.push("//");if((userInfo=self.userInfo)){out.push(encodeSpecialChars(userInfo,reDisallowedInSchemeOrUserInfo));out.push("@")}out.push(encodeURIComponent(hostname));if((port=self.port)){out.push(":");out.push(port)}}if((path=self.path)){if(hostname&&!lib.startsWith(path,"/")){path="/"+path}path=Path.normalize(path);out.push(encodeSpecialChars(path,reDisallowedInPathName))}if((query=(self.query.toString.call(self.query,serializeArray)))){out.push("?");out.push(query)}if((fragment=self.fragment)){out.push("#");out.push(encodeSpecialChars(fragment,reDisallowedInFragment))}return out.join("")}};Uri.Query=Query;Uri.getComponents=function(url){url=url||EMPTY_STR;var m=url.match(URI_SPLIT_REG)||[],ret={};each(REG_INFO,function(index,key){ret[key]=m[index]});return ret};lib.Uri=Uri;var logger=lib.getLogger();var doc=win.document,docElem=doc&&doc.documentElement,location=win.location,domReady=0,callbacks=[],POLL_RETIRES=500,POLL_INTERVAL=40,RE_ID_STR=/^#?([\w-]+)$/,RE_NOT_WHITESPACE=/\S/,standardEventModel=!!(doc&&doc.addEventListener),DOM_READY_EVENT="DOMContentLoaded",READY_STATE_CHANGE_EVENT="readystatechange",LOAD_EVENT="load",COMPLETE="complete",addEventListener=standardEventModel?function(el,type,fn){el.addEventListener(type,fn,false)}:function(el,type,fn){el.attachEvent("on"+type,fn)},removeEventListener=standardEventModel?function(el,type,fn){el.removeEventListener(type,fn,false)}:function(el,type,fn){el.detachEvent("on"+type,fn)};lib.mix(lib,{isWindow:function(obj){return obj!=null&&obj==obj.window},globalEval:function(data){if(data&&RE_NOT_WHITESPACE.test(data)){if(win.execScript){win.execScript(data)}else{(function(data){win.eval.call(win,data)})(data)}}},ready:function(fn){if(domReady){try{fn(lib)}catch(e){lib.log(e.stack||e,"error");setTimeout(function(){throw e},0)}}else{callbacks.push(fn)}return this}});function fireReady(){if(domReady){return}if(doc&&!navInfo.nodejs){removeEventListener(win,LOAD_EVENT,fireReady)}domReady=1;for(var i=0;i<callbacks.length;i++){try{callbacks[i](lib)}catch(e){lib.log(e.stack||e,"error");setTimeout(function(){throw e},0)}}}function bindReady(){if(!doc||doc.readyState===COMPLETE){fireReady();return}addEventListener(win,LOAD_EVENT,fireReady);if(standardEventModel){var domReady=function(){removeEventListener(doc,DOM_READY_EVENT,domReady);fireReady()};addEventListener(doc,DOM_READY_EVENT,domReady)}else{var stateChange=function(){if(doc.readyState===COMPLETE){removeEventListener(doc,READY_STATE_CHANGE_EVENT,stateChange);fireReady()}};addEventListener(doc,READY_STATE_CHANGE_EVENT,stateChange);var notframe,doScroll=docElem&&docElem.doScroll;try{notframe=(win.frameElement===null)}catch(e){notframe=false}if(doScroll&&notframe){var readyScroll=function(){try{doScroll("left");fireReady()}catch(ex){setTimeout(readyScroll,POLL_INTERVAL)}};readyScroll()}}}bindReady();if(navInfo.bIE){try{doc.execCommand("BackgroundImageCache",false,true)}catch(e){}}lib.switchEvent=function(e){e=e||window.event;if(e.which==null){e.which=(e.button<2)?1:((e.button==4)?2:3)}else{e.which=(e.which<2)?1:((e.which==2)?2:3)}return e};lib.currentStyle=function(obj,prop){if(obj.currentStyle){return obj.currentStyle[prop]}else{if(window.getComputedStyle){propprop=prop.replace(/([A-Z])/g,"-$1");propprop=prop.toLowerCase();return document.defaultView.getComputedStyle(obj,null)[prop]}}return null};lib.extend=function(ParentClass,childAddConstructor){var ChildClass=function(){ParentClass.apply(this,arguments);if(childAddConstructor){childAddConstructor.apply(this,arguments)}};for(var i in ParentClass.prototype){ChildClass.prototype[i]=ParentClass.prototype[i]}ChildClass.prototype.constructor=ChildClass;return ChildClass};lib.colorStrToInt=function(str){var mystr="0x";if(/^(rgb|RGB)/.test(str)){var nums=str.replace(/[^\d,.]/g,"").split(",");for(var i=0;i<3;++i){var hex=Number(nums[i]).toString(16);if(hex.length==1){hex="0"+hex}mystr+=hex}if(nums.length==4){var hex=Math.round(Number(nums[i])*255).toString(16);if(hex.length==1){hex="0"+hex}mystr+=hex}else{mystr+="ff"}}else{if(str=="transparent"){mystr+="00000000"}else{if(/^#[0-9a-fA-f]{6}$/.test(str)){mystr+=str.replace(/#/,"")+"ff"}else{if(/^#[0-9a-fA-f]{3}$/.test(str)){for(var i=0;i<3;++i){mystr+=str[i]+str[i]}mystr+="ff"}else{mystr="-1"}}}}return Number(mystr)};lib.IntToColorStr=function(value){if(value>4294967295||value<0){return null}var str;if(!navInfo.bHTML5Edition){if(value%256==0){str="transparent"}else{str=Math.floor(value/256).toString(16);while(str.length!=6){str="0"+str}str="#"+str}}else{str="rgba("+Math.floor(value/16777216)+","+Math.floor(value/65536)%256+","+Math.floor(value/256)%256+","+(value%256)/255+")"}return str};var customEvent={fire:function(type){var self=this,args;self.exec=self.exec||{};type=type.toLowerCase();args=AP.slice.call(arguments,1);each(self.exec[type]||[],function(item){var fn=item.f,ctx=item.c||self;try{fn.apply(ctx,args)}catch(e){console.log(e)}})},on:function(type,fn,ctx){var self=this;self.exec=self.exec||{};type=type.toLowerCase();self.exec[type]=self.exec[type]||[];self.exec[type].push({f:fn,c:ctx})},off:function(type,fn,c){var self=this,exec=self.exec;if(!exec){return}if(!type){self.exec=null;return}type=type.toLowerCase();if(!fn){exec[type]=null;return}var arr=exec[type]||[];for(var i=arr.length-1;i>=0;i--){if(arr[i]===fn){arr.splice(i,1)}}}};function Attributes(config){var self=this;self.__attrs={};self.__attrVals={};self.userConfig=config;while(c){self.addAttrs(c.ATTRS);c=c.superclass?c.superclass.constructor:null}lib.mix(self.__attrs,config)}lib.mix(Attributes.prototype,{get:function(name){var self=this;if(name in self.__attrs){return self.__attrs[name]}return""},set:function(name,v){var self=this;if(name in self.__attrs){self.__attrs[name]=v}},addAttrs:function(attrsConfig){lib.mix(this.__attrs,attrsConfig)}});Attributes.extend=function(px){var SuperClass=this,childAddConstructor,ret;px=px||{};if(px.constructor){childAddConstructor=px.constructor}ret=extend(SuperClass,childAddConstructor);lib.mix(ret,px);return ret};lib.obj={Attributes:Attributes,customEvent:customEvent}})(dynamsoft.lib);(function(s){var v=20180115;if(s._sizzle_ver){if(s.isNumber(s._sizzle_ver)&&s._sizzle_ver>=v){return}}s._sizzle_ver=v;var ap,g=RegExp,ad,aa,d,k,t,ak,X,T,r,u,o,p,an=!0,f,L,b,R,al="dws_"+1*new Date(),am=window.document,J=0,x=0,ah=at(),ai=at(),F=at(),y=function(i,e){if(i===e){r=true}return 0},H=[],U=H.pop,Z=H.push,aj=H.push,D=H.slice,G=function(aw,av){var au=0,e=aw.length;for(;au<e;au++){if(aw[au]===av){return au}}return -1},af="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",P="[\\x20\\t\\r\\n\\f]",A="(?:\\\\.|[\\w-]|[^\0-\\xa0])+",ac=["\\[",P,"*(",A,")(?:",P,"*([*^$|!~]?=)",P,"*(?:'((?:\\\\.|[^\\\\'])*)'|\"((?:\\\\.|[^\\\\\"])*)\"|(",A,"))|)",P,"*\\]"].join(""),C=new g(P+"+","g"),ag=new g(["^",P,"+|((?:^|[^\\\\])(?:\\\\.)*)",P,"+$"].join(""),"g"),m=new g(["^",P,"*,",P,"*"].join("")),W=new g(["^",P,"*([>+~]|",P,")",P,"*"].join("")),E=new g("="+P+"*([^\\]'\"]*?)"+P+"*\\]","g"),h=new g("^"+A+"$"),V={ID:new g("^#("+A+")"),CLASS:new g("^\\.("+A+")"),TAG:new g("^("+A+"|[*])"),ATTR:new g("^"+ac),needsContext:new g(["^",P,"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\(",P,"*((?:-\\d)?\\d*)",P,"*\\)|)(?=[^-]|$)"].join(""),"i")},K=/^[^{]+\{\s*\[native \w/,ab=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,Q=/([\0-\x1f\x7f]|^-?\d)|^-$|[^\0-\x1f\x7f-\uFFFF\w-]/g,l=function(i,e){if(e){if(i==="\0"){return"\uFFFD"}return i.slice(0,-1)+"\\"+i.charCodeAt(i.length-1).toString(16)+" "}return"\\"+i},q=function(){u()};try{aj.apply((H=D.call(am.childNodes)),am.childNodes);H[am.childNodes.length].nodeType}catch(ar){aj={apply:H.length?function(i,e){Z.apply(i,D.call(e))}:function(aw,av){var e=aw.length,au=0;while((aw[e++]=av[au++])){}aw.length=e-1}}}function ae(aA,au,aD,aG){var ay,aE,ax,e,aF,aw,aB,av=au&&au.ownerDocument,aC=au?au.nodeType:9;aD=aD||[];if(typeof aA!=="string"||!aA||aC!==1&&aC!==9&&aC!==11){return aD}if(!aG){if((au?au.ownerDocument||au:am)!==o){u(au)}au=au||o;if(aC!==11&&(aF=ab.exec(aA))){if((ay=aF[1])){if(aC===9){if((ax=au.getElementById(ay))){if(ax.id===ay){aD.push(ax);return aD}}else{return aD}}else{if(av&&(ax=av.getElementById(ay))&&R(au,ax)&&ax.id===ay){aD.push(ax);return aD}}}else{if(aF[2]){aj.apply(aD,au.getElementsByTagName(aA));return aD}else{if((ay=aF[3])&&ad.getElementsByClassName&&au.getElementsByClassName){aj.apply(aD,au.getElementsByClassName(ay));return aD}}}}if(ad.qsa&&!F[aA+" "]&&(!f||!f.test(aA))){if(aC!==1){av=au;aB=aA}else{if(au.nodeName.toLowerCase()!=="object"){if((e=au.getAttribute("id"))){e=e.replace(Q,l)}else{au.setAttribute("id",(e=al))}aw=k(aA);aE=aw.length;while(aE--){aw[aE]="#"+e+" "+a(aw[aE])}aB=aw.join(",");av=au}}if(aB){try{aj.apply(aD,av.querySelectorAll(aB));return aD}catch(az){}finally{if(e===al){au.removeAttribute("id")}}}}}return ak(aA.replace(ag,"$1"),au,aD,aG)}function at(){var i=[];function e(au,av){if(i.push(au+" ")>aa.cacheLength){delete e[i.shift()]}return(e[au+" "]=av)}return e}function ao(e){e[al]=true;return e}function Y(au){var i=o.createElement("fieldset");try{return !!au(i)}catch(av){return false}finally{if(i.parentNode){i.parentNode.removeChild(i)}i=null}}function z(e,i){}function j(i,e){var av=e&&i,au=av&&i.nodeType===1&&e.nodeType===1&&i.sourceIndex-e.sourceIndex;if(au){return au}if(av){while((av=av.nextSibling)){if(av===e){return -1}}}return i?1:-1}function S(e){return e&&typeof e.getElementsByTagName!=="undefined"&&e}ad=ae.support={};u=ae.setDocument=function(au){var e,i,av=au?au.ownerDocument||au:am;if(av===o||av.nodeType!==9||!av.documentElement){return o}o=av;p=o.documentElement;if(am!==o&&(i=o.defaultView)&&i.top!==i){if(i.addEventListener){i.addEventListener("unload",q,false)}else{if(i.attachEvent){i.attachEvent("onunload",q)}}}ad.attributes=Y(function(aw){aw.className="i";return !aw.getAttribute("className")});ad.getElementsByTagName=Y(function(aw){aw.appendChild(o.createComment(""));return !aw.getElementsByTagName("*").length});ad.getElementsByClassName=K.test(o.getElementsByClassName);ad.getById=Y(function(aw){p.appendChild(aw).id=al;return !o.getElementsByName||!o.getElementsByName(al).length});if(ad.getById){aa.filter.ID=function(ax){var aw=ax;return function(ay){return ay.getAttribute("id")===aw}}}else{aa.filter.ID=function(ax){var aw=new g(["^",ax,"$"].join(""),"g");return function(az){var ay=typeof az.getAttributeNode!=="undefined"&&az.getAttributeNode("id");return ay&&aw.test(ay.value)}}}aa.find.TAG=ad.getElementsByTagName?function(aw,ax){if(typeof ax.getElementsByTagName!=="undefined"){return ax.getElementsByTagName(aw)}else{if(ad.qsa){return ax.querySelectorAll(aw)}}}:function(aw,aA){var aB,az=[],ay=0,ax=aA.getElementsByTagName(aw);if(aw==="*"){while((aB=ax[ay++])){if(aB.nodeType===1){az.push(aB)}}return az}return ax};aa.find.CLASS=ad.getElementsByClassName&&function(ax,aw){if(typeof aw.getElementsByClassName!=="undefined"){return aw.getElementsByClassName(ax)}};L=[];f=[];if((ad.qsa=K.test(o.querySelectorAll))){Y(function(aw){p.appendChild(aw).innerHTML="<a id='"+al+"'></a><select id='"+al+"-\r\\' msallowcapture=''><option selected=''></option></select>";if(aw.querySelectorAll("[msallowcapture^='']").length){f.push("[*^$]="+P+"*(?:''|\"\")")}if(!aw.querySelectorAll("[selected]").length){f.push("\\["+P+"*(?:value|"+af+")")}if(!aw.querySelectorAll("[id~="+al+"-]").length){f.push("~=")}if(!aw.querySelectorAll(":checked").length){f.push(":checked")}if(!aw.querySelectorAll("a#"+al+"+*").length){f.push(".#.+[+~]")}});Y(function(ax){ax.innerHTML="<a href='' disabled='disabled'></a><select disabled='disabled'><option/></select>";var aw=o.createElement("input");aw.setAttribute("type","hidden");ax.appendChild(aw).setAttribute("name","D");if(ax.querySelectorAll("[name=d]").length){f.push("name"+P+"*[*^$|!~]?=")}if(ax.querySelectorAll(":enabled").length!==2){f.push(":enabled",":disabled")}p.appendChild(ax).disabled=true;if(ax.querySelectorAll(":disabled").length!==2){f.push(":enabled",":disabled")}ax.querySelectorAll("*,:x");f.push(",.*:")})}if((ad.matchesSelector=K.test((b=p.matches||p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector)))){Y(function(aw){ad.disconnectedMatch=b.call(aw,"*");b.call(aw,"[s!='']:x")})}f=f.length&&new g(f.join("|"));L=L.length&&new g(L.join("|"));e=K.test(p.compareDocumentPosition);R=e||K.test(p.contains)?function(ax,aw){var az=ax.nodeType===9?ax.documentElement:ax,ay=aw&&aw.parentNode;return ax===ay||!!(ay&&ay.nodeType===1&&(az.contains?az.contains(ay):ax.compareDocumentPosition&&ax.compareDocumentPosition(ay)&16))}:function(ax,aw){if(aw){while((aw=aw.parentNode)){if(aw===ax){return true}}}return false};y=e?function(ax,aw){if(ax===aw){r=true;return 0}var ay=!ax.compareDocumentPosition-!aw.compareDocumentPosition;if(ay){return ay}ay=(ax.ownerDocument||ax)===(aw.ownerDocument||aw)?ax.compareDocumentPosition(aw):1;if(ay&1||(!ad.sortDetached&&aw.compareDocumentPosition(ax)===ay)){if(ax===o||ax.ownerDocument===am&&R(am,ax)){return -1}if(aw===o||aw.ownerDocument===am&&R(am,aw)){return 1}return T?(G(T,ax)-G(T,aw)):0}return ay&4?-1:1}:function(ax,aw){if(ax===aw){r=true;return 0}var aD,aA=0,aC=ax.parentNode,az=aw.parentNode,ay=[ax],aB=[aw];if(!aC||!az){return ax===o?-1:aw===o?1:aC?-1:az?1:T?(G(T,ax)-G(T,aw)):0}else{if(aC===az){return j(ax,aw)}}aD=ax;while((aD=aD.parentNode)){ay.unshift(aD)}aD=aw;while((aD=aD.parentNode)){aB.unshift(aD)}while(ay[aA]===aB[aA]){aA++}return aA?j(ay[aA],aB[aA]):ay[aA]===am?-1:aB[aA]===am?1:0};return o};ae.matches=function(i,e){return ae(i,null,null,e)};ae.matchesSelector=function(au,aw){if((au.ownerDocument||au)!==o){u(au)}aw=aw.replace(E,"='$1']");if(ad.matchesSelector&&!F[aw+" "]&&(!L||!L.test(aw))&&(!f||!f.test(aw))){try{var i=b.call(au,aw);if(i||ad.disconnectedMatch||au.document&&au.document.nodeType!==11){return i}}catch(av){}}return ae(aw,o,null,[au]).length>0};ae.contains=function(e,i){if((e.ownerDocument||e)!==o){u(e)}return R(e,i)};ae.escape=function(e){return(e+"").replace(Q,l)};ae.error=function(e){throw new Error("Syntax error, unrecognized expression: "+e)};ae.uniqueSort=function(av){var aw,ax=[],e=0,au=0;r=!ad.detectDuplicates;T=!ad.sortStable&&av.slice(0);av.sort(y);if(r){while((aw=av[au++])){if(aw===av[au]){e=ax.push(au)}}while(e--){av.splice(ax[e],1)}}T=null;return av};d=ae.getText=function(ax){var aw,au="",av=0,e=ax.nodeType;if(!e){while((aw=ax[av++])){au+=d(aw)}}else{if(e===1||e===9||e===11){if(typeof ax.textContent==="string"){return ax.textContent}else{for(ax=ax.firstChild;ax;ax=ax.nextSibling){au+=d(ax)}}}else{if(e===3||e===4){return ax.nodeValue}}}return au};aa=ae.selectors={cacheLength:50,match:V,find:{},relative:{">":{dir:"parentNode",first:true}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:true},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){e[3]=(e[3]||e[4]||e[5]||"");if(e[2]==="~="){e[3]=" "+e[3]+" "}return e.slice(0,4)}},filter:{TAG:function(i){var e=i.toLowerCase();return i==="*"?function(){return true}:function(au){return au.nodeName&&au.nodeName.toLowerCase()===e}},CLASS:function(e){var i=ah[e+" "];return i||(i=new g("(^|"+P+")"+e+"("+P+"|$)"))&&ah(e,function(au){return i.test(typeof au.className==="string"&&au.className||typeof au.getAttribute!=="undefined"&&au.getAttribute("class")||"")})},ATTR:function(au,i,e){return function(aw){var av=ae.attr(aw,au);if(av==null){return i==="!="}if(!i){return true}av+="";return i==="="?av===e:i==="!="?av!==e:i==="^="?e&&av.indexOf(e)===0:i==="*="?e&&av.indexOf(e)>-1:i==="$="?e&&av.slice(-e.length)===e:i==="~="?(" "+av.replace(C," ")+" ").indexOf(e)>-1:i==="|="?av===e||av.slice(0,e.length+1)===e+"-":false}}}};function B(){}B.prototype=aa.filters=aa.pseudos;aa.setFilters=new B();k=ae.tokenize=function(aw,aB){var i,ax,az=[],aA,ay,au,e,av=ai[aw+" "];if(av){return aB?0:av.slice(0)}ay=aw;au=[];e=aa.preFilter;while(ay){if(!i||(ax=m.exec(ay))){if(ax){ay=ay.slice(ax[0].length)||ay}au.push((az=[]))}i=false;if((ax=W.exec(ay))){i=ax.shift();az.push({value:i,type:ax[0].replace(ag," ")});ay=ay.slice(i.length)}for(aA in aa.filter){if((ax=V[aA].exec(ay))&&(!e[aA]||(ax=e[aA](ax)))){i=ax.shift();az.push({value:i,type:aA,matches:ax});ay=ay.slice(i.length)}}if(!i){break}}return aB?ay.length:ay?ae.error(aw):ai(aw,au).slice(0)};function a(aw){var av=0,au=aw.length,e="";for(;av<au;av++){e+=aw[av].value}return e}function N(ay,aw,ax){var e=aw.dir,av=aw.next,au=av||e,az=ax&&au==="parentNode",i=x++;return aw.first?function(aC,aB,aA){while((aC=aC[e])){if(aC.nodeType===1||az){return ay(aC,aB,aA)}}return false}:function(aF,aD,aC){var aG,aA,aE,aB=[J,i];if(aC){while((aF=aF[e])){if(aF.nodeType===1||az){if(ay(aF,aD,aC)){return true}}}}else{while((aF=aF[e])){if(aF.nodeType===1||az){aE=aF[al]||(aF[al]={});aA=aE[aF.uniqueID]||(aE[aF.uniqueID]={});if(av&&av===aF.nodeName.toLowerCase()){aF=aF[e]||aF}else{if((aG=aA[au])&&aG[0]===J&&aG[1]===i){return(aB[2]=aG[2])}else{aA[au]=aB;if((aB[2]=ay(aF,aD,aC))){return true}}}}}}return false}}function w(e){return e.length>1?function(ax,aw,au){var av=e.length;while(av--){if(!e[av](ax,aw,au)){return false}}return true}:e[0]}function I(au,ax,aw){var av=0,e=ax.length;for(;av<e;av++){ae(au,ax[av],aw)}return aw}function M(e,au,av,aw,az){var ax,aC=[],ay=0,aA=e.length,aB=au!=null;for(;ay<aA;ay++){if((ax=e[ay])){if(!av||av(ax,aw,az)){aC.push(ax);if(aB){au.push(ay)}}}}return aC}function aq(au,i,aw,av,ax,e){if(av&&!av[al]){av=aq(av)}if(ax&&!ax[al]){ax=aq(ax,e)}return ao(function(aI,aF,aA,aH){var aK,aG,aC,aB=[],aJ=[],az=aF.length,ay=aI||I(i||"*",aA.nodeType?[aA]:aA,[]),aD=au&&(aI||!i)?M(ay,aB,au,aA,aH):ay,aE=aw?ax||(aI?au:az||av)?[]:aF:aD;if(aw){aw(aD,aE,aA,aH)}if(av){aK=M(aE,aJ);av(aK,[],aA,aH);aG=aK.length;while(aG--){if((aC=aK[aG])){aE[aJ[aG]]=!(aD[aJ[aG]]=aC)}}}if(aI){if(ax||au){if(ax){aK=[];aG=aE.length;while(aG--){if((aC=aE[aG])){aK.push((aD[aG]=aC))}}ax(null,(aE=[]),aK,aH)}aG=aE.length;while(aG--){if((aC=aE[aG])&&(aK=ax?G(aI,aC):aB[aG])>-1){aI[aK]=!(aF[aK]=aC)}}}}else{aE=M(aE===aF?aE.splice(az,aE.length):aE);if(ax){ax(null,aF,aE,aH)}else{aj.apply(aF,aE)}}})}function O(az){var au,ax,av,ay=az.length,aC=aa.relative[az[0].type],aD=aC||aa.relative[" "],aw=aC?1:0,aA=N(function(i){return i===au},aD,true),aB=N(function(i){return G(au,i)>-1},aD,true),e=[function(aG,aF,aE){var i=(!aC&&(aE||aF!==X))||((au=aF).nodeType?aA(aG,aF,aE):aB(aG,aF,aE));au=null;return i}];for(;aw<ay;aw++){if((ax=aa.relative[az[aw].type])){e=[N(w(e),ax)]}else{ax=aa.filter[az[aw].type].apply(null,az[aw].matches);if(ax[al]){av=++aw;for(;av<ay;av++){if(aa.relative[az[av].type]){break}}return aq(aw>1&&w(e),aw>1&&a(az.slice(0,aw-1).concat({value:az[aw-2].type===" "?"*":""})).replace(ag,"$1"),ax,aw<av&&O(az.slice(aw,av)),av<ay&&O((az=az.slice(av))),av<ay&&a(az))}e.push(ax)}}return w(e)}function n(av,au){var e=au.length>0,aw=av.length>0,i=function(aG,aA,aF,aE,aJ){var aB,aC,aH,aL=0,aD="0",ax=aG&&[],aM=[],aK=X,az=aG||aw&&aa.find.TAG("*",aJ),ay=(J+=aK==null?1:Math.random()||0.1),aI=az.length;if(aJ){X=aA===o||aA||aJ}for(;aD!==aI&&(aB=az[aD])!=null;aD++){if(aw&&aB){aC=0;if(!aA&&aB.ownerDocument!==o){u(aB);aF=!an}while((aH=av[aC++])){if(aH(aB,aA||o,aF)){aE.push(aB);break}}if(aJ){J=ay}}if(e){if((aB=!aH&&aB)){aL--}if(aG){ax.push(aB)}}}aL+=aD;if(e&&aD!==aL){aC=0;while((aH=au[aC++])){aH(ax,aM,aA,aF)}if(aG){if(aL>0){while(aD--){if(!(ax[aD]||aM[aD])){aM[aD]=U.call(aE)}}}aM=M(aM)}aj.apply(aE,aM);if(aJ&&!aG&&aM.length>0&&(aL+au.length)>1){ae.uniqueSort(aE)}}if(aJ){J=ay;X=aK}return ax};return e?ao(i):i}t=ae.compile=function(e,av){var aw,au=[],ay=[],ax=F[e+" "];if(!ax){if(!av){av=k(e)}aw=av.length;while(aw--){ax=O(av[aw]);if(ax[al]){au.push(ax)}else{ay.push(ax)}}ax=F(e,n(ay,au));ax.selector=e}return ax};ak=ae.select=function(e,ay,ax,au){var aw,az=typeof e==="function"&&e,av=!au&&k((e=az.selector||e));ax=ax||[];(az||t(e,av))(au,ay,!an,ax,!ay||ay);return ax};ad.sortStable=al.split("").sort(y).join("")===al;ad.detectDuplicates=!!r;u();ad.sortDetached=Y(function(e){return e.compareDocumentPosition(o.createElement("fieldset"))&1});if(!Y(function(e){e.innerHTML="<a href='#'></a>";return e.firstChild.getAttribute("href")==="#"})){z("type|href|height|width",function(i,e){return i.getAttribute(e,e.toLowerCase()==="type"?1:2)})}if(!ad.attributes||!Y(function(e){e.innerHTML="<input/>";e.firstChild.setAttribute("value","");return e.firstChild.getAttribute("value")===""})){z("value",function(i,e){if(i.nodeName.toLowerCase()==="input"){return i.defaultValue}})}if(!Y(function(e){return e.getAttribute("disabled")==null})){z(af,function(i,e){var au;return i[e]===true?e.toLowerCase():(au=i.getAttributeNode(e))&&au.specified?au.value:null})}s.support=ad;s.all=ae})(dynamsoft.lib);(function(l){var ac=Array.prototype,x=ac.slice,W=ac.push,t=l.makeArray,h=document,f=h.documentElement;var s=20180115;if(l._dom_ver){if(l.isNumber(l._dom_ver)&&l._dom_ver>=s){return}}l._dom_ver=s;function M(aj,ak,ai){var ah=this;if(!(ah instanceof M)){return new M(aj,ak,ai)}if(!aj){return ah}if(typeof aj==="string"){l.error("Err 4001.");return ah}if(l.isArray(aj)||aj.isNodeList){W.apply(ah,t(aj));return ah}ah[0]=aj;ah.length=1;return ah}var I;I=M.prototype={isNodeList:true,length:0,item:function(ai){var ah=this;if(l.isNumber(ai)){if(ai>=ah.length){return null}else{return new M(ah[ai])}}else{return new M(ai)}},slice:function(){return new M(x.apply(this,arguments))},getDOMNodes:function(){return x.call(this)},each:function(aj,ai){var ah=this;l.each(ah,function(al,ak){al=new M(al);return aj.call(ai||al,al,ak,ah)});return ah},getEL:function(){return this[0]},all:function(ah){var aj,ai=this;if(ai.length>0){aj=M.all(ah,ai)}else{aj=new M()}return aj},one:function(ah){var ai=this,ak=ai.all(ah),aj=ak.length?ak.slice(0,1):null;return aj}};l.mix(M,{all:function(ah,aj){var ai=aj;if(ai&&ai.isNodeList){ai=aj.getEL()}if(typeof ah==="string"){if((ah=l.trim(ah))&&ah.length>=3&&l.startsWith(ah,"<")&&l.endsWith(ah,">")){l.err("Err 4002.")}return new M(l.all(ah,ai))}if(ah.isNodeList){return ah}return new M(ah)},one:function(ah,ai){var aj=M.all(ah,ai);return aj.length?aj.slice(0,1):null}});l.one=M.one;var P=l.support,T=l.all;var d,V,X,L,v,m,O=document.createElement("div"),aa=document.createElement("div");if(!aa.style){return}aa.style.cssText="float:left;opacity:.5";P.opacity=aa.style.opacity==="0.5";P.cssFloat=!!aa.style.cssFloat;aa.style.backgroundClip="content-box";aa.cloneNode(true).style.backgroundClip="";P.clearCloneStyle=aa.style.backgroundClip==="content-box";O=document.createElement("div");O.style.cssText="border:0;width:8px;height:0;top:0;left:-9999px;padding:0;margin-top:1px;position:absolute";aa.innerHTML="";O.appendChild(aa);P.boxSizing=aa.style.boxSizing===""||aa.style.MozBoxSizing===""||aa.style.WebkitBoxSizing==="";l.mix(P,{reliableHiddenOffsets:function(){if(d==null){r()}return L},boxSizingReliable:function(){if(d==null){r()}return X},pixelMarginRight:function(){if(d==null){r()}return V},pixelPosition:function(){if(d==null){r()}return d},reliableMarginRight:function(){if(d==null){r()}return v},reliableMarginLeft:function(){if(d==null){r()}return m}});function r(){var ai,ah;f.appendChild(O);aa.style.cssText="-webkit-box-sizing:border-box;box-sizing:border-box;position:relative;display:block;margin:auto;border:1px;padding:1px;top:1%;width:50%";d=X=m=false;V=v=true;if(window.getComputedStyle){ah=window.getComputedStyle(aa);d=(ah||{}).top!=="1%";m=(ah||{}).marginLeft==="2px";X=(ah||{width:"4px"}).width==="4px";aa.style.marginRight="50%";V=(ah||{marginRight:"4px"}).marginRight==="4px";ai=aa.appendChild(document.createElement("div"));ai.style.cssText=aa.style.cssText="-webkit-box-sizing:content-box;-moz-box-sizing:content-box;box-sizing:content-box;display:block;margin:0;border:0;padding:0";ai.style.marginRight=ai.style.width="0";aa.style.width="1px";v=!parseFloat((window.getComputedStyle(ai)||{}).marginRight);aa.removeChild(ai)}aa.style.display="none";L=aa.getClientRects().length===0;if(L){aa.style.display="";aa.innerHTML="<table><tr><td></td><td>t</td></tr></table>";aa.childNodes[0].style.borderCollapse="separate";ai=aa.getElementsByTagName("td");ai[0].style.cssText="margin:0;border:0;padding:0;display:none";L=ai[0].offsetHeight===0;if(L){ai[0].style.display="";ai[1].style.display="none";L=ai[0].offsetHeight===0}}f.removeChild(O)}var k,i,B=(/^margin/),u=/^(top|right|bottom|left)$/,ab=(/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/).source,N=new RegExp("^("+ab+")(?!px)[a-z%]+$","i"),q=new RegExp("^("+ab+")(.*)$","i");if(window.getComputedStyle){k=function(aj){var ai,ah;ai=l.isFunction(aj.getEL)?aj.getEL():aj;ah=ai.ownerDocument.defaultView;if(!ah||!ah.opener){ah=window}return ah.getComputedStyle(ai)};i=function(ao,ai,an){var al,ak,am,ah,aj=ao.style;an=an||k(ao);ah=an?an.getPropertyValue(ai)||an[ai]:undefined;if((ah===""||ah===undefined)&&!z.contains(ao.ownerDocument,ao)){ah=z.style(ao,ai)}if(an){if(!P.pixelMarginRight()&&N.test(ah)&&B.test(ai)){al=aj.width;ak=aj.minWidth;am=aj.maxWidth;aj.minWidth=aj.maxWidth=aj.width=ah;ah=an.width;aj.width=al;aj.minWidth=ak;aj.maxWidth=am}}return ah===undefined?ah:ah+""}}else{if(f.currentStyle){k=function(ah){return ah.currentStyle};i=function(an,ak,am){var ao,ai,ah,aj,al=an.style;am=am||k(an);aj=am?am[ak]:undefined;if(aj==null&&al&&al[ak]){aj=al[ak]}if(N.test(aj)&&!u.test(ak)){ao=al.left;ai=an.runtimeStyle;ah=ai&&ai.left;if(ah){ai.left=an.currentStyle.left}al.left=ak==="fontSize"?"1em":aj;aj=al.pixelLeft+"px";al.left=ao;if(ah){ai.left=ah}}return aj===undefined?aj:aj+""||"auto"}}}var g=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:-]+)[^>]*)\/>/gi,p=(/<([\w:-]+)/),e=(/^\s+/),y=/<|&#?\w+;/,J=/^-ms-/,C=/-([\da-z])/gi,D=/^(none|table(?!-c[ea]).+)/,R=(/^<([\w-]+)\s*\/?>(?:<\/\1>|)$/);var b=["Top","Right","Bottom","Left"];var U={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:P.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]};var F,Z=["Webkit","O","Moz","ms"],K="abbr|article|aside|audio|bdi|canvas|data|datalist|details|dialog|figcaption|figure|footer|header|hgroup|main|mark|meter|nav|output|picture|progress|section|summary|template|time|video";var aa=document.createElement("div");if(!aa.style){return}F=aa.style;P.cssFloat=!!aa.style.cssFloat;var E=function(ah,ai){return ai.toUpperCase()};var z={type:function(ah){if(ah==null){return ah+""}return typeof ah==="object"||typeof ah==="function"?class2type[toString.call(ah)]||"object":typeof ah},cssHooks:{},htmlPrefilter:function(ah){return ah.replace(g,"<$1></$2>")},nodeName:function(ai,ah){return ai.nodeName&&ai.nodeName.toLowerCase()===ah.toLowerCase()},merge:function(al,aj){var ah=+aj.length,ai=0,ak=al.length;while(ai<ah){al[ak++]=aj[ai++]}if(ah!==ah){while(aj[ai]!==undefined){al[ak++]=aj[ai++]}}al.length=ak;return al},camelCase:function(ah){return ah.replace(J,"ms-").replace(C,E)},cssProps:{"float":P.cssFloat?"cssFloat":"styleFloat"},cssNumber:{animationIterationCount:true,columnCount:true,fillOpacity:true,flexGrow:true,flexShrink:true,fontWeight:true,lineHeight:true,opacity:true,order:true,orphans:true,widows:true,zIndex:true,zoom:true}};function Q(ah){if(ah in F){return ah}var aj=ah.charAt(0).toUpperCase()+ah.slice(1),ai=Z.length;while(ai--){ah=Z[ai]+aj;if(ah in F){return ah}}}function o(ak,ah){var ai,al,aj=0,am=typeof ak.getElementsByTagName!=="undefined"?ak.getElementsByTagName(ah||"*"):typeof ak.querySelectorAll!=="undefined"?ak.querySelectorAll(ah||"*"):undefined;if(!am){for(am=[],ai=ak.childNodes||ak;(al=ai[aj])!=null;aj++){if(!ah||z.nodeName(al,ah)){am.push(al)}else{z.merge(am,o(al,ah))}}}return ah===undefined||ah&&z.nodeName(ak,ah)?z.merge([ak],am):am}function j(ai,ak){var ap,am,ao,ar,au,at,aj,an=ai.length,al=Y(ak),ah=[],aq=0;for(;aq<an;aq++){am=ai[aq];if(am||am===0){if(l.type(am)==="object"){z.merge(ah,am.nodeType?[am]:am)}else{if(!y.test(am)){ah.push(ak.createTextNode(am))}else{ar=ar||al.appendChild(ak.createElement("div"));au=(p.exec(am)||["",""])[1].toLowerCase();aj=U[au]||U._default;ar.innerHTML=aj[1]+z.htmlPrefilter(am)+aj[2];ap=aj[0];while(ap--){ar=ar.lastChild}if(!P.leadingWhitespace&&e.test(am)){ah.push(ak.createTextNode(e.exec(am)[0]))}if(!P.tbody){am=au==="table"&&!rtbody.test(am)?ar.firstChild:aj[1]==="<table>"&&!rtbody.test(am)?ar:0;ap=am&&am.childNodes.length;while(ap--){if(z.nodeName((at=am.childNodes[ap]),"tbody")&&!at.childNodes.length){am.removeChild(at)}}}z.merge(ah,ar.childNodes);ar.textContent="";while(ar.firstChild){ar.removeChild(ar.firstChild)}ar=al.lastChild}}}}if(ar){al.removeChild(ar)}aq=0;while((am=ah[aq++])){ao=T.contains(am.ownerDocument,am);ar=o(al.appendChild(am),"script");if(ao){setGlobalEval(ar)}}ar=null;return al}function Y(aj){var ai=K.split("|"),ah=aj.createDocumentFragment();if(ah.createElement){while(ai.length){ah.createElement(ai.pop())}}return ah}var H=function(am,al,an,ak){var aj,ai,ah={};for(ai in al){ah[ai]=am.style[ai];am.style[ai]=al[ai]}aj=an.apply(am,ak||[]);for(ai in al){am.style[ai]=ah[ai]}return aj};function af(al,ai,ah){var ak=true,am=ai==="width"?al.offsetWidth:al.offsetHeight,aj=k(al),an=P.boxSizing&&z.css(al,"boxSizing",false,aj)==="border-box";if(am<=0||am==null){am=i(al,ai,aj);if(am<0||am==null){am=al.style[ai]}if(N.test(am)){return am}ak=an&&(P.boxSizingReliable()||am===al.style[ai]);am=parseFloat(am)||0}return(am+w(al,ai,ah||(an?"border":"content"),ak,aj))}function w(al,ai,ah,an,ak){var aj=ah===(an?"border":"content")?4:ai==="width"?1:0,am=0;for(;aj<4;aj+=2){if(ah==="margin"){am+=z.css(al,ah+b[aj],true,ak)}if(an){if(ah==="content"){am-=z.css(al,"padding"+b[aj],true,ak)}if(ah!=="margin"){am-=z.css(al,"border"+b[aj]+"Width",true,ak)}}else{am+=z.css(al,"padding"+b[aj],true,ak);if(ah!=="padding"){am+=z.css(al,"border"+b[aj]+"Width",true,ak)}}}return am}function S(ah){var ai=new RegExp("^(?:([+-])=|)("+ab+")([a-z%]*)$","i");return ai.exec(ah)}function A(ah,aj,ak){var ai=q.exec(aj);return ai?Math.max(0,ai[1]-(ak||0))+(ai[2]||"px"):aj}function n(ai,ah,al,aq){var ar,aj=1,an=20,ap=aq?function(){return aq.cur()}:function(){return z.css(ai,ah,"")},am=ap(),ao=al&&al[3]||(z.cssNumber[ah]?"":"px"),ak=(z.cssNumber[ah]||ao!=="px"&&+am)&&S(z.css(ai,ah));if(ak&&ak[3]!==ao){ao=ao||ak[3];al=al||[];ak=+am||1;do{aj=aj||".5";ak=ak/aj;z.style(ai,ah,ak+ao)}while(aj!==(aj=ap()/am)&&aj!==1&&--an)}if(al){ak=+ak||+am||0;ar=al[1]?ak+(al[1]+1)*al[2]:+al[2];if(aq){aq.unit=ao;aq.start=ak;aq.end=ar}}return ar}l.each(["height","width"],function(ah,ai){z.cssHooks[ah]={get:function(al,ak,aj){if(ak){return D.test(z.css(al,"display"))&&al.offsetWidth===0?H(al,cssShow,function(){return af(al,ah,aj)}):af(al,ah,aj)}},set:function(al,am,aj){var ak=aj&&k(al);return A(al,am,aj?w(al,ah,aj,P.boxSizing&&z.css(al,"boxSizing",false,ak)==="border-box",ak):0)}}});l.style=z.style=function(aj,ai,ao,ak){if(!aj||aj.nodeType===3||aj.nodeType===8||!aj.style){return}var am,an,ap,al=z.camelCase(ai),ah=aj.style;ai=z.cssProps[al]||(z.cssProps[al]=Q(al)||al);ap=z.cssHooks[ai]||z.cssHooks[al];if(ao!==undefined){an=typeof ao;if(an==="string"&&(am=S(ao))&&am[1]){ao=n(aj,ai,am);an="number"}if(ao==null||ao!==ao){return}if(an==="number"){ao+=am&&am[3]||(z.cssNumber[al]?"":"px")}if(!P.clearCloneStyle&&ao===""&&ai.indexOf("background")===0){ah[ai]="inherit"}if(!ap||!("set" in ap)||(ao=ap.set(aj,ao,ak))!==undefined){ah[ai]=ao}}else{if(ap&&"get" in ap&&(am=ap.get(aj,false,ak))!==undefined){return am}return ah[ai]}};l.css=z.css=function(an,al,ai,am){var ak,ao,ah,aj=z.camelCase(al);al=z.cssProps[aj]||(z.cssProps[aj]=Q(aj)||aj);ah=z.cssHooks[al]||z.cssHooks[aj];if(ah&&"get" in ah){ao=ah.get(an,true,ai)}if(ao===undefined){ao=i(an,al,am)}if(ao==="normal"&&al in cssNormalTransform){ao=cssNormalTransform[al]}if(ai===""||ai){ak=parseFloat(ao);return ai===true||isFinite(ak)?ak||0:ao}return ao};var a=" ",ag=/[\n\t\r]/g,ae=function(ah){return(a+ah+a).replace(ag,a)},ad=function(al,an){var ak=al.className,ah,ai=an.length,am,aj;if(ak){ah=ae(ak);am=ak;aj=0;for(;aj<ai;aj++){if(ah.indexOf(a+an[aj]+a)<0){am+=a+an[aj]}}am=l.trim(am)}else{am=an.join(" ")}al.className=am},G=function(al,an){var aj=al.className,ak,ah=an.length,ai,am;if(aj&&ah){ak=ae(aj);ai=0;for(;ai<ah;ai++){am=a+an[ai]+a;while(ak.indexOf(am)>=0){ak=ak.replace(am,a)}}al.className=l.trim(ak)}};l.mix(I,{before:function(ai){var aj=this.getEL(),ah=ai;if(typeof ai==="string"&&(ai=l.trim(ai))&&ai.length>=3&&l.startsWith(ai,"<")&&l.endsWith(ai,">")){ah=l.parseHTML(ai)[0]}aj.insertBefore(ah,aj.childNodes[0])},append:function(ai){var aj=this.getEL(),ah=ai;if(typeof ai==="string"&&(ai=l.trim(ai))&&ai.length>=3&&l.startsWith(ai,"<")&&l.endsWith(ai,">")){ah=l.parseHTML(ai)[0]}aj.appendChild(ah)},html:function(ah){this.getEL().innerHTML=ah},attr:function(aj,ah){var ai=this.getEL();if(aj=="class"){ai.className=ah}else{ai[aj]=ah}},style:function(aj,ah){var ai=this.getEL();return z.style(ai,aj,ah)},css:function(ah){var ai=this.getEL();l.each(ah,function(aj,ak){z.style(ai,ak,aj)})},addClass:function(ah){var ai=this.getEL();ad(ai,ah.split(a))},removeClass:function(ah){var ai=this.getEL();G(ai,ah.split(a))},parent:function(){var ah=this.getEL();return new M(ah.parentNode)},remove:function(){var ah=this.getEL();ah.parentNode.removeChild(ah)}});l.parseHTML=function(aj,ai){if(!aj||typeof aj!=="string"){return null}if(typeof ai==="boolean"){ai=false}ai=ai||document;var ah=R.exec(aj);if(ah){return[ai.createElement(ah[1])]}ah=j([aj],ai);return z.merge([],ah.childNodes)}})(dynamsoft.lib);(function(d){var b=Array.prototype,a=Function.prototype;var e=20180115;if(d._polyfill_ver){if(d.isNumber(d._polyfill_ver)&&d._polyfill_ver>=e){return}}d._polyfill_ver=e;if(!d.isFunction(b.indexOf)){b.indexOf=function(h,i){var g;if(this==null){return -1}var j=Object(this);var f=j.length>>>0;if(f===0){return -1}var l=+i||0;if(Math.abs(l)===Infinity){l=0}if(l>=f){return -1}g=Math.max(l>=0?l:f-Math.abs(l),0);while(g<f){if(g in j&&j[g]===h){return g}g++}return -1}}if(!d.isFunction(a.bind)){a.bind=function(h){var g=this;if(1<arguments.length){var f=b.slice.call(arguments,1);return function(){return g.apply(h,arguments.length?f.concat(b.slice.call(arguments)):f)}}return function(){return arguments.length?g.apply(h,arguments):g.call(h)}}}if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}}})(dynamsoft.lib);(function(a){var e=a.lib,d=a.navInfo,g=window.document,h,f;var i=20180115;if(e._event_ver){if(e.isNumber(e._event_ver)&&e._event_ver>=i){return}}e._event_ver=i;f=function(l){var k=l;if(k=="mousewheel"){k=d.bGecko?"DOMMouseScroll":"mousewheel"}return k};h={addEventListener:g.addEventListener?function(l,n,m){var k=f(n);if(l){l.addEventListener(k,m,false)}}:function(l,n,m){var k=f(n);if(l){l.attachEvent("on"+k,m)}},removeEventListener:g.removeEventListener?function(l,n,m){var k=f(n);if(l){l.removeEventListener(k,m,false)}}:function(l,n,m){var k=f(n);if(l){l.detachEvent("on"+k,m)}},getWheelDelta:function(k){k=k||window.event;var n,m=k.wheelDelta,l=k.detail;if(m){n=m/120}if(l){n=-(l%3===0?l/3:l)}return n}};e.mix(e,h);e.Events={registedClass:[],registedObjs:[]};var j=function(k){var m=k||window.event;var l=true;e.each(e.Events.registedObjs,function(n){e.each(e.Events.registedClass,function(o){if(n instanceof o){if(n.bFocus&&n.handlerKeyDown){l=n.handlerKeyDown(m);if(!l){return false}}}})});return l};e.addEventListener(document.documentElement,"keydown",j);e.stopPropagation=function(k){var l=k||window.event;if(l.preventDefault){l.preventDefault()}if(l.stopPropagation){l.stopPropagation()}l.returnValue=false;l.cancelBubble=true};var b={LEFT:0,MIDDLE:1,RIGHT:2};e.EnumMouseButton=b;e.detectButton=function(k){var l=k||window.event;if(l.which==null){return(l.button<2)?b.LEFT:((l.button==4)?b.MIDDLE:b.RIGHT)}else{return(l.which<2)?b.LEFT:((l.which==2)?b.MIDDLE:b.RIGHT)}};e.fireEvent=function(k,l){var m;if(g.createEvent){m=g.createEvent("HTMLEvents");m.initEvent(k,TRUE,TRUE);if(l.dispatchEvent){l.dispatchEvent(m)}}else{if(g.createEventObject){m=g.createEventObject();m.bubbles=TRUE;m.cancelable=TRUE;l.fireEvent(k,m)}else{m=new Event(k);if(l.dispatchEvent){l.dispatchEvent(m)}}}}})(dynamsoft);(function(t,f,p){var m=window,j=/^(?:about|app|app\-storage|.+\-extension|file|widget)$/,x=1,E=2,e=3,I=200,b=204,i=300,u=304,o=404,g=1223,v=500,F=-1022,H="The local service (Dynamsoft Service) is disconnected.",z="open error: ",w="send error: ",h=new t.Uri(location.href),D=h&&j.test(h.getScheme()),G=false,k=function(){try{return new m.XMLHttpRequest}catch(K){}return p},y=function(){try{var K=false;t.each(["Msxml2.XMLHTTP.6.0","Msxml2.XMLHTTP","Microsoft.XMLHTTP","Msxml2.XMLHTTP.3.0","Msxml3.XMLHTTP"],function(M){try{return(K=new m.ActiveXObject(M))}catch(N){t.error("new xhr error: "+N.message)}});return K}catch(L){}return p},s=(!D&&m.XMLHttpRequest)?("withCredentials" in (k()||[])):false,C=m.ActiveXObject?function(K){if(f.bIE&&(parseInt(f.strBrowserVersion)<=9)){return y()}if(!s&&K&&G){return new G}return !D&&k()||y()}:k,q=function(K){return G&&(K instanceof G)},A={url:false,onSuccess:false,onError:false,onComplete:false,method:"GET",async:true,xhrFields:false,mimeType:false,username:false,password:false,data:false,dataType:"text",headers:false,contentType:"application/x-www-form-urlencoded; charset=UTF-8",beforeSend:false,afterSend:false,timeout:0,crossDomain:false},n=/^(?:GET|HEAD)$/,a=/^(.*?):[ \t]*([^\r\n]*)\r?$/mg,J={xml:"application/xml, text/xml",html:"text/html",text:"text/plain",json:"application/json, text/javascript","*":"*/*"},B=t.nil,l,d;if(f.bIE&&parseInt(f.strBrowserVersion)<=10){B=t.noop}l={setRequestHeader:function(L,M){var K=this;K.headers[L]=M;return K},getAllResponseHeaders:function(){var K=this;return K.state===E?K.responseHeadersString:null},getNativeXhr:function(){var K=this;return K.nativeXhr},getResponseHeader:function(M){var L,K=this,N;M=M.toLowerCase();if(K.state===E){if(!(N=K.responseHeaders)){N=K.responseHeaders={};while(L=a.exec(K.responseHeadersString)){N[L[1].toLowerCase()]=L[2]}}L=N[M]}return L===p?null:L},overrideMimeType:function(L){var K=this;if(!K.state){K.mimeType=L}return K},abort:function(L){var K=this;L=L||"abort";K.state=e;K.status=0;K.statusText=L;if(K.nativeXhr){K.nativeXhr.abort()}K._callback();return K},_ioReady:function(L,O){var M=this,K;if(M.state===E||M.state===e){return}if(M.state===x){M.state=E}M.readyState=4;if(L>=I&&L<i||L===u){if(L===u){O="not modified";K=true}else{O="success";K=true}}else{if(L<0){L=0}}try{if(L>=I){M.handleResponseData()}}catch(N){t.error(N.stack||N,"error");O=N.message||"parser error"}M.status=L;M.statusText=O;M._callback(K)},_callback:function(K){var M=this,R=M.statusText,Q;if(Q=M.timeoutTimer){clearTimeout(Q);M.timeoutTimer=0}var P=K?"onSuccess":"onError",O,L=[M.responseData,R,M],N=M.context;O=M[P];if(t.isFunction(O)){O.apply(N,L)}O=M.onComplete;if(t.isFunction(O)){O.apply(N,L)}M.responseData=null},handleResponseData:function(){var M=this,K,L=M.dataType,O=M.nativeXhr;if(L==="blob"||L==="arraybuffer"){K=!!m.Blob?O.response:O.responseBody}else{if(L=="json"){if(O.responseType&&O.responseType.toLowerCase()=="json"){K=O.response}else{K=O.responseText?((m.JSON&&m.JSON.parse)?m.JSON.parse(O.responseText):t.parse(O.responseText)):{}}}else{if(L==="user-defined"){K=O.response!==p?O.response:O.responseText}else{M.responseText=K=O.responseText||"";try{var N=O.responseXML;if(N&&N.documentElement){M.responseXML=N}}catch(P){}}}}M.responseData=K},sendInternal:function(){var V=this,Z=V,R,L,M,Y,W,X,N,S,Q,P;L=V.method;M=V.url;Y=V.dataType;N=V.mimeType;if(!t.isString(M)){return}Z.nativeXhr=W=C(V.crossDomain);if(!W){return}try{Z.state=x;if(V.username){W.open(L,M,V.async,V.username,V.password)}else{W.open(L,M,V.async)}if((V.async||f.bIE)&&Y&&Y!="user-defined"&&("responseType" in W)){try{W.responseType=Y}catch(T){}}}catch(U){if(Z.state<2){t.error(U.stack||U,"error");Z._ioReady(-1,z+(t.isNumber(U.number)?"("+U.number+")":"")+(U.message||""))}else{t.error(U)}return}X=V.xhrFields||{};if("withCredentials" in X){if(!s){delete X.withCredentials}}for(R in X){try{W[R]=X[R]}catch(T){t.error(T)}}if(N&&W.overrideMimeType){W.overrideMimeType(N)}S=V.headers||{};var O=S["X-Requested-With"];if(O===false){delete S["X-Requested-With"]}if(typeof W.setRequestHeader!=="undefined"){if(V.contentType){W.setRequestHeader("Content-Type",V.contentType)}W.setRequestHeader("Accept",Y&&J[Y]?J[Y]+(Y==="*"?"":", */*; q=0.01"):J["*"]);for(R in S){W.setRequestHeader(R,S[R])}}Q=!n.test(V.method);P=Q&&V.data||null;if(Q&&f.bIE&&parseInt(f.strBrowserVersion)<10){P=V.data}if(V.async&&V.timeout>0){Z.timeoutTimer=setTimeout(function(){Z.abort("timeout")},V.timeout*1000)}try{Z.state=x;if(t.isFunction(Z.beforeSend)){var K=Z.beforeSend(W,Z);if(K===false){Z.abort("cancel");return}}W.send(P);P=null;V.data=null;if(t.isFunction(Z.afterSend)){Z.afterSend(Z)}}catch(T){if(Z.state<2){t.error(T.stack||T,"error");Z._ioReady(-1,w+(T.message||""))}else{t.error(T)}}if(!V.async||W.readyState===4){Z._xhrCallback()}else{if(q(W)){W.onload=function(){W.readyState=4;W.status=I;Z._xhrCallback()};W.onerror=function(){W.readyState=4;W.status=v;Z._xhrCallback()}}else{W.onreadystatechange=function(){Z._xhrCallback()}}}},_xhrCallback:function(L,Q){var M=this,N=M.nativeXhr;try{if(N.readyState===4||Q){if(q(N)){N.onerror=B;N.onload=B}else{N.onreadystatechange=B}if(Q){if(N.readyState!==4){N.abort()}}else{if(!q(N)){M.responseHeadersString=N.getAllResponseHeaders()}var K=N.status,P;try{P=N.statusText}catch(O){t.error("xhr statusText error: ");t.error(O);P=""}M._ioReady(K,P)}}}catch(O){t.error(O.stack||O,"error");if(O.errorCode===F){throw {errorCode:F,errorString:H,toString:function(){return this.errorCode+": "+this.errorString}}}N.onreadystatechange=B;if(!Q){M._ioReady(-1,O.message||"process error")}}},_setupCfg:function(O){var L=this,K,N,Q,M,P;M=O.url;if(t.startsWith(M,"http://")||t.startsWith(M,"https://")){P=new t.Uri(M)}else{if(t.startsWith(M,"//")){O.url=M="http:"+M}P=h.resolve(M)}if(!O.dataType){K="text"}else{K=O.dataType.toLowerCase()}O.dataType=K;if(!O.method){O.method="GET"}else{O.method=O.method.toUpperCase()}if(!("crossDomain" in O)){O.crossDomain=!P.isSameOriginAs(h)}Q=O.headers;for(N in Q){if(t.isUndefined(Q[N])){delete Q[N]}}t.mix(L,O);L.state=x}};function r(L){var K=this;if(!L||!t.isString(L.url)){t.log("the url is error.");return}if(!(K instanceof r)){return new r(L)}t.mix(K,A);t.mix(K,l);if(L instanceof r){L=L.config}K.config=L;K.config.context=K;K._setupCfg(L);K.sendInternal()}r._strOpenErr=z;r._strSendErr=w;r._strConnectionToServiceLostString=H;d={ajax:r,io:{get:function(L,M,N,K){return new r({method:"GET",url:L,onSuccess:M,onError:N,dataType:K})},post:function(L,N,M,O,K){return new r({method:"POST",data:N,url:L,onSuccess:M,onError:O,dataType:K})},put:function(L,N,M,O,K){return new r({method:"PUT",data:N,url:L,onSuccess:M,onError:O,dataType:K})}}};t.mix(t,d)})(dynamsoft.lib,dynamsoft.navInfo);(function(i){var m=20180115;if(i._json_ver){if(i.isNumber(i._json_ver)&&i._json_ver>=m){return}}i._json_ver=m;var l=(function(){var q={"\b":"\\b","\f":"\\f","\n":"\\n","\r":"\\r","\t":"\\t",'"':'\\"'},p={},r=/["\b\f\n\r\t\x00-\x1f]/g,o=/\\\\|\\\/|\\b|\\f|\\n|\\r|\\t|\\"|\\u[0-9a-zA-Z]{4}/g;i.each(q,function(s,t){p[s]=t});p["\\/"]="/";p["\\\\"]="\\";return{quote:function(s){return'"'+s.replace(r,function(t){var u;if(!(u=q[t])){u="\\u"+("0000"+t.charCodeAt(0).toString(16)).slice(0-4)}return u})+'"'},unQuote:function(s){return s.slice(1,s.length-1).replace(o,function(t){var u;if(!(u=p[t])){u=String.fromCharCode(parseInt(t.slice(2),16))}return u})}}})();function b(o){return o<10?"0"+o:o}function j(r,q,u,s,v,p,o){var t=q[r];if(t&&typeof t==="object"){if(typeof t.toJSON==="function"){t=t.toJSON(r)}else{if(t instanceof Date){t=isFinite(t.valueOf())?t.getUTCFullYear()+"-"+b(t.getUTCMonth()+1)+"-"+b(t.getUTCDate())+"T"+b(t.getUTCHours())+":"+b(t.getUTCMinutes())+":"+b(t.getUTCSeconds())+"Z":null}else{if(t instanceof String||t instanceof Number||t instanceof Boolean){t=t.valueOf()}}}}if(u!==undefined){t=u.call(q,r,t)}switch(typeof t){case"number":return isFinite(t)?String(t):"null";case"string":return l.quote(t);case"boolean":return String(t);case"object":if(!t){return"null"}if(i.isArray(t)){return n(t,u,s,v,p,o)}return g(t,u,s,v,p,o)}return undefined}function g(F,z,r,E,D,t){var u=t;t+=E;var v,q,x,s;if(r!==undefined){v=r}else{v=i.keys(F)}var C=[];for(x=0,q=v.length;x<q;x++){s=v[x];var o=j(s,F,z,r,E,D,t);if(o!==undefined){var w=l.quote(s);w+=":";if(E){w+=" "}w+=o;C[C.length]=w}}var A;if(!C.length){A="{}"}else{if(!E){A="{"+C.join(",")+"}"}else{var y=",\n"+t;var B=C.join(y);A="{\n"+t+B+"\n"+u+"}"}}return A}function n(B,t,p,A,z,q){var r=q;q+=A;var y=[];var v=B.length;var u=0;while(u<v){var o=j(String(u),B,t,p,A,z,q);if(o===undefined){y[y.length]="null"}else{y[y.length]=o}++u}var w;if(!y.length){w="[]"}else{if(!A){w="["+y.join(",")+"]"}else{var s="\n,"+q;var x=y.join(s);w="[\n"+q+x+"\n"+r+"]"}}return w}i.stringify=function(r,o,q){var t="";var p,s;if(o){if(typeof o==="function"){s=o}else{if(i.isArray(o)){p=o}}}if(typeof q==="number"){q=Math.min(10,q);t=new Array(q+1).join(" ")}else{if(typeof q==="string"){t=q.slice(0,10)}}return j("",{"":r},s,p,t,[],"")};var d={},e={SHIFT_TYPE:1,REDUCE_TYPE:2,ACCEPT_TYPE:0,TYPE_INDEX:0,PRODUCTION_INDEX:1,TO_INDEX:2},a;d.yy={unQuote:l.unQuote};a=function(o){var p=this;p.rules=[];i.mix(p,o);p.resetInput(p.input)};a.prototype={constructor:function(o){var p=this;p.rules=[];i.mix(p,o);p.resetInput(p.input)},resetInput:function(o){i.mix(this,{input:o,matched:"",stateStack:[a.STATIC.INITIAL],match:"",text:"",firstLine:1,lineNumber:1,lastLine:1,firstColumn:1,lastColumn:1})},getCurrentRules:function(){var o=this,p=o.stateStack[o.stateStack.length-1],q=[];p=o.mapState(p);i.each(o.rules,function(s){var t=s.state||s[3];if(!t){if(p==a.STATIC.INITIAL){q.push(s)}}else{if(i.inArray(p,t)){q.push(s)}}});return q},pushState:function(o){this.stateStack.push(o)},popState:function(){return this.stateStack.pop()},getStateStack:function(){return this.stateStack},showDebugInfo:function(){var q=this,s=a.STATIC.DEBUG_CONTEXT_LIMIT,o=q.matched,r=q.match,p=q.input;o=o.slice(0,o.length-r.length);var u=(o.length>s?"...":"")+o.slice(-s).replace(/\n/," "),t=r+p;t=t.slice(0,s)+(t.length>s?"...":"");return u+t+"\n"+new Array(u.length+1).join("-")+"^"},mapSymbol:function(q){var o=this,p=o.symbolMap;if(!p){return q}return p[q]||(p[q]=(++o.symbolId))},mapReverseSymbol:function(p){var o=this,r=o.symbolMap,q,s=o.reverseSymbolMap;if(!s&&r){s=o.reverseSymbolMap={};for(q in r){s[r[q]]=q}}if(s){return s[p]}else{return p}},mapState:function(q){var o=this,p=o.stateMap;if(!p){return q}return p[q]||(p[q]=(++o.stateId))},lex:function(){var y=this,w=y.input,r,v,o,t,z,x=y.getCurrentRules();y.match=y.text="";if(!w){return y.mapSymbol(a.STATIC.END_TAG)}for(r=0;r<x.length;r++){v=x[r];var u=v.regexp||v[1],p=v.token||v[0],q=v.action||v[2]||undefined;if(o=w.match(u)){z=o[0].match(/\n.*/g);if(z){y.lineNumber+=z.length}i.mix(y,{firstLine:y.lastLine,lastLine:y.lineNumber+1,firstColumn:y.lastColumn,lastColumn:z?z[z.length-1].length-1:y.lastColumn+o[0].length});var s;s=y.match=o[0];y.matches=o;y.text=s;y.matched+=s;t=q&&q.call(y);if(t===undefined){t=p}else{t=y.mapSymbol(t)}w=w.slice(s.length);y.input=w;if(t){return t}else{return y.lex()}}}i.error("lex error at line "+y.lineNumber+":\n"+y.showDebugInfo());return undefined}};a.STATIC={INITIAL:"I",DEBUG_CONTEXT_LIMIT:20,END_TAG:"$EOF"};var f=new a({rules:[[2,/^"(\\"|\\\\|\\\/|\\b|\\f|\\n|\\r|\\t|\\u[0-9a-zA-Z]{4}|[^\\"\x00-\x1f])*"/,0],[0,/^[\t\r\n\x20]/,0],[3,/^,/,0],[4,/^:/,0],[5,/^\[/,0],[6,/^\]/,0],[7,/^\{/,0],[8,/^\}/,0],[9,/^-?\d+(?:\.\d+)?(?:e-?\d+)?/i,0],[10,/^true|false/,0],[11,/^null/,0],[12,/^./,0]]});d.lexer=f;f.symbolMap={"$EOF":1,STRING:2,COMMA:3,COLON:4,LEFT_BRACKET:5,RIGHT_BRACKET:6,LEFT_BRACE:7,RIGHT_BRACE:8,NUMBER:9,BOOLEAN:10,NULL:11,INVALID:12,"$START":13,json:14,value:15,object:16,array:17,elementList:18,member:19,memberList:20};d.productions=[[13,[14]],[14,[15],function(){return this.$1}],[15,[2],function(){return this.yy.unQuote(this.$1)}],[15,[9],function(){return parseFloat(this.$1)}],[15,[16],function(){return this.$1}],[15,[17],function(){return this.$1}],[15,[10],function(){return this.$1==="true"}],[15,[11],function(){return null}],[18,[15],function(){return[this.$1]}],[18,[18,3,15],function(){this.$1[this.$1.length]=this.$3;return this.$1}],[17,[5,6],function(){return[]}],[17,[5,18,6],function(){return this.$2}],[19,[2,4,15],function(){return{key:this.yy.unQuote(this.$1),value:this.$3}}],[20,[19],function(){var o={};o[this.$1.key]=this.$1.value;return o}],[20,[20,3,19],function(){this.$1[this.$3.key]=this.$3.value;return this.$1}],[16,[7,8],function(){return{}}],[16,[7,20,8],function(){return this.$2}]];d.table={gotos:{"0":{"14":7,"15":8,"16":9,"17":10},"2":{"15":12,"16":9,"17":10,"18":13},"3":{"19":16,"20":17},"18":{"15":23,"16":9,"17":10},"20":{"15":24,"16":9,"17":10},"21":{"19":25}},action:{"0":{"2":[1,0,1],"5":[1,0,2],"7":[1,0,3],"9":[1,0,4],"10":[1,0,5],"11":[1,0,6]},"1":{"1":[2,2,0],"3":[2,2,0],"6":[2,2,0],"8":[2,2,0]},"2":{"2":[1,0,1],"5":[1,0,2],"6":[1,0,11],"7":[1,0,3],"9":[1,0,4],"10":[1,0,5],"11":[1,0,6]},"3":{"2":[1,0,14],"8":[1,0,15]},"4":{"1":[2,3,0],"3":[2,3,0],"6":[2,3,0],"8":[2,3,0]},"5":{"1":[2,6,0],"3":[2,6,0],"6":[2,6,0],"8":[2,6,0]},"6":{"1":[2,7,0],"3":[2,7,0],"6":[2,7,0],"8":[2,7,0]},"7":{"1":[0,0,0]},"8":{"1":[2,1,0]},"9":{"1":[2,4,0],"3":[2,4,0],"6":[2,4,0],"8":[2,4,0]},"10":{"1":[2,5,0],"3":[2,5,0],"6":[2,5,0],"8":[2,5,0]},"11":{"1":[2,10,0],"3":[2,10,0],"6":[2,10,0],"8":[2,10,0]},"12":{"3":[2,8,0],"6":[2,8,0]},"13":{"3":[1,0,18],"6":[1,0,19]},"14":{"4":[1,0,20]},"15":{"1":[2,15,0],"3":[2,15,0],"6":[2,15,0],"8":[2,15,0]},"16":{"3":[2,13,0],"8":[2,13,0]},"17":{"3":[1,0,21],"8":[1,0,22]},"18":{"2":[1,0,1],"5":[1,0,2],"7":[1,0,3],"9":[1,0,4],"10":[1,0,5],"11":[1,0,6]},"19":{"1":[2,11,0],"3":[2,11,0],"6":[2,11,0],"8":[2,11,0]},"20":{"2":[1,0,1],"5":[1,0,2],"7":[1,0,3],"9":[1,0,4],"10":[1,0,5],"11":[1,0,6]},"21":{"2":[1,0,14]},"22":{"1":[2,16,0],"3":[2,16,0],"6":[2,16,0],"8":[2,16,0]},"23":{"3":[2,9,0],"6":[2,9,0]},"24":{"3":[2,12,0],"8":[2,12,0]},"25":{"3":[2,14,0],"8":[2,14,0]}}};d.parse=function h(y){var A=this,o=A.lexer,t,F,E,I=A.table,B=I.gotos,s=I.action,r=A.productions,u=[null],v=[0];o.resetInput(y);while(1){t=v[v.length-1];if(!F){F=o.lex()}if(!F){i.log("it is not a valid input: "+y,"error");return false}E=s[t]&&s[t][F];if(!E){var w=[],D;if(s[t]){i.each(s[t],function(L,M){w.push(A.lexer.mapReverseSymbol(M))})}D="Syntax error at line "+o.lineNumber+":\n"+o.showDebugInfo()+"\nexpect "+w.join(", ");i.log(D);return false}switch(E[e.TYPE_INDEX]){case e.SHIFT_TYPE:v.push(F);u.push(o.text);v.push(E[e.TO_INDEX]);F=null;break;case e.REDUCE_TYPE:var J=r[E[e.PRODUCTION_INDEX]],z=J.symbol||J[0],q=J.action||J[2],C=J.rhs||J[1],H=C.length,G=0,K,x=u[u.length-H];A.$$=x;K=undefined;for(;G<H;G++){A["$"+(H-G)]=u[u.length-1-G]}if(q){K=q.call(A)}if(K!==undefined){x=K}else{x=A.$$}if(H){v=v.slice(0,-1*H*2);u=u.slice(0,-1*H)}v.push(z);u.push(x);var p=B[v[v.length-2]][v[v.length-1]];v.push(p);break;case e.ACCEPT_TYPE:return x}}return undefined};i.parser=d;function k(w,o,x){var s=w[o],t,v,u;if(typeof s==="object"){if(i.isArray(s)){t=0;v=s.length;var r=[];while(t<v){u=k(s,String(t),x);if(u!==undefined){r[r.length]=u}}s=r}else{var y=i.keys(s);for(t=0,v=y.length;t<v;t++){var q=y[t];u=k(s,q,x);if(u===undefined){delete s[q]}else{s[q]=u}}}}return x.call(w,o,s)}i.parse=function(s,o){var r=window,q=r.JSON;if(q&&q.parse){return q.parse(String(s))}var p=d.parse(String(s));if(o){return k({"":p},"",o)}else{return p}}})(dynamsoft.lib);(function(j,e){var h=20180115;if(j._dialog_ver){if(j.isNumber(j._dialog_ver)&&j._dialog_ver>=h){return}}j._dialog_ver=h;var f=window,s=document,i=!0,o=!1,m={},k=(e.bIE&&e.IEMode<8),g=k&&(e.IEMode<7),l=500000,a=1000,b=function(t){var w,v,u;w=s.body.scrollTop||s.documentElement.scrollTop;if(f.innerHeight){u=f.innerHeight}else{u=s.documentElement.clientHeight}v=w+(u-t.offsetHeight)/2;t.style.top=v+"px";t._dlgInfo.isTopOverridden=i},n=function(t,v){for(var u=0;u<t.length;++u){if(t[u]==v){return i}}return o},p=function(w){for(var x=0;x<s.styleSheets.length;++x){var C=s.styleSheets[x],z=o,u=o,B,D;try{z=C.cssRules;u=s.querySelectorAll}catch(y){}if(z&&u){for(var v=0;v<z.length;++v){B=z[v];D=o;try{D=u(B.selectorText)}catch(y){}if(D&&n(D,w)){var t=B.style.getPropertyValue("top"),A=B.style.getPropertyValue("bottom");if((t&&t!="auto")||(A&&A!="auto")){return i}}}}}return o},q=function(u){var t=o;if(f.getComputedStyle){t=f.getComputedStyle(u)}else{if(u.currentStyle){t=u.currentStyle}}if(t&&t.position!="absolute"){return o}if((u.style.top!="auto"&&u.style.top!="")||(u.style.bottom!="auto"&&u.style.bottom!="")){return o}return !p(u)};m.showDialog=function(y){var z=this,v;if(z.open){j.error("showDialog called on open dialog.");return}z.open=i;z.removeAttribute("closed");z.setAttribute("open","open");if(k){v=g?s.body:s.documentElement;z._dlgInfo.docOverflow=v.style.overflow;v.style.overflow="hidden"}if(q(z)){b(z)}if(y){z._dlgInfo.modal=i;m.dm.pushDialog(z);if(k){var u,t,x=o,w=o;u=z.currentStyle.left;t=z.currentStyle.top;if(u==="auto"){if(g){z.style.textAlign="center"}u=(v.clientWidth-z.currentStyle.width)/2}else{if(u.indexOf("%")>0){x=u;u=Number(u.replace("%","")*v.clientWidth/100)}else{u=Number(u.replace("px",""))}}if(!(u>0)){u=0}if(t==="auto"){t=(v.clientHeight-z.currentStyle.height)/2}else{if(t.indexOf("%")>0){w=t;t=Number(t.replace("%","")*v.clientHeight/100)}else{t=Number(t.replace("px",""))}}if(!(t>0)){t=0}setTimeout(function(){var B=z.style,A=z._dlgInfo.mask;A.style.backgroundColor="#000";A.style.filter="alpha(opacity=30)";B.position="absolute";B.left=u+"px";B.top=t+"px"},0);z._scrollFn=function(){var B=v.scrollTop+"px",E=v.scrollLeft+"px",A=m.dm.overlay,D=z._dlgInfo.mask,C=z.style;if((t+v.scrollTop+v.clientHeight)<v.scrollHeight){C.top=t+v.scrollTop+"px"}else{C.top=B}if(A){A.style.top=B}if(D){D.style.top=B}C.left=E;if(A){A.style.left=E}if(D){D.style.left=E}setTimeout(function(){z._resizeFn()},100)};z._resizeFn=function(){var E=g?s.body:s.documentElement,C=E.clientWidth+"px",D=E.clientHeight+"px",A=m.dm.overlay,B=z._dlgInfo.mask;A.style.width=C;if(B){B.style.width=C}A.style.height=D;if(B){B.style.height=D}setTimeout(function(){var G,I,F=z.style,H=g?s.body:s.documentElement;if(x){G=Number(x.replace("%","")*H.clientWidth/100);F.left=G+"px"}if(w){I=Number(w.replace("%","")*H.clientHeight/100);F.top=I+"px"}},0)};z._scrollFn();f.attachEvent("onscroll",z._scrollFn);f.attachEvent("onresize",z._resizeFn)}}};m.closeDialog=function(t){var v=this;if(!v.open){j.error("closeDialog called on closed dialog.")}v.open=o;v.removeAttribute("open");v.setAttribute("closed","closed");if(k){var u=g?s.body:s.documentElement;u.style.overflow=v._dlgInfo.docOverflow}if(typeof t!="undefined"){v.returnValue=t}if(v._dlgInfo.isTopOverridden){v.style.top="auto"}if(v._dlgInfo.modal){if(k){f.detachEvent("onscroll",v._scrollFn);f.detachEvent("onresize",v._resizeFn)}m.dm.removeDialog(this)}return v.returnValue};m.createMouseEvent=function(u){var t=s.createEvent("MouseEvents");t.initMouseEvent(u.type,u.bubbles,u.cancelable,f,u.detail,u.screenX,u.screenY,u.clientX,u.clientY,u.ctrlKey,u.altKey,u.shiftKey,u.metaKey,u.button,u.relatedTarget);return t};m.setup=function(t){var u=this;t.show=u.showDialog.bind(t,o);t.showModal=u.showDialog.bind(t,i);t.close=u.closeDialog.bind(t);t._dlgInfo={}};var r=function(){var u=this,t;u.pendingDialogStack=[];u.overlay=s.createElement(k?"iframe":"div");t=u.overlay.style;t.position=k?"absolute":"fixed";t.display="block";t.left=t.top=t.margin=t.padding=0;t.backgroundColor="#000";t.filter="alpha(opacity=30)";t.opacity=t.MozOpacity=0.3;t.zIndex=l;t.width="100%";if(k&&s.documentElement.clientHeight>0){t.height=s.documentElement.clientHeight+"px"}else{t.height="100%"}if(s.createEvent){j.addEventListener(u.overlay,"click",function(v){var w=m.createMouseEvent(v);s.body.dispatchEvent(w)})}},d=r.prototype;d._blockDocument=function(){if(!s.body.contains(this.overlay)){s.body.appendChild(this.overlay)}};d._unblockDocument=function(){s.body.removeChild(this.overlay)};d._updateStacking=function(){var x=this,t,v,u,w;v=x.pendingDialogStack;if(v.length==0){x._unblockDocument();return}x._blockDocument();w=l;j.each(v,function(y){w++;y._dlgInfo.mask.style.zIndex=w++;y.style.zIndex=w})};d.pushDialog=function(u){var v=this,t;if(v.pendingDialogStack.length>=a){j.error("Too many modal dialogs.");return}t=s.createElement("div");t.className="dynamsoft-backdrop";if(k){t.style.position="absolute"}if(s.createEvent){j.addEventListener(t,"click",function(w){if(u.dispatchEvent){var x=m.createMouseEvent(w);u.dispatchEvent(x)}})}u.parentNode.insertBefore(t,u.nextSibling);u._dlgInfo.mask=t;v.pendingDialogStack.push(u);v._updateStacking()};d.removeDialog=function(v){var w=this,u,t;u=j.isArray(w.pendingDialogStack)?w.pendingDialogStack.indexOf(v):-1;if(u==-1){return}w.pendingDialogStack.splice(u,1);t=v._dlgInfo.mask;t.parentNode.removeChild(t);v._dlgInfo.mask=null;w._updateStacking()};m.dm=new r();j.dialog=m})(dynamsoft.lib,dynamsoft.navInfo);(function(g,d,b){var f=dynamsoft.navInfo,i=f.host,e,a,h=20180115,j=function(){if(dynamsoft.dcp){var k=dynamsoft.dcp.dcpJSVer;if(g.isNumber(k)){return k>=h}}return false};if(!d){d=dynamsoft.managerEnv={}}d.resourcesPath=d.resourcesPath||"Resources";d.IfUpdateService=d.IfUpdateService?true:false;if(j()){j=b;h=b;return}a={dcpStatus:0,bConnected:false,curPortIndex:0,bTrial:false,bConnectNumLimited:true,IMAXCONNECTCOUNT:2,EnumDCP_DetectStatus:{Init:0,Connected:1,DownloadingZip:2,DownloadedZip:3,DownloadFailed:4,CheckingManagerVer:15,CheckingServiceVer:16,NotInstalled:17,CheckedService:5,VerifyingZip:6,VerifiedZip:7,UpdatingService:8,UpdateSucceed:9,UpdateFailed:10,UpdateSkipped:11}};dynamsoft.dcp=e={ip:"127.0.0.1",ports:[[18625,18626],[18993,18994]],dcpJSVer:h,oldDWASMVerStr:"dwasm_13000404",oldDWASMVer:[13,0,0,"0404"],managerVersion:[13,3,0,"0115"],serviceVersion:[1,3,0,"0115"],detect:a,versionInfo:function(n){var m=0,k=function(o){if(g.isArray(o)&&o.length>1&&o[0]&&o[1]){a.curPort=e.ports[m%e.ports.length];var p=o[0].split(","),q=o[1].toLowerCase();if(e._compareVersion(p,e.oldDWASMVer)){a.bConnected=true;a.dcpStatus=a.EnumDCP_DetectStatus.Connected;e._sendStatusEvent(false,o[0]);if(g.isFunction(n)){setTimeout(n,0)}return true}}return false},l=function(p,q,o){++m;a.curPortIndex=m%e.ports.length;a.bConnected=false;if(a.bConnectNumLimited&&m>=a.IMAXCONNECTCOUNT){setTimeout(function(){n(p,q,o)},0);return true}return false};a.dcpStatus=a.EnumDCP_DetectStatus.CheckingManagerVer;this._postBase("VersionInfo",true,k,l)},_checkOldManagerVersion:function(l,k){a.dcpStatus=a.EnumDCP_DetectStatus.CheckingManagerVer;this._postBase("VersionInfo",true,l,k)},_checkManagerVersion:function(l,k){a.dcpStatus=a.EnumDCP_DetectStatus.CheckingManagerVer;this._postBase("VersionInfo",false,l,k)},_checkService:function(l,k){a.dcpStatus=a.EnumDCP_DetectStatus.CheckingServiceVer;this._postBase("DSVersion",false,l,k)},_checkUpdateFile:function(l,k){this._postBase("CheckUpdateFile",false,l,k)},_updateService:function(l,k){this._postBase("UpdateService",false,l,k)},_postBase:function(l,p,n,m){var o,q,k;if(!g.isFunction(n)||!g.isFunction(m)){return}o=function(u,s){var r=[e._getPreUrl(a.curPortIndex),p?"dcp/":e._getModuleName(),p?e.oldDWASMVerStr:e._getModuleVer(),"/",l,"?type=1&dsver=",e.serviceVersion.join(""),"&ts=",g.now()].join(""),t,v;if(p){v=e.oldDWASMVerStr}else{v="dwasm2_"+e._getModuleVer()}t=g.stringify({id:"1",method:l,version:v,parameter:[]});g.ajax({method:"POST",url:r,data:t,onSuccess:u,onError:s})};q=function(s,t,r){if(m(s,t,r)){return}setTimeout(function(){o(k,q)},1000)};k=function(t,v,s){var u=e._getJSON(t);if(u&&"result" in u){if(n(u.result)){return}}q(t,v,s)};o(k,q)},loadZip:function(k,n,m,o){var l;if(dynamsoft.managerEnv.IfUpdateService){l=[e._getPreUrl(a.curPortIndex),e._getModuleName(),e._getModuleVer(),"/LoadZipFromBytes?type=",n,"&dsver=",e.serviceVersion.join(""),"&ts=",g.now()].join("")}else{l=[e._getPreUrl(a.curPortIndex),"dcp/",e.oldDWASMVerStr,"/LoadZipFromBytes?type=0","&dsver=",e.serviceVersion.join(""),"&ts=",g.now()].join("")}new g.ajax({method:"POST",url:l,async:true,data:k,onSuccess:m,onError:o})},oldLoadZip:function(l,k,n,o){var m=[e._getPreUrl(a.curPortIndex),"dcp/",e.oldDWASMVerStr,"/LoadZipFromBytes?type=0","&dsver=",e.serviceVersion.join(""),"&ts=",g.now()].join("");new g.ajax({method:"POST",url:m,async:true,data:l,onSuccess:n,onError:o})},_getPreUrl:function(m){var k,l;if(f.bSSL){l="https://";k=e.ports[m][1]}else{l="http://";k=e.ports[m][0]}return[l,e.ip,":",k,"/"].join("")},_getJSON:function(k){return k?g.parse(k):!1},_getModuleName:function(){return"dcp/dwasm2_"},_getModuleVer:function(){return e.managerVersion.join("")},_compareVersion:function(l,k){if(g.isArray(l)&&l.length==4&&g.isArray(k)&&k.length>=4){return l[0]>k[0]||l[0]==k[0]&&l[1]>k[1]||l[0]==k[0]&&l[1]==k[1]&&l[2]>k[2]||l[0]==k[0]&&l[1]==k[1]&&l[2]==k[2]&&parseInt(l[3])>=parseInt(k[3])}else{if(g.isArray(l)&&l.length==1&&g.isArray(k)&&k.length>=1){return parseInt(l[0])>=parseInt(k[0])}}return false},_getDSUpdateZipUrl:function(){var l=dynamsoft.navInfo,m,k;m="Win";if(l.bMac){m="Mac"}else{if(l.bLinux){m="Linux"}}if(l.bFileSystem){k=""}else{k="?t="+g.now()}return[dynamsoft.managerEnv.resourcesPath,"/",m,"DSUpdate_",e.managerVersion.join("."),".zip",k].join("")},checkDcpForUpdate:function(p,k,r,s,n,m,B){var q=false,D=true,z=3,l=0,w=function(G){if(!(g.isArray(G)&&G.length>0&&G[0])){return false}var H=G[0].split(",");if(!dynamsoft.managerEnv.IfUpdateService){a.bConnected=true;a.dcpStatus=a.EnumDCP_DetectStatus.UpdateSkipped;r&&r();e._sendStatusEvent();setTimeout(B,0)}else{if(e._compareVersion(H,e.oldDWASMVer)){var F=e._getDSUpdateZipUrl();q=true;var J=function(K){a.dcpStatus=a.EnumDCP_DetectStatus.DownloadedZip;e._sendStatusEvent();var L=0;e.oldLoadZip(K,L,function(){setTimeout(function(){e._checkManagerVersion(t,o)},5000)},I)},I=function(L,M,K){e._funUpdateFailed(n,m,L,K.status);setTimeout(B,0)},E=function(L,N,K){a.dcpStatus=a.EnumDCP_DetectStatus.DownloadFailed;n&&n();var O=K.status,M;if(O==200){M=L}else{M="The update package can't be downloaded. The error code is "+O+"."}m&&m(true,M);e._sendStatusEvent(true,M);setTimeout(B,0)};r&&r();s&&s();a.dcpStatus=a.EnumDCP_DetectStatus.DownloadingZip;e._sendStatusEvent();new g.ajax({method:"GET",url:F,async:true,dataType:"blob",onSuccess:J,onError:E})}else{if(D){a.dcpStatus=a.EnumDCP_DetectStatus.NotInstalled;r&&r();p&&p(responseData,statusText);e._sendStatusEvent();D=false}}}return true},u=function(E,F){++l;a.curPortIndex=l%e.ports.length;a.bConnected=false;if(a.bConnectNumLimited&&l>=a.IMAXCONNECTCOUNT){if(D){a.dcpStatus=a.EnumDCP_DetectStatus.NotInstalled;r&&r();p&&p(E,F);e._sendStatusEvent();D=false}}else{setTimeout(function(){e._checkOldManagerVersion(w,u)},1000)}return true},t=function(E){if(!(g.isArray(E)&&E.length>0&&E[0])){return false}var F=E[0].split(",");if(e._compareVersion(F,e.managerVersion)){if(dynamsoft.managerEnv.IfUpdateService){if(q){setTimeout(function(){e._checkUpdateZip(s,n,m,B)},0)}else{setTimeout(function(){e._checkService(C,v)},0)}}else{a.dcpStatus=a.EnumDCP_DetectStatus.UpdateSkipped;e._sendStatusEvent();setTimeout(B,0)}return true}return false},o=function(G,H,F){var E=1000;if(z<3){E=500}z--;if(z<0){e._funShowUpgradeDialogWhenUpdateFailed(n,m);setTimeout(B,0)}else{setTimeout(function(){e._checkManagerVersion(t,o)},E)}return true},C=function(F){if(!(g.isArray(F)&&F.length>0&&F[0])){return false}var E=F[0].split(",");if(e._compareVersion(E,e.serviceVersion)){a.bConnected=true;n&&n();a.dcpStatus=a.EnumDCP_DetectStatus.CheckedService;e._sendStatusEvent(false,F[0]);a.dcpStatus=a.EnumDCP_DetectStatus.UpdateSucceed;e._sendStatusEvent();setTimeout(B,0)}else{setTimeout(function(){e._checkUpdateZip(s,n,m,B)},0)}return true},v=function(F,G,E){e._funUpdateFailed(n,m,F,E.status);setTimeout(B,0);return true};var y=false,A=function(E){if(!(g.isArray(E)&&E.length>0&&E[0])){return false}var F=E[0].split(",");if(e._compareVersion(F,e.oldDWASMVer)){y=true;a.curPort=e.ports[l%e.ports.length];if(!dynamsoft.managerEnv.IfUpdateService){a.dcpStatus=a.EnumDCP_DetectStatus.UpdateSkipped;r&&r();e._sendStatusEvent();setTimeout(B,0)}else{r&&r();setTimeout(function(){e._checkService(C,v)},0)}}else{l=0;a.curPortIndex=0;setTimeout(function(){e._checkOldManagerVersion(w,u)},1000)}return true},x=function(E,F){++l;a.curPortIndex=l%e.ports.length;a.bConnected=false;if(a.bConnectNumLimited&&l>=a.IMAXCONNECTCOUNT){l=0;a.curPortIndex=0;setTimeout(function(){e._checkOldManagerVersion(w,u)},1000)}else{setTimeout(function(){e._checkManagerVersion(A,x)},1000)}return true};k&&k();e._checkManagerVersion(A,x)},_checkUpdateZip:function(o,u,n,v){var p=function(z,A,y){var B=-1;if(y){B=y.status}if(B==0){setTimeout(function(){e._checkService(t,q)},5000);return true}var x=e._getDSUpdateZipUrl();a.dcpStatus=a.EnumDCP_DetectStatus.DownloadingZip;e._sendStatusEvent();new g.ajax({method:"GET",url:x,async:true,dataType:"blob",onSuccess:k,onError:s});return true},s=function(y,A,x){a.dcpStatus=a.EnumDCP_DetectStatus.DownloadFailed;u&&u();var B=x.status,z;if(B==200){z=y}else{z="The update package can't be downloaded. The error code is "+B+"."}n&&n(true,z);e._sendStatusEvent(true,z);setTimeout(v,0);return true},r=function(y){if(!(g.isArray(y)&&y.length>1)){return false}if(y[1]==true){a.dcpStatus=a.EnumDCP_DetectStatus.VerifiedZip;e._sendStatusEvent();a.dcpStatus=a.EnumDCP_DetectStatus.UpdatingService;e._sendStatusEvent();setTimeout(function(){e._checkService(t,q)},5000)}else{var x=0;if("exception" in y){x=y.exception}if(x==-2373){e._funUpdateFailed(u,n,y,200);setTimeout(v,0);return true}setTimeout(p,0)}return true},k=function(x){var y=1;dynamsoft.dcp.loadZip(x,y,function(z){var B,A;try{if(g.isString(z)){A=g.parse(z.replace(/\0/g,""));if("result" in A){B=A.result}}}catch(C){}if(g.isArray(B)&&B.length>2&&B[2]==true){setTimeout(function(){e._checkService(t,q)},5000);return}e._funUpdateFailed(u,n,z,200);setTimeout(v,0)},m)},m=function(y,z,x){var A=-1;if(x){A=x.status}if(A==0){setTimeout(function(){e._checkService(t,q)},5000)}else{e._funUpdateFailed(u,n,y,x.status);setTimeout(v,0)}return true},w=function(x){if(!(g.isArray(x)&&x.length>0)){return false}if(x[0]==true){setTimeout(function(){e._checkService(t,q)},5000)}else{e._funUpdateFailed(u,n,x,200);setTimeout(v,0)}return true},l=3,t=function(y){if(!(g.isArray(y)&&y.length>0&&y[0])){return false}var x=y[0].split(",");if(e._compareVersion(x,e.serviceVersion)){a.bConnected=true;u&&u();a.dcpStatus=a.EnumDCP_DetectStatus.CheckedService;e._sendStatusEvent(false,y[0]);a.dcpStatus=a.EnumDCP_DetectStatus.UpdateSucceed;e._sendStatusEvent();setTimeout(v,0);return true}return false},q=function(y,z){var x=1000;if(l<3){x=500}l--;if(l<0){e._funShowUpgradeDialogWhenUpdateFailed(u,n);setTimeout(v,0);return true}setTimeout(function(){e._checkService(t,q)},x);return true};o&&o();a.dcpStatus=a.EnumDCP_DetectStatus.VerifyingZip;e._sendStatusEvent();e._checkUpdateFile(r,p)},_getStatusString:function(o,n){if(o==a.EnumDCP_DetectStatus.Init){return"Getting manager version"}else{if(o==a.EnumDCP_DetectStatus.Connected){var m;if(n){m=n}else{m=""}return"Getting manager version succeeded and the version is "+m}else{if(o==a.EnumDCP_DetectStatus.DownloadingZip){return"Downloading the update package"}else{if(o==a.EnumDCP_DetectStatus.DownloadedZip){return"Update package downloaded"}else{if(o==a.EnumDCP_DetectStatus.DownloadFailed){var l,k=".";if(n&&n.length>0){if(n.slice(n.length-1)=="."){k=""}l=" with the error: "+n}else{l=""}return"Update package failed to download"+l+k}else{if(o==a.EnumDCP_DetectStatus.CheckingManagerVer){return"Getting manager version"}else{if(o==a.EnumDCP_DetectStatus.CheckingServiceVer){return"Getting service version"}else{if(o==a.EnumDCP_DetectStatus.NotInstalled){return"Dynamsoft Service Not Installed"}else{if(o==a.EnumDCP_DetectStatus.UpdateSkipped){return"Update skipped"}else{if(o==a.EnumDCP_DetectStatus.CheckedService){var m;if(n){m=n}else{m=""}return"Getting service version succeeded and the version is "+m}else{if(o==a.EnumDCP_DetectStatus.VerifyingZip){return"Verifying the update package"}else{if(o==a.EnumDCP_DetectStatus.VerifiedZip){return"Update package verified"}else{if(o==a.EnumDCP_DetectStatus.UpdatingService){return"Updating the service"}else{if(o==a.EnumDCP_DetectStatus.UpdateSucceed){return"Update succeeded"}else{if(o==a.EnumDCP_DetectStatus.UpdateFailed){var l,k=".";if(n&&n.length>0){if(n.slice(n.length-1)=="."){k=""}l=" with the error: "+n}else{l=""}return"The update failed"+l+k}}}}}}}}}}}}}}}return""},_sendStatusEvent:function(l,m){var k=l?true:false;if(g.isFunction(i.OnGetServiceUpdateStatus)){i.OnGetServiceUpdateStatus(k,a.dcpStatus,e._getStatusString(a.dcpStatus,m))}},_getErr:function(l){var m,k="";try{if(g.isString(l)){m=l.replace(/\0/g,"");m=g.parse(m)}else{if(l){m=l}}if("description" in m){k=m.description}}catch(n){}return k},_funShowUpgradeDialogWhenUpdateFailed:function(l,k){a.bConnected=true;a.dcpStatus=a.EnumDCP_DetectStatus.UpdateFailed;l&&l();k&&k();e._sendStatusEvent(true);return true},_funUpdateFailed:function(l,k,m,p){a.bConnected=true;a.dcpStatus=a.EnumDCP_DetectStatus.UpdateFailed;l&&l();var n,o;if(p==200){n="The update failed.";o=e._getStatusString(a.dcpStatus,e._getErr(m))}else{n="The update failed. The error code is "+p;o=n}k&&k(true,n);e._sendStatusEvent(true,o);return true}};j=b;h=b;d=b})(dynamsoft.lib,dynamsoft.managerEnv);(function(h){var b="",f="[bio]: ",c=!0,g=!1;var e=dynamsoft.lib.win,i=e&&e.FormData;function a(k){var j=this;j.__attrs={};h.mix(j.__attrs,{action:b,data:{},bChunkedSendData:c,blockSize:0,ajaxConfig:{value:{},type:"post",processData:g,cache:g,dataType:"text",async:c,contentType:g,headers:{"X-Requested-With":g}},ajax:b,formData:b,CORS:g});h.mix(j.__attrs,k);j._setWithCredentials()}h.mix(a,{event:{SUCCESS:"success",ERROR:"error",PROGRESS:"progress"},status:{SUCCESS:"success",ERROR:"error"}});h.mix(a.prototype,h.obj.customEvent);h.mix(a.prototype,{get:function(k){var j=this;if(k in j.__attrs){return j.__attrs[k]}return""},set:function(l,k){var j=this;if(l in j.__attrs){j.__attrs[l]=k}},_setWithCredentials:function(){var j=this;var l=j.get("CORS");var k=j.get("ajaxConfig");h.mix(k,{xhrFields:{withCredentials:false}});return k},uploadToServer:function(m){var j=this,l=j.get("blockSize"),k;if(l>0&&m&&m.size>0){k=j._chunkedUpload(m)}else{k=j._fullUpload(m)}return k},_fullUpload:function(m){var j=this,l=j.get("ajaxConfig"),k=true;sFun=function(p){var o="";if(p){if(p&&h.isArray(p)&&p.length>1){o=p[0]}else{if(h.isString(p)){o=p}}}o=j._processResponse(o);j.fire(a.event.SUCCESS,o)},fFun=function(s,p,r){var o,q;k=false;if(s&&h.isArray(s)&&s.length>2){o=s[1];q=s[2]}else{o=p;q=r}j._errorHandler(q,o,m)};j._setFormData();if(m&&m.size>0){j._addFileData(m)}h.mix(l,{data:j.get("formData"),url:j.get("action"),beforeSend:function(q,p,o){q.upload.addEventListener("progress",function(r){j.fire(a.event.PROGRESS,{loaded:r.loaded,total:r.total})},false)}});h.mix(l,{method:"POST",onSuccess:sFun,onError:fFun});var n=new h.ajax(l);j.set("formData",null);if(l.async){j.set("ajax",n);return true}else{j.set("ajax",false);return k}},_chunkedUpload:function(l){var r=this;var p=r.get("ajaxConfig"),n=function(u){var t="";if(u){if(u&&h.isArray(u)&&u.length>1){t=u[0]}else{if(h.isString(u)){t=u}}}t=r._processResponse(t);r.fire(a.event.SUCCESS,t)},k=function(x,u,w){var t,v;if(x&&h.isArray(x)&&x.length>2){t=x[1];v=x[2]}else{t=u;v=w}r._errorHandler(v,t,l)};h.mix(p,{url:r.get("action")});var s=l.size;var m=0;var j=r.get("blockSize")||s;var o=l.slice||l.webkitSlice||l.mozSlice;function q(v){var t=o.call(l,m,m+j,l.type);var w=t.size;r._setContentRange(m,w,s);r._setFormData();if(v){r.set("data",[])}t.name=l.name;r._addFileData(t);h.mix(p,{data:r.get("formData")});h.mix(p,{method:"POST",onSuccess:function(x){m=r._getUploadedBytes(u)||m+w;r.fire(a.event.PROGRESS,{loaded:m,total:s});if(m<s){q(false)}else{n(x)}},onError:k});var u=new h.ajax(p);r.set("formData",null)}q(true)},abort:function(){var j=this,k=j.get("ajax");if(!h.isObject(k)){h.log(f+"abort(), the value of io invalid!");return j}k.abort();j.set("ajax",false);return j},_setFormData:function(){var j=this,k=j.get("data"),m;if(!i){h.log(f+"the browser does not support ajax.");return}if(k instanceof i){j.set("formData",k)}else{m=new i();try{h.each(k,function(o,n){m.append(n,o)});j.set("formData",m)}catch(l){h.log(f+"something error when reset FormData.")}}},setRequestHeader:function(l,m){var j=this;var k=j.get("ajaxConfig");k.headers[l]=m;j.set("ajaxConfig",k);return m},_addFileData:function(l){if(!h.isObject(l)){h.log(f+"_addFileData(), file parameter invalid!");return false}var k=this;var m=k.get("formData");var n=l.name,j=l.remoteFilename;if(!j){j="RemoteFile"}m.append(j,l,n);k.set("formData",m);return m},_errorHandler:function(n,m,o){var l=this,k=a.status.ERROR,j={status:k,msg:m,response:false};if(n){j.httpStatus=n.status;j.response=n.responseText}l.fire(k,j)},_getUploadedBytes:function(l){var j=l.getResponseHeader("Range");var m=j&&j.split("-");var k=m&&m.length>1&&parseInt(m[1],10);return k&&k+1},_setContentRange:function(m,p,l){var o="bytes "+m+"-"+(m+p-1)+"/"+l;var j=this;var k=j.get("ajaxConfig");var n=k.headers;n["Content-Range"]=o;return o},_processResponse:function(n){var r=this,u,k,j,p=false,t=n,l=a.status.SUCCESS,q=a.event.ERROR;h.log("Response from server: "+n);if(h.isUndefined(n)||n===""){u={status:l,msg:false,json:false,response:""}}else{if(h.isString(n)){try{for(k=0;k<n.length;k++){if(k>10){break}j=n[k];if(j=="{"){p=true;break}else{if(j==" "||j=="\r"||j=="\n"||j=="\t"){}else{break}}}if(p){var o=h.parse(n);if(o.status==1){u={status:l,msg:false,json:o,response:n}}else{u={status:q,msg:false,json:o,response:n}}}}catch(m){p=false;h.log(m)}if(!p){var s=new String(n);s=s.replace(/( |\t|\r|\n)/g,"");if(s==""){u={status:l,msg:false,json:false,response:n}}else{u={status:q,msg:false,json:false,response:n}}}}else{u={status:l,msg:false,json:false,response:""}}}return u}});function d(k){var j=this;j.__attrs={};h.mix(j.__attrs,{action:b,timeout:0,CORS:g,async:c,dataType:"text",fileStatus:b,uploadType:g,data:{}});h.mix(j.__attrs,k);j._init()}h.mix(d,{event:{SUCCESS:"success",ERROR:"error",PROGRESS:"progress"}});h.mix(d.prototype,h.obj.customEvent);h.mix(d.prototype,{get:function(k){var j=this;if(k in j.__attrs){return j.__attrs[k]}return""},set:function(l,k){var j=this;if(l in j.__attrs){j.__attrs[l]=k}},upload:function(k){var j=this,l=j.get("uploadType");if(k&&h.isObject(k)){if(!k.size){k.size=0}else{if(!k.name){k.name=k.fileName||b}if(!k.id){k.id=h.guid("file-")}if(k.size){k.textSize=j._convertByteSize(k.size)}}}return l.uploadToServer(k)},abort:function(){var j=this,k=j.get("uploadType");k.abort();return true},setRequestHeader:function(k,m){var j=this,l=j.get("uploadType");l.setRequestHeader(k,m)},_convertByteSize:function(j){var k=-1;do{j=j/1024;k++}while(j>99&&k<4);return Math.max(j,0.1).toFixed(1)+["KB","MB","GB","TB"][k]},_init:function(){var j=this;var m={action:j.get("action"),data:j.get("data"),CORS:j.get("CORS")},l=new a(m);var k=l.get("ajaxConfig");if(k){k.dataType=j.get("dataType");k.async=j.get("async")}l.on(a.event.SUCCESS,j._uploadCompleteHandler,j);l.on(a.event.ERROR,j._uploadCompleteHandler,j);l.on(a.event.PROGRESS,j._uploadProgressHandler,j);j.set("uploadType",l);return l},_uploadProgressHandler:function(k){var j=this;j.fire(d.event.PROGRESS,k)},_uploadCompleteHandler:function(n){var k=this,j=n.status,m=n.msg,l=k.get("file");h.mix(n,{file:l});if(j==="success"){k.fire(d.event.SUCCESS,n)}else{if(m===false){}else{if(m==="abort"){h.mix(n,{canceled:true})}else{if(m==="timeout"){h.mix(n,{timeout:true})}}}k.fire(d.event.ERROR,n)}}});h.BIO=d})(dynamsoft.lib);var OnWebTwainNotFoundOnWindowsCallback=OnWebTwainNotFoundOnWindowsCallback||false,OnWebTwainNotFoundOnMacCallback=OnWebTwainNotFoundOnMacCallback||false,OnWebTwainNotFoundOnLinuxCallback=OnWebTwainNotFoundOnLinuxCallback||false,OnWebTwainOldPluginNotAllowedCallback=OnWebTwainOldPluginNotAllowedCallback||false,OnWebTwainNeedUpgradeCallback=OnWebTwainNeedUpgradeCallback||false,OnWebTwainPreExecuteCallback=OnWebTwainPreExecuteCallback||false,OnWebTwainPostExecuteCallback=OnWebTwainPostExecuteCallback||false,OnWebTwainShowUpdatingDialog=OnWebTwainShowUpdatingDialog||false,OnWebTwainCloseUpdatingDialog=OnWebTwainCloseUpdatingDialog||false,OnRemoteWebTwainNotFoundCallback=OnRemoteWebTwainNotFoundCallback||false,OnRemoteWebTwainNeedUpgradeCallback=OnRemoteWebTwainNeedUpgradeCallback||false,OnWebTWAINDllDownloadSuccessful=OnWebTWAINDllDownloadSuccessful||false,OnWebTWAINDllDownloadFailure=OnWebTWAINDllDownloadFailure||false,Dynamsoft_ChangeConfig=Dynamsoft_ChangeConfig||false,Dynamsoft_OnLoad=Dynamsoft_OnLoad||false,Dynamsoft_OnNotReady=Dynamsoft_OnNotReady||false,Dynamsoft_OnReady=Dynamsoft_OnReady||false;if(!Dynamsoft.Lib){Dynamsoft.Lib={}}(function(a,c){var b=c.mix;b(a,c)})(Dynamsoft.Lib,dynamsoft.lib);(function(b){var a={},c={encodeChars:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",decodeChars:[-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,-1,62,-1,-1,-1,63,52,53,54,55,56,57,58,59,60,61,-1,-1,-1,-1,-1,-1,-1,0,1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,-1,-1,-1,-1,-1,-1,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,50,51,-1,-1,-1,-1,-1]};a.base64={UTF16ToUTF8:function(k){var h=[],e=k.length;for(var g=0;g<e;g++){var j=k.charCodeAt(g);if(j>0&&j<=127){h.push(k.charAt(g))}else{if(j>=128&&j<=2047){var f=192|((j>>6)&31);var d=128|(j&63);h.push(String.fromCharCode(f),String.fromCharCode(d))}else{if(j>=2048&&j<=65535){var f=224|((j>>12)&15);var d=128|((j>>6)&63);var l=128|(j&63);h.push(String.fromCharCode(f),String.fromCharCode(d),String.fromCharCode(l))}else{if(j>=65536&&j<=2097151){}else{if(j>=2097152&&j<=67108863){}else{}}}}}}return h.join("")},UTF8ToUTF16:function(j){var h=[],g=j.length;var f=0;for(var f=0;f<g;f++){var d=j.charCodeAt(f);if(((d>>7)&255)==0){h.push(j.charAt(f))}else{if(((d>>5)&255)==6){var m=j.charCodeAt(++f);var n=(d&31)<<6;var l=m&63;var e=n|l;h.push(String.fromCharCode(e))}else{if(((d>>4)&255)==14){var m=j.charCodeAt(++f);var k=j.charCodeAt(++f);var n=(d<<4)|((m>>2)&15);var l=((m&3)<<6)|(k&63);var e=((n&255)<<8)|l;h.push(String.fromCharCode(e))}else{if(((d>>3)&255)==30){}else{if(((d>>2)&255)==62){}else{}}}}}}return h.join("")},encode:function(l){var k=this.UTF16ToUTF8(l),f=[],h=0,d=k.length,j,g,e;while(h<d){j=k.charCodeAt(h++)&255;if(h==d){f.push(c.encodeChars.charAt(j>>2));f.push(c.encodeChars.charAt((j&3)<<4));f.push("==");break}g=k.charCodeAt(h++);if(h==d){f.push(c.encodeChars.charAt(j>>2));f.push(c.encodeChars.charAt(((j&3)<<4)|((g&240)>>4)));f.push(c.encodeChars.charAt((g&15)<<2));f.push("=");break}e=k.charCodeAt(h++);f.push(c.encodeChars.charAt(j>>2));f.push(c.encodeChars.charAt(((j&3)<<4)|((g&240)>>4)));f.push(c.encodeChars.charAt(((g&15)<<2)|((e&192)>>6)));f.push(c.encodeChars.charAt(e&63))}return f.join("")},encodeArray:function(k){var f=[],h=0,d=k.length,j,g,e;while(h<d){j=k[h++]&255;if(h==d){f.push(c.encodeChars.charAt(j>>2));f.push(c.encodeChars.charAt((j&3)<<4));f.push("==");break}g=k[h++]&255;if(h==d){f.push(c.encodeChars.charAt(j>>2));f.push(c.encodeChars.charAt(((j&3)<<4)|((g&240)>>4)));f.push(c.encodeChars.charAt((g&15)<<2));f.push("=");break}e=k[h++]&255;f.push(c.encodeChars.charAt(j>>2));f.push(c.encodeChars.charAt(((j&3)<<4)|((g&240)>>4)));f.push(c.encodeChars.charAt(((g&15)<<2)|((e&192)>>6)));f.push(c.encodeChars.charAt(e&63))}return f.join("")},decode:function(m){var k=this,g=[],j=0,l=m.length,h,f,e,d;while(j<l){do{h=c.decodeChars[m.charCodeAt(j++)&255]}while(j<l&&h==-1);if(h==-1){break}do{f=c.decodeChars[m.charCodeAt(j++)&255]}while(j<l&&f==-1);if(f==-1){break}g.push(String.fromCharCode((h<<2)|((f&48)>>4)));do{e=m.charCodeAt(j++)&255;if(e==61){return k.UTF8ToUTF16(g.join(""))}e=c.decodeChars[e]}while(j<l&&e==-1);if(e==-1){break}g.push(String.fromCharCode(((f&15)<<4)|((e&60)>>2)));do{d=m.charCodeAt(j++)&255;if(d==61){return k.UTF8ToUTF16(g.join(""))}d=c.decodeChars[d]}while(j<l&&d==-1);if(d==-1){break}g.push(String.fromCharCode(((e&3)<<6)|d))}return k.UTF8ToUTF16(g.join(""))}};a.utf8={fromUTF16:function(g){var e=[],f=0,d=g.length,h;while(f<d){h=g.charCodeAt(f);if((h>=1)&&(h<=127)){e.push(g.charAt(f))}else{if(h>2047){e.push(String.fromCharCode(224|((h>>12)&15)));e.push(String.fromCharCode(128|((h>>6)&63)));e.push(String.fromCharCode(128|((h>>0)&63)))}else{e.push(String.fromCharCode(192|((h>>6)&31)));e.push(String.fromCharCode(128|((h>>0)&63)))}}f++}return e.join("")},toUTF16:function(j){var e=[],g=0,d=j.length,k,h,f;while(g<d){k=j.charCodeAt(g++);switch(k>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:e.push(j.charAt(g-1));break;case 12:case 13:h=j.charCodeAt(g++);e.push(String.fromCharCode(((k&31)<<6)|(h&63)));break;case 14:h=j.charCodeAt(g++);f=j.charCodeAt(g++);e.push(String.fromCharCode(((k&15)<<12)|((h&63)<<6)|((f&63)<<0)));break}}return e.join("")}};b.mix(b,a)})(Dynamsoft.Lib);(function(a){var b=Dynamsoft.WebTwainEnv;Dynamsoft.WebTwainEnv={JSVersion:"13.4.1.0502",ServerVersionInfo:"13,3,0,0115",ActiveXVersion:"12,3,0,0",PluginVersion:"11,1,0,0",Containers:false,ContainerMap:{},DynamicContainers:[],DynamicDWTMap:{},ProductKey:"",Trial:true,ResourcesPath:"Resources",Debug:false,IfUpdateService:false,AutoLoad:true,OnWebTwainReady:false,UseDefaultInstallUI:true,OnWebTwainNotFound:false,OnWebTwainOldPluginNotAllowed:false,OnWebTwainNeedUpgrade:false,OnWebTwainNeedUpgradeWebJavascript:false,OnWebTwainInitMessage:false,IfUseActiveXForIE10Plus:true};a.mix(Dynamsoft.WebTwainEnv,b);Dynamsoft.WebTwainEnv.RegisterEvent=function(c,d){if((c==="OnWebTwainReady"||!Dynamsoft.WebTwainEnv.UseDefaultInstallUI)&&a.isFunction(d)){Dynamsoft.WebTwainEnv[c]=d}else{if((c==="OnWebTwainInitMessage")&&a.isFunction(d)){Dynamsoft.WebTwainEnv[c]=d}}return true}})(Dynamsoft.Lib);(function(n,j,b){var h=!0,s=!1,x=navigator.userAgent.toLowerCase(),w=document.location.protocol,c=location.hostname,e=location.pathname,q=b.bSSL,t=b.bMac,A=b.bLinux,v=b.bWin,k=b.isX64,l=b.bSafari,m=b.bFirefox,o=b.bEdge,r=b.bChrome,u=b.bIE,z=b.bFileSystem,y=parseFloat(b.strBrowserVersion),g=s,f=s,p=s,d=0,a,i;if(r||m){if(y>=27){g=h}else{f=h}}else{if(o){g=h}else{if(u){if(y===""||y>8){if(y>=10&&Dynamsoft.WebTwainEnv.IfUseActiveXForIE10Plus==false){g=h}else{f=h}}else{p=h}}else{if(l){if(y>=7){g=h}else{f=h}}else{f=h}}}}if(c===""){if(v&&e.lastIndexOf("\\")>1){e=e.substring(1,e.lastIndexOf("\\")).replace(/%20/g," ")}else{d=1;e=e.substring(1,e.lastIndexOf("/")).replace(/%20/g," ")}}else{d=1;e=e.substring(0,e.lastIndexOf("/"))}a={product:{name:"Dynamic Web TWAIN",bChromeEdition:g,bPluginEdition:f,bActiveXEdition:p,ip:dynamsoft.dcp.ip,wsProtocol:"dwt_command",_iImageCaptureDriverType:3,_iBrokerProcessType:1,getChromeEditionPath:function(){var B;if(t){B="/DynamsoftServiceSetup.pkg"}else{if(A){B="/DynamsoftServiceSetup.deb"}else{B="/DynamsoftServiceSetup.exe"}}return Dynamsoft.WebTwainEnv.ResourcesPath+B},getLinuxHTML5DebPath:function(){var B="/DynamsoftServiceSetup.deb";return Dynamsoft.WebTwainEnv.ResourcesPath+B},getLinuxHTML5RpmPath:function(){var B="/DynamsoftServiceSetup.rpm";return Dynamsoft.WebTwainEnv.ResourcesPath+B},getPKGPath:function(){var B;B="/DynamicWebTWAINMacEdition.pkg";return Dynamsoft.WebTwainEnv.ResourcesPath+B},getMSIPath:function(){return Dynamsoft.WebTwainEnv.ResourcesPath+"/DynamicWebTWAINPlugIn.msi"},getActiveXCABx86Path:function(){if(!Dynamsoft.WebTwainEnv.ActiveXInstallWithCAB){return Dynamsoft.WebTwainEnv.ResourcesPath+"/DynamicWebTWAINActiveX.exe"}else{return Dynamsoft.WebTwainEnv.ResourcesPath+"/DynamicWebTWAIN.cab"}},getActiveXCABx64Path:function(){if(!Dynamsoft.WebTwainEnv.ActiveXInstallWithCAB){return Dynamsoft.WebTwainEnv.ResourcesPath+"/DynamicWebTWAINActiveX.exe"}else{return Dynamsoft.WebTwainEnv.ResourcesPath+"/DynamicWebTWAINx64.cab"}},strMIMEType:"Application/DynamicWebTwain-Plugin",strProClassID:"5220cb21-c88d-11cf-b347-00aa00a28331",strFullClassID:"E7DA7F8D-27AB-4EE9-8FC0-3FEC9ECFE758",strTrialClassID:"FFC6F181-A5CF-4ec4-A441-093D7134FBF2",scripts:{}},env:{bIE:u,bChrome:r,bFirefox:m,bSafari:l,bEdge:o,bWin:v,bWin64:(x.indexOf("win64")!=-1||x.indexOf("x64")!=-1),bMac:t,bLinux:A,isX64:k,iPluginLength:(u||o)?0:navigator.plugins.length,strChromeVersion:r?y:"",strFirefoxVersion:m?y:"",strIEVersion:(u||o)?y:"",bFileSystem:z,basePath:e,pathType:d},config:{debug:s,devMode:s,usingMainMode:s,bDiscardBlankImage:s,msg:[],msgPrefix:'<span style="color:#cE5E04"><b>',msgSuffix:"</b></span><br />"},detect:{ssl:q,dcpStatus:0,dcpCallbackType:0,arySTwains:[],arySTwainsByIP:[],aryReconnectSTwains:[],bFirst:h,bOK:s,__dialog:s,scriptLoaded:s,bNoControlEvent:s,bNeedUpgradeEvent:s,StartWSTimeoutId:s,StartWSByIPTimeoutId:s,bPromptJSOrServerOutdated:s,detectType:q?1:(w==="http:"||c==="")?0:-1,tryTimes:0,ports:[{port:18623,ssl:h},{port:18996,ssl:h},{port:18622,ssl:s},{port:18995,ssl:s}],cUrlIndex:0,urls:[],onNoControl:s,onNotAllowedForChrome:s,OnDetectNext:s,OnCreatWS:s},page:{bUnload:s,OnUnload:s},tmp:{IfAllowLocalCache:h,EmptyFunction:function(){}}};a.appendMessage=function(C){if(typeof(C)==="string"){a.config.msg.push(C)}else{if(Object.prototype.toString.call(C)==="[object Array]"){for(var B in C){a.appendMessage(C[B])}}}};a.appendRichMessage=function(B){a.appendMessage([a.config.msgPrefix,B,a.config.msgSuffix])};a.clearMessage=function(){if(u&&y==8){a.config.msg.splice(0,a.config.msg.length)}else{a.config.msg.splice(0)}return h};a.getRealPath=function(B){if(B===undefined){return""}if(a.env.pathType==1){return a.env.basePath+B}return a.env.basePath+B.replace(new RegExp("/","g"),"\\\\")};a.getHex=function(C){var B;B=Number(C).toString(16).toUpperCase();if(B.length==1){B=["0",B].join("")}return B};a.getColor=function(D){var C,B,F,E;B=D>>16;F=(D&65280)>>8;E=D&255;C=["#",a.getHex(E),a.getHex(F),a.getHex(B)].join("");return C};a.isLocalIP=function(B){return B&&(B==="127.0.0.1"||B==="localhost"||B==="local.dynamsoft.com")};n.mix(n,a);n.Addon_Events=[];n.Addon_Sendback_Events=[]})(Dynamsoft.Lib,dynamsoft.lib,dynamsoft.navInfo);(function(b){var a={getHexColor:function(e){var f=this,c=e.length,d=[];if(c===7){d.push(parseInt("0x"+e.slice(1,3)));d.push(parseInt("0x"+e.slice(3,5)));d.push(parseInt("0x"+e.slice(5,7)));return d}return[128,128,128]},drawBoxBorder:function(n,c,h,m,j,l,r){var q=this,g,f,s,k,v,e,u,t,o,d,w;t=Math.floor(c);o=Math.floor(h);d=Math.floor(m);w=Math.floor(j);v=n.getImageData(t,o,d,w);k=v.data;e=q.getHexColor(l);if(b.isUndefined(r)){u=e}else{u=q.getHexColor(r)}s=0;for(g=0;g<d;g++){k[s]=e[0];k[s+1]=e[1];k[s+2]=e[2];s+=4}g=0;for(f=0;f<w;f++){s=(f*d+g)*4;k[s]=e[0];k[s+1]=e[1];k[s+2]=e[2]}for(f=0;f<w;f++){g=d-1;s=(f*d+g)*4;k[s]=u[0];k[s+1]=u[1];k[s+2]=u[2]}s=(w-1)*d*4;for(g=0;g<d;g++){k[s]=u[0];k[s+1]=u[1];k[s+2]=u[2];s+=4}n.putImageData(v,t,o)},drawImageWithHermite:function(M,l,p,n,o,f){var c=M.width,h=M.height,A=Math.min(o,l.width),q=Math.min(f,l.height),N=M.getContext("2d").getImageData(0,0,c,h),L=l.getContext("2d").getImageData(p,n,A,q),J=N.data,I=L.data,m=c/A,E=h/q,z=Math.ceil(m/2),C=Math.ceil(E/2),G,F;for(F=0;F<q;F++){for(G=0;G<A;G++){var D=gx_g=gx_b=gx_a=0,H=(G+F*A)*4,v=0,K=0,d=0,g=(F+0.5)*E;for(var B=Math.floor(F*E);B<(F+1)*E;B++){var s=Math.abs(g-(B+0.5))/C,k=(G+0.5)*m,u=s*s;for(var e=Math.floor(G*m);e<(G+1)*m;e++){var t=Math.abs(k-(e+0.5))/z,r=Math.sqrt(u+t*t);if(r>=-1&&r<=1){v=2*r*r*r-3*r*r+1;if(v>0){t=4*(e+B*c);gx_a+=v*J[t+3];d+=v;if(J[t+3]<255){v=v*J[t+3]/250}D+=v*J[t];gx_g+=v*J[t+1];gx_b+=v*J[t+2];K+=v}}}}I[H]=D/K;I[H+1]=gx_g/K;I[H+2]=gx_b/K;I[H+3]=gx_a/d}}l.getContext("2d").clearRect(0,0,l.width,l.height);l.getContext("2d").putImageData(L,p,n)}};b.mix(b,a)})(Dynamsoft.Lib);(function(a){a.DOM={getOffset:function(k,f){var c=k.target,j=0,i=0,g=0,h=0,b,e,d=false;while(c&&!isNaN(c.offsetLeft)&&!isNaN(c.offsetTop)){e=c.scrollLeft;b=c.scrollTop;if(c.tagName==="BODY"){if(d){e=0;b=0}else{e=e|document.documentElement.scrollLeft;b=b|document.documentElement.scrollTop}}else{if(c.style.position==="fixed"){d=true}}j+=c.offsetLeft-e;i+=c.offsetTop-b;c=c.offsetParent}if(f){g=f.Left;h=f.Top}j=k.clientX-j-g;i=k.clientY-i-h;return{x:j,y:i}}}})(Dynamsoft.Lib);Dynamsoft.Lib.ready(function(){Dynamsoft.Lib.install={_divInstallBody:"dwt-InstallBody",_divDWTNonInstallContainerID:"dwt-NonInstallContainerID",_divDWTemessageContainer:"",_dlgInstall:false};Dynamsoft.Lib.install._strDynamsoftWithClose=['<div class="dynamsoft-dwt-dlg-header">','<div class="dynamsoft-dialog-close"></div>',"</div>"].join("");Dynamsoft.Lib.install._strDynamsoftWithoutClose=['<div style="height:40px;"></div>'].join("");Dynamsoft.Lib.install._strNonInstallDIV=['<div style="text-align:center;" id="',Dynamsoft.Lib.install._divDWTNonInstallContainerID,'"></div>'].join("")});Dynamsoft.WebTwainEnv.CloseDialog=function(){var a=Dynamsoft.Lib,d=a.install._dlgInstall;if(d){var c=a.all(".dynamsoft-dialog-close");a.each(c,function(e,f){a.removeEventListener(e,"click",DCP_DWT_OnClickCloseInstall)});if(d.open){d.close()}if(a.install._dlgFromImageEditor){var b=a.one(".D_ImageUIEditor")[0].parentNode;b.removeChild(d)}else{document.body.removeChild(d)}a.install._dlgInstall=false}};Dynamsoft.WebTwainEnv.ShowDialog=function(g,j,k,a,h){var b=Dynamsoft.Lib,e=b.install,n;if(!b.get("dynamsoft_waiting")){var c=document.createElement("div");c.className="dynamsoft-dialog-wrap";c.style.width="100%";n=['<div id="dynamsoft_waiting" class="dynamsoft-dialog dynamsoft-dialog2">','<div id="',e._divInstallBody,'"></div></div>'];c.innerHTML=n.join("");if(a){var d=b.one(".D_ImageUIEditor")[0].parentNode;d.appendChild(c)}else{document.body.appendChild(c)}e._dlgFromImageEditor=a;e._dlgInstall=c;b.dialog.setup(e._dlgInstall)}if(k===false){return}var i=Dynamsoft.Lib.one(".dynamsoft-dialog");if(i&&i[0]){i[0].style.width=g+"px";if(j&&j>0){i[0].style.height=j+"px"}}if(a){b.get(e._divInstallBody).innerHTML=['<div class="dynamsoft-dwt-dialog-body">',k,"</div>"].join("")}else{var l=(h?e._strDynamsoftWithoutClose:e._strDynamsoftWithClose);b.get(e._divInstallBody).innerHTML=['<div class="dynamsoft-dwt-dialog-body">',l,k,"</div>"].join("")}var m=b.get("dynamsoft_waiting");m.style.width=g;if(e._dlgInstall.open){e._dlgInstall.close()}e._dlgInstall.showModal();var f=b.all(".dynamsoft-dialog-close");b.each(f,function(p,q){b.addEventListener(p,"click",DCP_DWT_OnClickCloseInstall)})};Dynamsoft.WebTwainEnv.OnWebTwainPreExecute=function(){Dynamsoft.Lib.detect.OnWebTwainPreExecute()};Dynamsoft.WebTwainEnv.OnWebTwainPostExecute=function(){Dynamsoft.Lib.detect.OnWebTwainPostExecute()};function DCP_DWT_OnClickCloseInstall(a){var d=Dynamsoft.Lib,f=d.install._dlgInstall;Dynamsoft.WebTwainEnv.CloseDialog();var c=d.get(d.install._divDWTNonInstallContainerID);if(c){c.parentNode.removeChild(c)}if(a&&d.isString(a)){d.show(a)}else{var b,e;e=Dynamsoft.WebTwainEnv.Containers;if(e){for(b=0;b<e.length;b++){d.show(e[b].ContainerId)}}e=Dynamsoft.WebTwainEnv.DynamicContainers;if(e){for(b=0;b<e.length;b++){d.show(e[b])}}e=null}if(d.install._divDWTemessageContainer!=""){d.show(d.install._divDWTemessageContainer)}}(function(a){a.mix(a.detect,{global_dlg:false,__dialog:false});a.detect.showMask=function(){if(!Dynamsoft.WebTwainEnv.ScanDirectly){if(a.isFunction(OnWebTwainPreExecuteCallback)){OnWebTwainPreExecuteCallback()}else{a.detect.OnWebTwainPreExecute()}}};a.detect.OnWebTwainPreExecute=function(){if(a.detect.__dialog){return}var d=[Dynamsoft.WebTwainEnv.ResourcesPath,"/reference/loading.gif"].join(""),c=['<div style="margin:0 auto;width:100px;line-height:300px"><img src="',d,'" /></div>'].join("");var b=document.createElement("div");b.className="dynamsoft-dialog-wrap";b.innerHTML=c;document.body.appendChild(b);a.detect.__dialog=b;a.dialog.setup(a.detect.__dialog);a.detect.__dialog.showModal()};a.detect.hideMask=function(){if(!Dynamsoft.WebTwainEnv.ScanDirectly){if(a.isFunction(OnWebTwainPostExecuteCallback)){OnWebTwainPostExecuteCallback()}else{a.detect.OnWebTwainPostExecute()}}};a.detect.OnWebTwainPostExecute=function(){var b=a.detect.__dialog;if(b){b.close();document.body.removeChild(b);a.detect.__dialog=false}}})(Dynamsoft.Lib);(function(b){a.Orientation={Horizontal:0,Vertical:1};a.Direction={LeftToRight:0,RightToLeft:1,TopToBottom:0,BottomToTop:1};a.CreationType={Replace:0,AppendChild:1};a.AnimationStyle={None:0,Static:1,StaticFull:2,Custom:3,CustomFull:4,Flickering1:10,Flickering2:11,Flickering3:12,LeftToRight1:20,LeftToRight2:21,RightToLeft1:22,RightToLeft2:23,TwoWay:24};function a(g,d){var h=this,e=0,f;if(b.isString(g)){f=document.getElementById(g)}else{f=g}h.isLoaded=false;h.displayType=0;h.progress=0;h.progressPosition=0;h.borderWidth={left:0,right:0,top:0,bottom:0};h.orientation=(d.orientation||a.Orientation.Horizontal);h.direction=(d.direction||a.Direction.LeftToRight);h.creationType=(d.creationType||a.CreationType.Replace);h.value=0;h.initialValue=(d.value||0);h.minValue=(d.minValue||0);h.maxValue=(d.maxValue||100);h.showLabel=(typeof d.showLabel=="undefined"?true:d.showLabel);h.labelText=(d.labelText||"");h.width=(d.width||300);h.height=(d.height||20);h.borderRadius=(d.borderRadius||10);if(h.orientation==a.Orientation.Horizontal&&h.borderRadius>h.height/2){h.borderRadius=Math.round(h.height/2)}if(h.orientation==a.Orientation.Vertical&&h.borderRadius>h.width/2){h.borderRadius=Math.round(h.width/2)}h.backColor=(d.backColor||"");h.color=(d.color||"#fe8e14");h.animationStyle=0;h.animationInterval=(d.animationInterval||100);var c=["parent","background","wrapper","left","middle","right","horizontalText","verticalText","marker"];h.extraClassName={};for(e=0;e<c.length;e++){if(!d.extraClassName){h.extraClassName[c[e]]=""}else{if(typeof d.extraClassName=="string"){h.extraClassName[c[e]]=d.extraClassName}else{h.extraClassName[c[e]]=(d.extraClassName[c[e]]||"")}}}h.onLoad=(d.onLoad||null);h.onValueChanged=(d.onValueChanged||null);h.onAnimate=(d.onAnimate||null);if(h.creationType==a.CreationType.Replace){h.parentElement=f}else{h.parentElement=document.createElement("DIV");f.appendChild(h.parentElement)}h.finishLoading()}a.prototype.finishLoading=function(){var h=this,e="",g;h.wrapperElement=null;h.backgroundElement=null;h.valueElement=null;h.leftElement=null;h.middleElement=null;h.rightElement=null;h.backgroundElement=document.createElement("DIV");h.backgroundElement.className="progressbar_background"+(h.extraClassName.background?" ":"")+h.extraClassName.background;h.backgroundElement.style.cssText=h.backgroundElement.style.cssText+a._createBorderRadiusCss(h.borderRadius);h.parentElement.appendChild(h.backgroundElement);var d=["border-radius","border-bottom-right-radius","-moz-border-radius-bottomright","-webkit-border-bottom-right-radius","-khtml-border-radius-bottomright","-khtml-border-bottom-right-radius"];var f=0,c="";for(f=0;f<d.length;f++){c=a._elementCurrentStyle(h.backgroundElement,d[f]);if(c||typeof c=="string"){break}}if(c!=""&&a._parseInt(c)!=h.borderRadius){h.borderRadius=a._parseInt(c)}if((h.orientation==a.Orientation.Horizontal)||(h.orientation==a.Orientation.Vertical)){h.displayType=0}else{h.displayType=1}h.parentElement.className=(h.parentElement.className!=""?" ":"")+"progressbar_parent"+(h.extraClassName.parent?" ":"")+h.extraClassName.parent;if(h.displayType==0){g=h.wrapperElement=document.createElement("DIV");g.style.border="1px solid #A0A0A0";g.style.cssFloat="left";g.style.display="inline-block";g.style.width=h.width+"px";g.style.height=h.height+"px";g.style.left="0px";g.style.top=(-h.height)+"px";g.style.backgroundColor=h.backColor;g.style.backgroundRepeat="no-repeat";g.style.position="relative";g.style.cssText=g.style.cssText+a._createBorderRadiusCss(h.borderRadius);h.parentElement.appendChild(g);h.borderWidth={left:a._parseInt(a._elementCurrentStyle(g,"border-left-width")),right:a._parseInt(a._elementCurrentStyle(g,"border-right-width")),top:a._parseInt(a._elementCurrentStyle(g,"border-top-width")),bottom:a._parseInt(a._elementCurrentStyle(g,"border-bottom-width"))}}else{if(h.displayType==1){if(h.orientation==a.Orientation.Horizontal){if(h.borderRadius>h.width/2){h.borderRadius=h.width}}else{if(h.orientation==a.Orientation.Vertical){if(h.borderRadius>h.height/2){h.borderRadius=h.height}}}h.valueElement=document.createElement("DIV");h.valueElement.className="";h.leftElement=document.createElement("DIV");h.middleElement=document.createElement("DIV");h.rightElement=document.createElement("DIV");h.leftElement.style.border="1px solid #A0A0A0";h.leftElement.style.cssFloat="left";h.leftElement.style.display="inline-block";h.leftElement.style.backgroundColor=h.backColor;h.leftElement.style.backgroundRepeat="no-repeat";h.leftElement.style.position="relative";h.rightElement.style.border="1px solid #A0A0A0";h.rightElement.style.cssFloat="left";h.rightElement.style.display="inline-block";h.rightElement.style.backgroundColor=h.backColor;h.rightElement.style.backgroundRepeat="no-repeat";h.rightElement.style.position="relative";h.middleElement.style.border="1px solid #A0A0A0";h.middleElement.style.cssFloat="left";h.middleElement.style.display="inline-block";h.middleElement.style.overflow="hidden";h.middleElement.style.position="relative";h.valueElement.style.backgroundColor=h.backColor;h.valueElement.style.position="relative";if(h.orientation==a.Orientation.Horizontal){h.leftElement.style.width=h.borderRadius+"px";h.leftElement.style.height=h.height+"px";h.leftElement.style.top=-h.height+"px";h.leftElement.style.left="0px";h.leftElement.style.borderRight="none";h.leftElement.style.cssText=h.leftElement.style.cssText+a._createBorderRadiusCss(h.borderRadius,0,0,h.borderRadius);h.rightElement.style.width=h.borderRadius+"px";h.rightElement.style.height=h.height+"px";h.rightElement.style.top=-h.height+"px";h.rightElement.style.borderLeft="none";h.rightElement.style.cssText=h.rightElement.style.cssText+a._createBorderRadiusCss(0,h.borderRadius,h.borderRadius,0);h.middleElement.style.width=(h.width-(h.borderRadius*2))+"px";h.middleElement.style.height=h.height+"px";h.middleElement.style.top=-h.height+"px";h.middleElement.style.borderLeft="none";h.middleElement.style.borderRight="none";h.valueElement.style.width="0px";h.valueElement.style.height=h.height+"px"}else{if(h.orientation==a.Orientation.Vertical){h.leftElement.style.width=h.width+"px";h.leftElement.style.height=h.borderRadius+"px";h.leftElement.style.top=(-h.height)+"px";h.leftElement.style.left="0px";h.leftElement.style.borderBottom="none";h.leftElement.style.cssText=h.leftElement.style.cssText+a._createBorderRadiusCss(h.borderRadius,h.borderRadius,0,0);h.rightElement.style.width=h.width+"px";h.rightElement.style.height=h.borderRadius+"px";h.rightElement.style.top=(-h.height)+"px";h.rightElement.style.left="0px";h.rightElement.style.borderTop="none";h.rightElement.style.cssText=h.rightElement.style.cssText+a._createBorderRadiusCss(0,0,h.borderRadius,h.borderRadius);h.middleElement.style.width=h.width+"px";h.middleElement.style.height=h.height-h.borderRadius*2+"px";h.middleElement.style.top=(-h.height)+"px";h.middleElement.style.left="0px";h.middleElement.style.borderTop="none";h.middleElement.style.borderBottom="none";h.valueElement.style.width=h.width+"px";h.valueElement.style.height="0px"}}h.middleElement.appendChild(h.valueElement);h.parentElement.appendChild(h.leftElement);h.parentElement.appendChild(h.middleElement);h.parentElement.appendChild(h.rightElement);if(h.orientation==a.Orientation.Horizontal){h.borderWidth={left:a._parseInt(a._elementCurrentStyle(h.leftElement,"border-left-width")),right:a._parseInt(a._elementCurrentStyle(h.rightElement,"border-right-width")),top:a._parseInt(a._elementCurrentStyle(h.middleElement,"border-top-width")),bottom:a._parseInt(a._elementCurrentStyle(h.middleElement,"border-bottom-width"))}}else{if(h.orientation==a.Orientation.Vertical){h.borderWidth={left:a._parseInt(a._elementCurrentStyle(h.middleElement,"border-left-width")),right:a._parseInt(a._elementCurrentStyle(h.middleElement,"border-right-width")),top:a._parseInt(a._elementCurrentStyle(h.leftElement,"border-top-width")),bottom:a._parseInt(a._elementCurrentStyle(h.rightElement,"border-bottom-width"))}}}}}h.parentElement.style.width=(h.width+h.borderWidth.left+h.borderWidth.right)+"px";h.parentElement.style.height=(h.height+h.borderWidth.top+h.borderWidth.bottom)+"px";h.backgroundElement.style.cssFloat="left";h.backgroundElement.style.display="inline-block";h.backgroundElement.style.width=(h.width+h.borderWidth.left+h.borderWidth.right)+"px";h.backgroundElement.style.height=h.height+"px";h.backgroundElement.style.backgroundColor="#FFFFFF";h.backgroundElement.style.position="relative";if(h.displayType==0){h.backgroundElement.style.width=(h.width+h.borderWidth.left+h.borderWidth.right)+"px"}h.backgroundElement.style.top=h.borderWidth.top+"px";h.markerElement=document.createElement("DIV");h.markerElement.style.display="inline-block";h.markerElement.style.zoom="1.0";h.markerElement.style.width=h.width+"px";h.markerElement.style.height=h.height+"px";h.markerElement.style.top=(-h.height*2-h.borderWidth.top)+"px";h.markerElement.style.left=h.borderWidth.left+"px";h.markerElement.style.backgroundColor=h.color;h.markerElement.style.lineHeight=(h.height)+"px";h.markerElement.style.position="relative";h.parentElement.appendChild(h.markerElement);h.isLoaded=true;h.setValue(h.initialValue);if(h.onLoad!=null){h.onLoad()}};a.prototype.setValue=function(e){var i=this;if(e!==null&&e<i.minValue){e=i.minValue}if(e!==null&&e>i.maxValue){e=i.maxValue}if(e===null){}else{i.value=e}if(i.isLoaded){var c=0;if(i.orientation==a.Orientation.Horizontal){c=(i.value/i.maxValue)*i.width;i.progressPosition=c;if(i.displayType==0){if(i.direction==a.Direction.LeftToRight){}else{}}else{if(i.displayType==1){if(i.direction==a.Direction.LeftToRight){if(c<=i.borderRadius){i.valueElement.style.width="0px"}else{if(c>=i.width-i.borderRadius){i.valueElement.style.width=i.middleElement.style.width}else{i.valueElement.style.width=(c-i.borderRadius)+"px"}}}else{if(c<=i.borderRadius){i.valueElement.style.width="0px"}else{if(c>=i.width-i.borderRadius){i.valueElement.style.left="0px";i.valueElement.style.width=i.middleElement.style.width}else{i.valueElement.style.left=(i.width-c-i.borderRadius)+"px";i.valueElement.style.width=(c-i.borderRadius)+"px"}}}}}if(c>0){if(i.animationStyle!=a.AnimationStyle.StaticFull&&i.animationStyle!=a.AnimationStyle.CustomFull){i.markerElement.style.width=c+"px"}else{i.markerElement.style.width=i.width+"px"}i.markerElement.style.visibility="visible"}else{i.markerElement.style.width=i.width+"px";if(i.animationStyle!=a.AnimationStyle.StaticFull&&i.animationStyle!=a.AnimationStyle.CustomFull){i.markerElement.style.visibility="hidden"}}if(i.animationStyle!=a.AnimationStyle.StaticFull&&i.animationStyle!=a.AnimationStyle.CustomFull){if(i.direction==a.Direction.LeftToRight){i.markerElement.style.left=i.borderWidth.left+"px"}else{i.markerElement.style.left=(i.width-c+i.borderWidth.left)+"px"}}else{i.markerElement.style.left=i.borderWidth.left+"px"}var l=(-i.height*2-i.height-i.borderWidth.top);var n=(-i.height*2-i.borderWidth.top);if(c==0||i.width==c){i.markerElement.style.top=n+"px";i.markerElement.style.height=i.height+"px";i.markerElement.style.cssText=i.markerElement.style.cssText+a._createBorderRadiusCss(i.borderRadius)}else{if(c<i.borderRadius){var m=i.height-2.25*(i.borderRadius-Math.sqrt(Math.pow(i.borderRadius,2)-Math.pow(i.borderRadius-c,2)));var j=n+(i.height/2)-(m/2);var d=l-2*(n-j);i.markerElement.style.top=j+"px";i.markerElement.style.height=m+"px";if(i.direction==a.Direction.LeftToRight){i.markerElement.style.cssText=i.markerElement.style.cssText+a._createBorderRadiusCss(i.borderRadius,0,0,i.borderRadius)}else{i.markerElement.style.cssText=i.markerElement.style.cssText+a._createBorderRadiusCss(0,i.borderRadius,i.borderRadius,0)}}else{if(i.width-c<i.borderRadius){var h=((i.borderRadius-(i.width-c))*2+(i.borderRadius-Math.sqrt(Math.pow(i.borderRadius,2)-Math.pow(i.borderRadius-(i.width-c),2))))/3;if(i.direction==a.Direction.LeftToRight){i.markerElement.style.cssText=i.markerElement.style.cssText+a._createBorderRadiusCss(i.borderRadius,h,h,i.borderRadius)}else{i.markerElement.style.cssText=i.markerElement.style.cssText+a._createBorderRadiusCss(h,i.borderRadius,i.borderRadius,h)}}else{i.markerElement.style.top=n+"px";i.markerElement.style.height=i.height+"px";if(i.direction==a.Direction.LeftToRight){i.markerElement.style.cssText=i.markerElement.style.cssText+a._createBorderRadiusCss(i.borderRadius,0,0,i.borderRadius)}else{i.markerElement.style.cssText=i.markerElement.style.cssText+a._createBorderRadiusCss(0,i.borderRadius,i.borderRadius,0)}}}}}else{if(i.orientation==a.Orientation.Vertical){c=(i.value/i.maxValue)*i.height;i.progressPosition=c;if(i.displayType==0){if(i.direction==a.Direction.TopToBottom){}else{}}else{if(i.displayType==1){if(i.direction==a.Direction.TopToBottom){if(c<=i.borderRadius){i.valueElement.style.height="0px"}else{if(c>=i.height-i.borderRadius){i.valueElement.style.height=i.middleElement.style.height}else{i.valueElement.style.height=(c-i.borderRadius)+"px"}}}else{if(c<=i.borderRadius){i.valueElement.style.height="0px"}else{if(c>=i.height-i.borderRadius){i.valueElement.style.top="0px";i.valueElement.style.height=i.middleElement.style.height}else{i.valueElement.style.top=(i.height-c-i.borderRadius)+"px";i.valueElement.style.height=(c+i.borderRadius*2)+"px"}}}}}if(c>0){if(i.animationStyle!=a.AnimationStyle.StaticFull&&i.animationStyle!=a.AnimationStyle.CustomFull){i.markerElement.style.height=c+"px"}else{i.markerElement.style.height=i.height+"px";i.markerElement.style.cssText=i.markerElement.style.cssText+a._createBorderRadiusCss(i.borderRadius)}i.markerElement.style.visibility="visible"}else{i.markerElement.style.height=0+"px";if(i.animationStyle!=a.AnimationStyle.StaticFull&&i.animationStyle!=a.AnimationStyle.CustomFull){i.markerElement.style.visibility="hidden"}}var g=i.borderWidth.left;var k=i.borderWidth.left;if(c==0||i.height==c){i.markerElement.style.left=k+"px";i.markerElement.style.width=i.width+"px";i.markerElement.style.cssText=i.markerElement.style.cssText+a._createBorderRadiusCss(i.borderRadius)}else{if(c<i.borderRadius){var f=2.5*c;if(f>i.width){f=i.width}var o=k+(i.width/2)-(f/2);i.markerElement.style.left=o+"px";i.markerElement.style.width=f+"px";if(i.direction==a.Direction.BottomToTop){i.markerElement.style.cssText=i.markerElement.style.cssText+a._createBorderRadiusCss(0,0,i.borderRadius,i.borderRadius)}else{i.markerElement.style.cssText=i.markerElement.style.cssText+a._createBorderRadiusCss(i.borderRadius,i.borderRadius,0,0)}}else{if(i.height-c<i.borderRadius){var h=((i.borderRadius-(i.height-c))*2+(i.borderRadius-Math.sqrt(Math.pow(i.borderRadius,2)-Math.pow(i.borderRadius-(i.height-c),2))))/3;if(i.direction==a.Direction.BottomToTop){i.markerElement.style.cssText=i.markerElement.style.cssText+a._createBorderRadiusCss(h,h,i.borderRadius,i.borderRadius)}else{i.markerElement.style.cssText=i.markerElement.style.cssText+a._createBorderRadiusCss(i.borderRadius,i.borderRadius,h,h)}}else{i.markerElement.style.left=k+"px";i.markerElement.style.width=i.width+"px";if(i.direction==a.Direction.BottomToTop){i.markerElement.style.cssText=i.markerElement.style.cssText+a._createBorderRadiusCss(0,0,i.borderRadius,i.borderRadius)}else{i.markerElement.style.cssText=i.markerElement.style.cssText+a._createBorderRadiusCss(i.borderRadius,i.borderRadius,0,0)}}}}if(i.animationStyle!=a.AnimationStyle.StaticFull&&i.animationStyle!=a.AnimationStyle.CustomFull){if(i.direction==a.Direction.TopToBottom){i.markerElement.style.top=(-i.height*2-i.borderWidth.top)+"px"}else{i.markerElement.style.top=(-i.height-c-i.borderWidth.top)+"px"}}else{i.markerElement.style.top=(-i.height*2-i.borderWidth.top)+"px"}}}i.progress=(i.value/i.maxValue)}if(i.onValueChanged!=null){i.onValueChanged()}};a._elementCurrentStyle=function(f,e){if(f.currentStyle){var d=0,c="",g=false;for(d=0;d<e.length;d++){if(e[d].toString()!="-"){c+=(g?e[d].toString().toUpperCase():e[d].toString());g=false}else{g=true}}e=c;return f.currentStyle[e]}else{return getComputedStyle(f,null).getPropertyValue(e)}};a._parseInt=function(d){var c=parseInt(d);if(isNaN(c)){c=0}return c};a._createBorderRadiusCss=function(c,e,d,f){if(c!=null&&e==null&&d==null&&f==null){return"; -moz-border-radius: "+c+"px; -ms-border-radius: "+c+"px; -o-border-radius: "+c+"px; -webkit-border-radius: "+c+"px; -khtml-border-radius: "+c+"px; border-radius: "+c+"px;"}else{c=(c||0);e=(e||0);d=(d||0);f=(f||0);return"; -moz-border-radius: "+c+"px "+e+"px "+d+"px "+f+"px; -ms-border-radius: "+c+"px "+e+"px "+d+"px "+f+"px; -o-border-radius: "+c+"px "+e+"px "+d+"px "+f+"px; -webkit-border-radius: "+c+"px "+e+"px "+d+"px "+f+"px; -khtml-border-radius: "+c+"px "+e+"px "+d+"px "+f+"px; border-radius: "+c+"px "+e+"px "+d+"px "+f+"px;"}};b.ProgressBar=a})(Dynamsoft.Lib);var EnumDWT_PixelType={TWPT_BW:0,TWPT_GRAY:1,TWPT_RGB:2,TWPT_PALLETE:3,TWPT_CMY:4,TWPT_CMYK:5,TWPT_YUV:6,TWPT_YUVK:7,TWPT_CIEXYZ:8,TWPT_LAB:9,TWPT_SRGB:10,TWPT_SCRGB:11,TWPT_INFRARED:16};var EnumDWT_BorderStyle={TWBS_NONE:0,TWBS_SINGLEFLAT:1,TWBS_SINGLE3D:2};var EnumDWT_MessageType={TWQC_GET:1,TWQC_SET:2,TWQC_GETDEFAULT:4,TWQC_GETCURRENT:8,TWQC_RESET:16};var EnumDWT_Cap={CAP_NONE:0,CAP_XFERCOUNT:1,ICAP_COMPRESSION:256,ICAP_PIXELTYPE:257,ICAP_UNITS:258,ICAP_XFERMECH:259,CAP_AUTHOR:4096,CAP_CAPTION:4097,CAP_FEEDERENABLED:4098,CAP_FEEDERLOADED:4099,CAP_TIMEDATE:4100,CAP_SUPPORTEDCAPS:4101,CAP_EXTENDEDCAPS:4102,CAP_AUTOFEED:4103,CAP_CLEARPAGE:4104,CAP_FEEDPAGE:4105,CAP_REWINDPAGE:4106,CAP_INDICATORS:4107,CAP_SUPPORTEDCAPSEXT:4108,CAP_PAPERDETECTABLE:4109,CAP_UICONTROLLABLE:4110,CAP_DEVICEONLINE:4111,CAP_AUTOSCAN:4112,CAP_THUMBNAILSENABLED:4113,CAP_DUPLEX:4114,CAP_DUPLEXENABLED:4115,CAP_ENABLEDSUIONLY:4116,CAP_CUSTOMDSDATA:4117,CAP_ENDORSER:4118,CAP_ALARMS:4120,CAP_ALARMVOLUME:4121,CAP_AUTOMATICCAPTURE:4122,CAP_TIMEBEFOREFIRSTCAPTURE:4123,CAP_TIMEBETWEENCAPTURES:4124,CAP_CLEARBUFFERS:4125,CAP_MAXBATCHBUFFERS:4126,CAP_DEVICETIMEDATE:4127,CAP_POWERSUPPLY:4128,CAP_CAMERAPREVIEWUI:4129,CAP_SERIALNUMBER:4132,CAP_PRINTER:4134,CAP_PRINTERENABLED:4135,CAP_PRINTERINDEX:4136,CAP_PRINTERMODE:4137,CAP_PRINTERSTRING:4138,CAP_PRINTERSUFFIX:4139,CAP_LANGUAGE:4140,CAP_FEEDERALIGNMENT:4141,CAP_FEEDERORDER:4142,CAP_REACQUIREALLOWED:4144,CAP_BATTERYMINUTES:4146,CAP_BATTERYPERCENTAGE:4147,CAP_CAMERASIDE:4148,CAP_SEGMENTED:4149,CAP_CAMERAENABLED:4150,CAP_CAMERAORDER:4151,CAP_MICRENABLED:4152,CAP_FEEDERPREP:4153,CAP_FEEDERPOCKET:4154,CAP_AUTOMATICSENSEMEDIUM:4155,CAP_CUSTOMINTERFACEGUID:4156,ICAP_AUTOBRIGHT:4352,ICAP_BRIGHTNESS:4353,ICAP_CONTRAST:4355,ICAP_CUSTHALFTONE:4356,ICAP_EXPOSURETIME:4357,ICAP_FILTER:4358,ICAP_FLASHUSED:4359,ICAP_GAMMA:4360,ICAP_HALFTONES:4361,ICAP_HIGHLIGHT:4362,ICAP_IMAGEFILEFORMAT:4364,ICAP_LAMPSTATE:4365,ICAP_LIGHTSOURCE:4366,ICAP_ORIENTATION:4368,ICAP_PHYSICALWIDTH:4369,ICAP_PHYSICALHEIGHT:4370,ICAP_SHADOW:4371,ICAP_FRAMES:4372,ICAP_XNATIVERESOLUTION:4374,ICAP_YNATIVERESOLUTION:4375,ICAP_XRESOLUTION:4376,ICAP_YRESOLUTION:4377,ICAP_MAXFRAMES:4378,ICAP_TILES:4379,ICAP_BITORDER:4380,ICAP_CCITTKFACTOR:4381,ICAP_LIGHTPATH:4382,ICAP_PIXELFLAVOR:4383,ICAP_PLANARCHUNKY:4384,ICAP_ROTATION:4385,ICAP_SUPPORTEDSIZES:4386,ICAP_THRESHOLD:4387,ICAP_XSCALING:4388,ICAP_YSCALING:4389,ICAP_BITORDERCODES:4390,ICAP_PIXELFLAVORCODES:4391,ICAP_JPEGPIXELTYPE:4392,ICAP_TIMEFILL:4394,ICAP_BITDEPTH:4395,ICAP_BITDEPTHREDUCTION:4396,ICAP_UNDEFINEDIMAGESIZE:4397,ICAP_EXTIMAGEINFO:4399,ICAP_MINIMUMHEIGHT:4400,ICAP_MINIMUMWIDTH:4401,ICAP_AUTODISCARDBLANKPAGES:4404,ICAP_FLIPROTATION:4406,ICAP_BARCODEDETECTIONENABLED:4407,ICAP_SUPPORTEDBARCODETYPES:4408,ICAP_BARCODEMAXSEARCHPRIORITIES:4409,ICAP_BARCODESEARCHPRIORITIES:4410,ICAP_BARCODESEARCHMODE:4411,ICAP_BARCODEMAXRETRIES:4412,ICAP_BARCODETIMEOUT:4413,ICAP_ZOOMFACTOR:4414,ICAP_PATCHCODEDETECTIONENABLED:4415,ICAP_SUPPORTEDPATCHCODETYPES:4416,ICAP_PATCHCODEMAXSEARCHPRIORITIES:4417,ICAP_PATCHCODESEARCHPRIORITIES:4418,ICAP_PATCHCODESEARCHMODE:4419,ICAP_PATCHCODEMAXRETRIES:4420,ICAP_PATCHCODETIMEOUT:4421,ICAP_FLASHUSED2:4422,ICAP_IMAGEFILTER:4423,ICAP_NOISEFILTER:4424,ICAP_OVERSCAN:4425,ICAP_AUTOMATICBORDERDETECTION:4432,ICAP_AUTOMATICDESKEW:4433,ICAP_AUTOMATICROTATE:4434,ICAP_JPEGQUALITY:4435,ICAP_FEEDERTYPE:4436,ICAP_ICCPROFILE:4437,ICAP_AUTOSIZE:4438,ICAP_AUTOMATICCROPUSESFRAME:4439,ICAP_AUTOMATICLENGTHDETECTION:4440,ICAP_AUTOMATICCOLORENABLED:4441,ICAP_AUTOMATICCOLORNONCOLORPIXELTYPE:4442,ICAP_COLORMANAGEMENTENABLED:4443,ICAP_IMAGEMERGE:4444,ICAP_IMAGEMERGEHEIGHTTHRESHOLD:4445,ICAP_SUPPORTEDEXTIMAGEINFO:4446};var EnumDWT_CapType={TWON_NONE:0,TWON_ARRAY:3,TWON_ENUMERATION:4,TWON_ONEVALUE:5,TWON_RANGE:6};var EnumDWT_TransferMode={TWSX_NATIVE:0,TWSX_FILE:1,TWSX_MEMORY:2};var EnumDWT_FileFormat={TWFF_TIFF:0,TWFF_PICT:1,TWFF_BMP:2,TWFF_XBM:3,TWFF_JFIF:4,TWFF_FPX:5,TWFF_TIFFMULTI:6,TWFF_PNG:7,TWFF_SPIFF:8,TWFF_EXIF:9,TWFF_PDF:10,TWFF_JP2:11,TWFF_JPN:12,TWFF_JPX:13,TWFF_DEJAVU:14,TWFF_PDFA:15,TWFF_PDFA2:16};var EnumDWT_TIFFCompressionType={TIFF_AUTO:0,TIFF_NONE:1,TIFF_RLE:2,TIFF_FAX3:3,TIFF_T4:3,TIFF_FAX4:4,TIFF_T6:4,TIFF_LZW:5,TIFF_JPEG:7,TIFF_PACKBITS:32773};var EnumDWT_InterpolationMethod={IM_NEARESTNEIGHBOUR:1,IM_BILINEAR:2,IM_BICUBIC:3,IM_BESTQUALITY:5};var EnumDWT_ImageType={IT_BMP:0,IT_JPG:1,IT_TIF:2,IT_PNG:3,IT_PDF:4,IT_ALL:5};var EnumDWT_PDFCompressionType={PDF_AUTO:0,PDF_FAX3:1,PDF_FAX4:2,PDF_LZW:3,PDF_RLE:4,PDF_JPEG:5};var EnumDWT_ShowMode={SW_ACTIVE:0,SW_MAX:1,SW_MIN:2,SW_CLOSE:3,SW_IFLIVE:4};var EnumDWT_CapValueType={TWTY_INT8:0,TWTY_INT16:1,TWTY_INT32:2,TWTY_UINT8:3,TWTY_UINT16:4,TWTY_int:5,TWTY_BOOL:6,TWTY_FIX32:7,TWTY_FRAME:8,TWTY_STR32:9,TWTY_STR64:10,TWTY_STR128:11,TWTY_STR255:12};var EnumDWT_UnitType={TWUN_INCHES:0,TWUN_CENTIMETERS:1,TWUN_PICAS:2,TWUN_POINTS:3,TWUN_TWIPS:4,TWUN_PIXELS:5,TWUN_MILLIMETERS:6};var EnumDWT_DUPLEX={TWDX_NONE:0,TWDX_1PASSDUPLEX:1,TWDX_2PASSDUPLEX:2};var EnumDWT_CapLanguage={TWLG_DAN:0,TWLG_DUT:1,TWLG_ENG:2,TWLG_FCF:3,TWLG_FIN:4,TWLG_FRN:5,TWLG_GER:6,TWLG_ICE:7,TWLG_ITN:8,TWLG_NOR:9,TWLG_POR:10,TWLG_SPA:11,TWLG_SWE:12,TWLG_USA:13,TWLG_USERLOCALE:-1,TWLG_AFRIKAANS:14,TWLG_ALBANIA:15,TWLG_ARABIC:16,TWLG_ARABIC_ALGERIA:17,TWLG_ARABIC_BAHRAIN:18,TWLG_ARABIC_EGYPT:19,TWLG_ARABIC_IRAQ:20,TWLG_ARABIC_JORDAN:21,TWLG_ARABIC_KUWAIT:22,TWLG_ARABIC_LEBANON:23,TWLG_ARABIC_LIBYA:24,TWLG_ARABIC_MOROCCO:25,TWLG_ARABIC_OMAN:26,TWLG_ARABIC_QATAR:27,TWLG_ARABIC_SAUDIARABIA:28,TWLG_ARABIC_SYRIA:29,TWLG_ARABIC_TUNISIA:30,TWLG_ARABIC_UAE:31,TWLG_ARABIC_YEMEN:32,TWLG_BASQUE:33,TWLG_BYELORUSSIAN:34,TWLG_BULGARIAN:35,TWLG_CATALAN:36,TWLG_CHINESE:37,TWLG_CHINESE_HONGKONG:38,TWLG_CHINESE_PRC:39,TWLG_CHINESE_SINGAPORE:40,TWLG_CHINESE_SIMPLIFIED:41,TWLG_CHINESE_TAIWAN:42,TWLG_CHINESE_TRADITIONAL:43,TWLG_CROATIA:44,TWLG_CZECH:45,TWLG_DANISH:0,TWLG_DUTCH:1,TWLG_DUTCH_BELGIAN:46,TWLG_ENGLISH:2,TWLG_ENGLISH_AUSTRALIAN:47,TWLG_ENGLISH_CANADIAN:48,TWLG_ENGLISH_IRELAND:49,TWLG_ENGLISH_NEWZEALAND:50,TWLG_ENGLISH_SOUTHAFRICA:51,TWLG_ENGLISH_UK:52,TWLG_ENGLISH_USA:13,TWLG_ESTONIAN:53,TWLG_FAEROESE:54,TWLG_FARSI:55,TWLG_FINNISH:4,TWLG_FRENCH:5,TWLG_FRENCH_BELGIAN:56,TWLG_FRENCH_CANADIAN:3,TWLG_FRENCH_LUXEMBOURG:57,TWLG_FRENCH_SWISS:58,TWLG_GERMAN:6,TWLG_GERMAN_AUSTRIAN:59,TWLG_GERMAN_LUXEMBOURG:60,TWLG_GERMAN_LIECHTENSTEIN:61,TWLG_GERMAN_SWISS:62,TWLG_GREEK:63,TWLG_HEBREW:64,TWLG_HUNGARIAN:65,TWLG_ICELANDIC:7,TWLG_INDONESIAN:66,TWLG_ITALIAN:8,TWLG_ITALIAN_SWISS:67,TWLG_JAPANESE:68,TWLG_KOREAN:69,TWLG_KOREAN_JOHAB:70,TWLG_LATVIAN:71,TWLG_LITHUANIAN:72,TWLG_NORWEGIAN:9,TWLG_NORWEGIAN_BOKMAL:73,TWLG_NORWEGIAN_NYNORSK:74,TWLG_POLISH:75,TWLG_PORTUGUESE:10,TWLG_PORTUGUESE_BRAZIL:76,TWLG_ROMANIAN:77,TWLG_RUSSIAN:78,TWLG_SERBIAN_LATIN:79,TWLG_SLOVAK:80,TWLG_SLOVENIAN:81,TWLG_SPANISH:11,TWLG_SPANISH_MEXICAN:82,TWLG_SPANISH_MODERN:83,TWLG_SWEDISH:12,TWLG_THAI:84,TWLG_TURKISH:85,TWLG_UKRANIAN:86,TWLG_ASSAMESE:87,TWLG_BENGALI:88,TWLG_BIHARI:89,TWLG_BODO:90,TWLG_DOGRI:91,TWLG_GUJARATI:92,TWLG_HARYANVI:93,TWLG_HINDI:94,TWLG_KANNADA:95,TWLG_KASHMIRI:96,TWLG_MALAYALAM:97,TWLG_MARATHI:98,TWLG_MARWARI:99,TWLG_MEGHALAYAN:100,TWLG_MIZO:101,TWLG_NAGA:102,TWLG_ORISSI:103,TWLG_PUNJABI:104,TWLG_PUSHTU:105,TWLG_SERBIAN_CYRILLIC:106,TWLG_SIKKIMI:107,TWLG_SWEDISH_FINLAND:108,TWLG_TAMIL:109,TWLG_TELUGU:110,TWLG_TRIPURI:111,TWLG_URDU:112,TWLG_VIETNAMESE:113};var EnumDWT_CapSupportedSizes={TWSS_NONE:0,TWSS_A4LETTER:1,TWSS_B5LETTER:2,TWSS_USLETTER:3,TWSS_USLEGAL:4,TWSS_A5:5,TWSS_B4:6,TWSS_B6:7,TWSS_USLEDGER:9,TWSS_USEXECUTIVE:10,TWSS_A3:11,TWSS_B3:12,TWSS_A6:13,TWSS_C4:14,TWSS_C5:15,TWSS_C6:16,TWSS_4A0:17,TWSS_2A0:18,TWSS_A0:19,TWSS_A1:20,TWSS_A2:21,TWSS_A4:1,TWSS_A7:22,TWSS_A8:23,TWSS_A9:24,TWSS_A10:25,TWSS_ISOB0:26,TWSS_ISOB1:27,TWSS_ISOB2:28,TWSS_ISOB3:12,TWSS_ISOB4:6,TWSS_ISOB5:29,TWSS_ISOB6:7,TWSS_ISOB7:30,TWSS_ISOB8:31,TWSS_ISOB9:32,TWSS_ISOB10:33,TWSS_JISB0:34,TWSS_JISB1:35,TWSS_JISB2:36,TWSS_JISB3:37,TWSS_JISB4:38,TWSS_JISB5:2,TWSS_JISB6:39,TWSS_JISB7:40,TWSS_JISB8:41,TWSS_JISB9:42,TWSS_JISB10:43,TWSS_C0:44,TWSS_C1:45,TWSS_C2:46,TWSS_C3:47,TWSS_C7:48,TWSS_C8:49,TWSS_C9:50,TWSS_C10:51,TWSS_USSTATEMENT:52,TWSS_BUSINESSCARD:53,TWSS_MAXSIZE:54};var EnumDWT_CapFeederAlignment={TWFA_NONE:0,TWFA_LEFT:1,TWFA_CENTER:2,TWFA_RIGHT:3};var EnumDWT_CapFeederOrder={TWFO_FIRSTPAGEFIRST:0,TWFO_LASTPAGEFIRST:1};var EnumDWT_CapPrinter={TWPR_IMPRINTERTOPBEFORE:0,TWPR_IMPRINTERTOPAFTER:1,TWPR_IMPRINTERBOTTOMBEFORE:2,TWPR_IMPRINTERBOTTOMAFTER:3,TWPR_ENDORSERTOPBEFORE:4,TWPR_ENDORSERTOPAFTER:5,TWPR_ENDORSERBOTTOMBEFORE:6,TWPR_ENDORSERBOTTOMAFTER:7};var EnumDWT_CapPrinterMode={TWPM_SINGLESTRING:0,TWPM_MULTISTRING:1,TWPM_COMPOUNDSTRING:2};var EnumDWT_CapBitdepthReduction={TWBR_THRESHOLD:0,TWBR_HALFTONE:1,TWBR_CUSTHALFTONE:2,TWBR_DIFFUSION:3};var EnumDWT_CapBitOrder={TWBO_LSBFIRST:0,TWBO_MSBFIRST:1};var EnumDWT_CapFilterType={TWFT_RED:0,TWFT_GREEN:1,TWFT_BLUE:2,TWFT_NONE:3,TWFT_WHITE:4,TWFT_CYAN:5,TWFT_MAGENTA:6,TWFT_YELLOW:7,TWFT_BLACK:8};var EnumDWT_CapFlash={TWFL_NONE:0,TWFL_OFF:1,TWFL_ON:2,TWFL_AUTO:3,TWFL_REDEYE:4};var EnumDWT_CapFlipRotation={TWFR_BOOK:0,TWFR_FANFOLD:1};var EnumDWT_CapImageFilter={TWIF_NONE:0,TWIF_AUTO:1,TWIF_LOWPASS:2,TWIF_BANDPASS:3,TWIF_HIGHPASS:4,TWIF_TEXT:3,TWIF_FINELINE:4};var EnumDWT_CapLightPath={TWLP_REFLECTIVE:0,TWLP_TRANSMISSIVE:1};var EnumDWT_CapLightSource={TWLS_RED:0,TWLS_GREEN:1,TWLS_BLUE:2,TWLS_NONE:3,TWLS_WHITE:4,TWLS_UV:5,TWLS_IR:6};var EnumDWT_MagType={TWMD_MICR:0,TWMD_RAW:1,TWMD_INVALID:2};var EnumDWT_CapNoiseFilter={TWNF_NONE:0,TWNF_AUTO:1,TWNF_LONEPIXEL:2,TWNF_MAJORITYRULE:3};var EnumDWT_CapORientation={TWOR_ROT0:0,TWOR_ROT90:1,TWOR_ROT180:2,TWOR_ROT270:3,TWOR_PORTRAIT:0,TWOR_LANDSCAPE:3,TWOR_AUTO:4,TWOR_AUTOTEXT:5,TWOR_AUTOPICTURE:6};var EnumDWT_CapOverscan={TWOV_NONE:0,TWOV_AUTO:1,TWOV_TOPBOTTOM:2,TWOV_LEFTRIGHT:3,TWOV_ALL:4};var EnumDWT_CapPixelFlavor={TWPF_CHOCOLATE:0,TWPF_VANILLA:1};var EnumDWT_CapPlanarChunky={TWPC_CHUNKY:0,TWPC_PLANAR:1};var EnumDWT_DataSourceStatus={TWDSS_CLOSED:0,TWDSS_OPENED:1,TWDSS_ENABLED:2,TWDSS_ACQUIRING:3};var EnumDWT_FitWindowType={enumFitWindow:0,enumFitWindowHeight:1,enumFitWindowWidth:2};var EnumDWT_PlatformType={enumWindow:0,enumMac:1,enumLinux:2};var EnumDWT_UploadDataFormat={Binary:0,Base64:1};var EnumDWT_MouseShape={Default:0,Hand:1,Crosshair:2,Zoom:3,NWResize:4,EResize:5,NResize:6,Resize:7,Move:8};var EnumDWT_Language={English:0,French:1,Arabic:2,Spanish:3,Portuguese:4,German:5,Italian:6,Russian:7,Chinese:8};var EnumDWT_InitMsg={Info:1,Error:2,NotInstalledError:3,DownloadError:4,DownloadNotRestartError:5};var EnumDWT_Error={ModuleNotExists:-2371};(function(){Dynamsoft.Lib.Errors={Server_Restarted:function(a){a._errorCode=-2208;a._errorString="The connection with the local Dynamsoft Service encountered a problem and has been reset."},HTML5NotSupport:function(a){a._errorCode=-2209;a._errorString="The HTML5 edition does not support this method or property."},HttpServerCannotEmpty:function(a){a._errorCode=-2300;a._errorString="Http upload error: the HTTP Server name/ip cannot be empty."},NetworkError:function(a){a._errorCode=-2301;a._errorString="Network error."},InvalidResultFormat:function(a){a._errorCode=-2302;a._errorString="The result format is invalid."},UploadError:function(d,c,b,a){if(c){d._errorCode=-2303;d._errorString="Upload cancelled."}else{d._errorCode=-2003;if(a&&a>0){d._errorString="HTTP process error: "+a+"."}else{d._errorString="HTTP process error."}if(b){d._errorString+=" "+b}}},HttpDownloadUrlError:function(a){a._errorCode=-2304;a._errorString="Http download error: the url is invalid."},HttpDownloadError:function(d,c,b,a){if(c){d._errorCode=-2305;d._errorString="User cancelled the operation."}else{d._errorCode=-2003;if(a&&a>0){d._errorString="HTTP process error: "+a+"."}else{d._errorString="HTTP process error."}if(b){d._errorString+=" "+b}}},UploadFileCannotEmpty:function(a){a._errorCode=-2306;a._errorString="Upload Error: the upload file cannot be empty."},InvalidWidthOrHeight:function(a){a._errorCode=-2307;a._errorString="The width or height you entered is invalid."},Server_Invalid:function(a){if(a._errorCode==0){a._errorCode=-2308;a._errorString="The local Dynamsoft Service has been stopped."}},InvalidLocalFilename:function(b,a){b._errorCode=-2309;b._errorString="The LocalFile is empty in the name "+a+" Function."},BarCode_InvalidIndex:function(b,a){b._errorCode=-2310;b._errorString="The index is out of range."},BarCode_InvalidRemoteFilename:function(a){a._errorCode=-2311;a._errorString="The RemoteFile field is empty in the Barcode Download Function."},ImageFileLengthCannotZero:function(a){a._errorCode=-2312;a._errorString="The file length is empty."},UploadExceededMaxSize:function(a){a._errorCode=-2313;a._errorString="The size of the images you are about to upload has exceeded the limit."},ParameterCannotEmpty:function(a){a._errorCode=-2314;a._errorString="The parameter cannot be empty."},Webcam_InvalidIndex:function(b,a){b._errorCode=-2315;b._errorString="The index is out of range."},Webcam_InvalidRemoteFilename:function(a){a._errorCode=-2316;a._errorString="The RemoteFile field is empty in the Webcam Download Function."},OCR_InvalidIndex:function(b,a){b._errorCode=-2321;b._errorString="The index is out of range."},OCR_InvalidLeftOrTopOrRightOrBottom:function(a){a._errorCode=-2322;a._errorString="The left or top or right or bottom you entered is invalid."},OCR_InvalidOutputFormat:function(a){a._errorCode=-2323;a._errorString="The OCR output format is not supported."},OCR_InvalidPageSetMode:function(a){a._errorCode=-2324;a._errorString="The OCR page set mode is not supported."},InvalidIndex:function(a){a._errorCode=-1033;a._errorString="Invalid index."},Pdf_InvalidRemoteFilename:function(a){a._errorCode=-2317;a._errorString="The RemoteFile field is empty in the Pdf Download Function."},InvalidDestination:function(a){a._errorCode=-2318;a._errorString="Invalid destination file."},InvalidSourceFile:function(a){a._errorCode=-2319;a._errorString="Invalid source file."},InvalidFile:function(a){a._errorCode=-2320;a._errorString="Invalid file."},hasLicenseError:function(a){return(a._errorCode>=-2348&&a._errorCode<=-2325)},LicenseEmptyOrInvalid:function(a){a._errorCode=-2325;a._errorString="The current product key is empty or invalid, please contact the site administrator."},LicenseExpired:function(b,a){b._errorCode=-2326;var c="";if(a&&a!=""){c=" on "+a}b._errorString="The current product key has expired on "+c+", please contact the site administrator."},LicenseNoChrome:function(a){a._errorCode=-2327;a._errorString="The current product key does not support Chrome, please contact the site administrator."},LicenseNoFirefox:function(a){a._errorCode=-2328;a._errorString="The current product key does not support Firefox, please contact the site administrator."},LicenseNoIE:function(a){a._errorCode=-2329;a._errorString="The current product key does not support IE, please contact the site administrator."},LicenseNoEdge:function(a){a._errorCode=-2330;a._errorString="The current product key does not support Edge, please contact the site administrator."},LicenseTrialButServiceFull:function(a){a._errorCode=-2331;a._errorString="The current product key is a trial version key but聽Dynamsoft.WebTwainEnv.Trial is set to false, please change it to true."},LicenseFullButServiceTrial:function(a){a._errorCode=-2332;a._errorString="The current product key is a full version key but聽Dynamsoft.WebTwainEnv.Trial is set to true, please change it to false."},LicenseNoCore:function(a){a._errorCode=-2333;a._errorString="The current product key is missing the core license, please contact the site administrator."},LicenseNo1D:function(a){a._errorCode=-2334;a._errorString="The current product key does not include a license for reading 1D barcode, please contact the site administrator."},LicenseNo2DQR:function(a){a._errorCode=-2335;a._errorString="The current product key does not include a license for reading QRcode barcode, please contact the site administrator."},LicenseNo2DPDF417:function(a){a._errorCode=-2336;a._errorString="The current product key does not include a license for reading PDF417 barcode, please contact the site administrator."},LicenseNo2DDataMatrix:function(a){a._errorCode=-2337;a._errorString="The current product key does not include a license for reading DataMatrix barcode, please contact the site administrator."},LicenseNoWebcam:function(a){a._errorCode=-2338;a._errorString="The current product key does not support Webcam, please contact the site administrator."},LicenseNoPDF:function(a){a._errorCode=-2339;a._errorString="The current product key does not support pdf rasterizer, please contact the site administrator."},LicenseNoOCR:function(a){a._errorCode=-2340;a._errorString="The current product key does not support OCR, please contact the site administrator."},LicenseNoOCRPro:function(a){a._errorCode=-2341;a._errorString="The current product key does not support OCR pro, please contact the site administrator."},LicenseBadDomain:function(a){a._errorCode=-2342;a._errorString="The domain of your current site does not match the domain bound in the current product key, please contact the site administrator."},LicenseNotSupportBorwser:function(a){a._errorCode=-2343;a._errorString="The current product key does not support your browser, please contact the site administrator."},LicenseNotSupportWindows:function(a){a._errorCode=-2344;a._errorString="The current product key does not support Windows OS, please contact the site administrator."},LicenseNotSupportMAC:function(a){a._errorCode=-2345;a._errorString="The current product key does not support MAC OS, please contact the site administrator."},LicenseNotSupportLinux:function(a){a._errorCode=-2346;a._errorString="The current product key does not support Linux OS, please contact the site administrator."},LicenseNotSupportOS:function(a){a._errorCode=-2347;a._errorString="The current product key does not support your OS, please contact the site administrator."},LicenseLower:function(a){a._errorCode=-2348;a._errorString="The current product key is invalid because it's generated with the licenses of a different major version."},BarcodeLicenseEmpty:function(a){a._errorCode=-2349;a._errorString=a._errorString="The current product key does not include a license for reading barcode, please contact the site administrator."},IndicesCannotEmpty:function(a){a._errorCode=-2350;a._errorString="The indices cannot be empty."},UploadIndexMoreThanOne:function(a){a._errorCode=-2351;a._errorString="You cannot upload more than one image when the format is BMP, JPG or PNG"},IndicesOutOfRange:function(a){a._errorCode=-2352;a._errorString="The indices are out of range."},HttpHeaderNotAllowed:function(a){a._errorCode=-2353;a._errorString="The header name being used is a protected keyword and is not allowed."},HttpHeaderIsEmpty:function(a){a._errorCode=-2354;a._errorString="The header name cannot be empty."},HttpHeaderIsNull:function(a){a._errorCode=-2355;a._errorString="The header name cannot be null."},HttpHeaderIsUndefined:function(a){a._errorCode=-2356;a._errorString="The header name cannot be undefined."},HttpHeaderIsInvalid:function(a){a._errorCode=-2357;a._errorString="The header name you entered is invalid."},IndicesNotArray:function(a){a._errorCode=-2358;a._errorString="The type of the parameter indices must be an Array."},IndexOutOfRange:function(a){a._errorCode=-2359;a._errorString="The index is out of range."},IndexNullOrUndefined:function(a){a._errorCode=-2360;a._errorString="The index is null or undefined."},ConvertBase64IndexMoreThanOne:function(a){a._errorCode=-2361;a._errorString="You cannot convert more than one image to base64 string when the format is BMP, JPG or PNG."},InvalidImageType:function(a){a._errorCode=-2362;a._errorString="The image type is not supported."},InvalidDataFormat:function(a){a._errorCode=-2363;a._errorString="The data format is not supported."},InvalidUploadInSegments:function(a){a._errorCode=-2364;a._errorString="Please use a Boolean value for the parameter bUploadInSegments."},InvalidUrl:function(a){a._errorCode=-2365;a._errorString="The url is invalid."},ConvertBase64Failed:function(a){a._errorCode=-2366;a._errorString="Converting images to a base64 string failed."},InvalidSegmentUploadThreshold:function(a){a._errorCode=-2367;a._errorString="Invalid value for the parameter segmentUploadThreshold."},InvalidModuleSize:function(a){a._errorCode=-2368;a._errorString="Invalid value for the parameter moduleSize."},MustUpgradeService:function(a){a._errorCode=-2207;a._errorString="The Dynamsoft Service installed on your computer is outdated and no longer works with the JavaScript code on the website."},WebTwainModuleDownloadFailure:function(a){a._errorCode=-2369;a._errorString="The module for Dynamic Web TWAIN has failed to download."},LicenseIsFuture:function(b,a){b._errorCode=-2370;b._errorString="The current product key is invalid, please contact the site administrator."},WebTwainModuleNotExist:function(a){a._errorCode=EnumDWT_Error.ModuleNotExists;a._errorString="Dynamic Web TWAIN scanner module is not installed and it is also missing on the server, please contact the site administrator."},ConvertBinaryIndexMoreThanOne:function(a){a._errorCode=-2372;a._errorString="You cannot convert more than one image to binary when the format is BMP, JPG or PNG."},Overlay_InvalidLeftOrTopOrRightOrBottom:function(a){a._errorCode=-2375;a._errorString="The left or top or right or bottom you entered is invalid."},__last:false}})();(function(a){if(!a.product.bChromeEdition){return}a.LS=(function(){var b=false,c;if(a.env.bEdge&&a.env.bFileSystem){}else{try{b=(window.localStorage)?true:false}catch(d){}}c={isSupportLS:function(){return b},item:function(e,f){var g=null;if(this.isSupportLS()){if(f){localStorage.setItem(e,f);g=f}else{g=localStorage.getItem(e)}if(g===null){return false}return g}else{return false}},removeItem:function(e){if(this.isSupportLS()){localStorage.removeItem(e)}else{return false}return true}};return c})()})(Dynamsoft.Lib);(function(a){a.html5=a.html5||{};if(!a.product.bChromeEdition){return}var g=1,j,f=!1,d=!0,h=Dynamsoft.WebTwainEnv,e=!1,c={ActiveX:0,Plugin:1,HTML5:2,WinMacLinux:3,Barcode1D:4,Barcode2D:5,BarcodeWriter:6,OCR:7,Webcam:8,PDFRasterizer:9,OCRPro:10,QR:50,PDF417:51,DataMatrix:52},b={WinMacLinux:1,Barcode1D:2,Barcode2D:3,OCR:4,Webcam:6,PDFRasterizer:9};j=a.html5.Funs={notSupportProperty:function(k){},notSupportMethod:function(k){},getRandom:function(){var l=new Date().getTime()%10000,k=[],n;for(var m=0;m<5;m++){n=Math.floor(Math.random()*10);if(m==0&&n==0){m=-1;continue}k.push(n)}if(l<10){k.push("000")}else{if(l<100){k.push("00")}else{if(l<1000){k.push("0")}}}k.push(l);return k.join("")},generateCmdId:function(){g++;return g},sendData:function(l,w,q,u){var v,p,m,n,k,t,o,r;if(!u){try{l.send(w)}catch(s){a.log(s)}return f}n=new ArrayBuffer(12);p=q&&q.size?q.size:0;r=new Blob([w]);v=r.size;m=v+p;k=new DataView(n);for(o=0;o<8;o++){if(m){k.setUint8(o,m%256);m=parseInt(m/256)}else{break}}for(o=0;o<4;o++){if(v){k.setUint8(8+o,v%256);v=parseInt(v/256)}else{break}}t=new Blob([n,r]);l.send(t);if(p>0){l.send(q)}n=null;r=null;t=null;return d},init:function(o,z){var l,m=false,v,k,s,r=false,u,y,n;y=[];y.push('<dialog class="dynamsoft-dwt-dialogProgress" closed="closed" style="top:30%"><h3 class="dynamsoft-finalMessage"></h3><p class="dynamsoft-status">0%</p>');if(a.env.bIE){y.push('<div class="dynamsoft-progressBar" value="" max="100"></div>')}else{y.push('<progress class="dynamsoft-progressBar" value="" max="100"></progress>')}y.push('<br /><button class="dynamsoft-btnCancel" value="cancel" autofcus >cancel</button></dialog>');n='<div class="dynamsoft-dwt-container-box"></div>';if(!o._bNoUI){m=a.one("#"+z);m.html("");m.attr("class",o.containerClass);m.append(n);r=m.one(".dynamsoft-dwt-container-box")}if(r){r.style("position","relative");j.changeImageUISize(o,o._width,o._height)}if(!a.dlgProgress){s=a.one(".dynamsoft-dwt-dialogProgress");if(s){s.remove()}var q=a.parseHTML(y.join(""));if(q&&q.length>0){document.body.appendChild(q[0])}if(a.env.bIE){var w=a.one(".dynamsoft-progressBar"),x=w&&w[0];if(x){x.objProgressBar=new a.ProgressBar(x,{width:300,height:20})}}s=a.one(".dynamsoft-dwt-dialogProgress");if(s){a.dlgProgress=s[0];a.dialog.setup(a.dlgProgress)}a.dlgRef=0;a.dialogShowStatus=f;a.cancelFrome=0;var t=function(){var A=a.cancelFrome;a.closeProgress(0);if(a.bio){a.bio.abort();a.bio=f}else{if(A==3||A==4){o.SetCancel()}}};var p=a.one(".dynamsoft-btnCancel");if(p){a.addEventListener(p[0],"mousedown",t)}}j.initImageUI(o,r)},initImageUI:function(o,q){var l,k,m=o._width,p=o._height,n=f;l=a.one("#"+o._strDWTControlContainerID);if(a.isString(m)&&m.indexOf("%")>=0){m=a.css(l,"width")*parseInt(m)/100;n=d}else{m=parseInt(m)}if(a.isString(p)&&p.indexOf("%")>=0){p=a.css(l,"height")*parseInt(p)/100;n=d}else{p=parseInt(p)}k={Container:q,Width:m,Height:p};j.bindUIViewEvents(o,k);o._UIManager=new a.UI.ImageUIManager(o,k);if(n){j.changeImageUISize(o,o._width,o._height)}},changeImageUISize:function(o,n,p){var l,m,t=-1,w=-1,k=n,v=p,s=f,u,q;l=a.one("#"+o._strDWTControlContainerID);if(a.isString(n)&&n.indexOf("%")>=0){u=a.css(l,"width")*parseInt(n)/100;s=d}else{u=parseInt(n);k=[u+2,"px"].join("")}if(a.isString(p)&&p.indexOf("%")>=0){q=a.css(l,"height")*parseInt(p)/100;s=d}else{q=parseInt(p);v=[q+2,"px"].join("")}if(l){m=l.one(".dynamsoft-dwt-container-box");if(m){m.style("width",k);m.style("height",v)}}if(s){if(!o.__funResize){o.__funResize=function(){var x=j.__innerGetUIViewRealSize(o._strDWTControlContainerID,o._width,o._height);if(o._UIManager){return o._UIManager.ChangeSize(x.width,x.height)}return d}}a.removeEventListener(window,"resize",o.__funResize);a.addEventListener(window,"resize",o.__funResize)}else{if(o.__funResize){a.removeEventListener(window,"resize",o.__funResize);o.__funResize=f}}var r=j.__innerGetUIViewRealSize(o._strDWTControlContainerID,u,q);if(o._UIManager){return o._UIManager.ChangeSize(r.width,r.height)}return d},__innerGetUIViewRealSize:function(m,k,o){var l,n=-1,p=-1;l=a.one("#"+m);if(a.isString(k)&&k.indexOf("%")>=0){n=a.css(l,"width")*parseInt(k)/100}if(n<0&&k){n=parseInt(k)}if(a.isString(o)&&o.indexOf("%")>=0){p=a.css(l,"height")*parseInt(o)/100}if(p<0&&o){p=parseInt(o)}return{width:n,height:p}},bindUIViewEvents:function(m,k){var n=m,l;k.onSelected=function(o){var q=o.length,p;if(q>0){n.__SelectedImagesCount=q;p=o[q-1];n.__cIndex=p;l=j.__SetSelectedImages(n,n.__cIndex,o);if(l&&a.isFunction(n.__OnRefreshUI)){n.__OnRefreshUI(p)}}else{n.__SelectedImagesCount=0}};k.onRefreshUI=function(o){j.__innerRefreshFromUIView(n,o)};k.onResetCurrentIndex=function(o){if(o>=0&&n.__cIndex!=o){n._innerFun("CurrentImageIndexInBuffer",j.makeParams(o));n.__cIndex=o}};k.onMouseMove=function(q){var p=q.index;if(q){var o=q.x,r=q.y;n.__MouseX=o;n.__MouseY=r}if(a.isFunction(n.__OnMouseMove)){n.__OnMouseMove(p)}};k.onMouseClick=function(q){var p=q.index;if(q){var o=q.x,r=q.y;n.__MouseX=o;n.__MouseY=r}if(a.isFunction(n.__OnMouseClick)){n.__OnMouseClick(p)}};k.onMouseDoubleClick=function(p){var o=p.index;if(a.isFunction(n.__OnMouseDoubleClick)){n.__OnMouseDoubleClick(o)}};k.onMouseRightClick=function(q){var p=q.index;if(q){var o=q.x,r=q.y;n.__MouseX=o;n.__MouseY=r}if(a.isFunction(n.__OnMouseRightClick)){return n.__OnMouseRightClick(p)}return d};k.onImageAreaSelected=function(o){if(a.isFunction(n.__OnImageAreaSelected)){n.__OnImageAreaSelected(o.index,o.left,o.top,o.right,o.bottom)}};k.onImageAreaDeSelected=function(o){if(a.isFunction(n.__OnImageAreaDeSelected)){n.__OnImageAreaDeSelected(o)}}},__pushElement:function(l,k){if(a.isString(k)){l.push('"');l.push(k);l.push('"')}else{if(a.isArray(k)){var m=d;l.push("[");a.each(k,function(n){if(m){m=f}else{l.push(",")}j.__pushElement(l,n)});l.push("]")}else{if(k===undefined){l.push('""')}else{l.push(k)}}}},makeParams:function(){var l=arguments;if(l===undefined||l.length===0){return undefined}else{var k=[];if(l.length===1){var n=l[0];k.push("[");j.__pushElement(k,n);k.push("]")}else{if(l.length===2){var n=l[0],m=l[1];k.push("[");j.__pushElement(k,n);k.push(",");j.__pushElement(k,m);k.push("]")}else{j.__pushElement(k,Array.prototype.slice.call(l))}}return k.join("")}},getJson:function(r,l,s,k){var q=[];q.push("{");q.push('"id":"');q.push(r.clientId);q.push('"');if(k){q.push(',"cmdId":"');q.push(k);q.push('"')}q.push(',"method":"');q.push(l);q.push('"');q.push(',"module":"dwt","version":"');var o=Dynamsoft.WebTwainEnv,n=[o.Trial?"dwt_trial_":"dwt_",a.replaceAll(o.ServerVersionInfo,",","")].join("");q.push(n);q.push('"');if(s!==undefined&&s!==null){q.push(',"parameter":');q.push(s)}q.push("}");return q.join("")},refreshImageAfterInvokeFun:function(k,m,l){return(l==1)},loadHttpBlob:function(q,x,p,r,y,k,w,l){var o="loadHttpBlob",z,t,v=f;z=function(F,C,E){var B,D;if(F&&a.isArray(F)&&F.length>2){B=F[1];D=F[2]}else{B=C;D=E}if(D.state==2&&D.status==0){if(D.statusText==="abort"){var m=d;a.Errors.HttpDownloadError(q,m)}else{a.Errors.HttpDownloadUrlError(q)}}else{a.Errors.HttpDownloadError(q,f,B,D.status)}if(a.isFunction(k)){k()}};t={method:x,url:p,async:r,onSuccess:y,onError:z,headers:f,onComplete:function(){a.bio=f}};if(l){t.headers=l}if(q.HTTPUserName!=""){t.username=q.HTTPUserName;t.password=q.HTTPPassword}if(r){t.dataType="blob";if(a.isFunction(w)){t.beforeSend=function(m){m.addEventListener("progress",function(B){delete (B.totalSize);delete (B.position);w(B)},f)}}v=d}else{if(a.env.bIE){t.dataType="arraybuffer";t.onSuccess=function(E,D,C){var F,B,m;F=E||C.responseData;if(F){m=new Uint8Array(F)}q._errorCode=0;q._errorString="";y(m);m=null;q._HowManyImagesInBuffer=q._innerFun("HowManyImagesInBuffer");q.__cIndex=q._innerFun("CurrentImageIndexInBuffer");v=d}}else{t.contentType="text/plain; charset=x-user-defined";t.mimeType="text/plain; charset=x-user-defined";t.onSuccess=function(F,E,D){var G,B,m;G=D.responseText;B=G.length;m=new Uint8Array(B);for(var C=0;C<B;C++){m[C]=G.charCodeAt(C)}q._errorCode=0;q._errorString="";y(m);m=null;q._HowManyImagesInBuffer=q._innerFun("HowManyImagesInBuffer");q.__cIndex=q._innerFun("CurrentImageIndexInBuffer");v=d}}if(t.headers){a.mix(t.headers,{"X-Requested-With":f})}else{t.headers={"X-Requested-With":f}}}if(x=="post"){var s=q.httpFormFields,n;if(s){try{n=new FormData();a.each(s,function(B,m){if(B instanceof Blob){var C=B.name;n.append(m,B,C)}else{n.append(m,B)}});a.mix(t,{data:n,processData:f,contentType:f})}catch(u){}}}var A=new a.ajax(t);if(r){a.bio=A}return v},getServerImageUrlPrefix:function(n,o){var l=n.httpUrl,k=f,m=[l,"dwt/dwt_",h.Trial?"trial_":"",a.replaceAll(h.ServerVersionInfo,",",""),"/img?id=",n.clientId];return m.join("")},getServerSmallImageUrl:function(o,p,m){var l=o.httpUrl,k=f,n=[l,"dwt/dwt_",h.Trial?"trial_":"",a.replaceAll(h.ServerVersionInfo,",",""),"/img?id=",o.clientId];if(p!==undefined&&p!==null){n.push("&index=");n.push(p)}if(m){n.push("&act=");n.push(m)}else{n.push("&width=");n.push(k?"-1":o._width/2);n.push("&height=");n.push(k?"-1":o._height/2)}return n.join("")},combineUrl:function(o,l,n){var k=[],m=l;if(m===undefined||n===undefined){return f}if(!a.isString(m)){m=new String(l)}if(m.indexOf("http://")==0){m=m.replace("http://","");k.push("http://")}else{if(m.indexOf("https://")==0){m=m.replace("https://","");k.push("https://")}else{if(m.indexOf("//")==0){m=m.replace("//","")}if(o.IfSSL){k.push("https://")}else{k.push("http://")}}}k.push(m);if(m.indexOf(":")<0){if(o.HTTPPort==""){o.HTTPPort=a.detect.ssl?443:80}if((!a.detect.ssl&&o.HTTPPort!=80)||(a.detect.ssl&&o.HTTPPort!=443)){k.push(":");k.push(o.HTTPPort)}}if(n.indexOf("/")!==0){k.push("/")}k.push(n);return k.join("")},httpPostUpload:function(p,k,o,s,w,l,q,r,y){if(!o||o.size<=0){a.Errors.UploadFileCannotEmpty(p);if(a.isFunction(y)){y()}return f}var n=p.MaxUploadImageSize,u=o.size,t=o.type,m,v;if(u>n&&n!=-1){a.Errors.UploadExceededMaxSize(p);if(a.isFunction(y)){y()}return f}if(t===""||t&&t!=p.HttpContentTypeFieldValue){var x=o.slice||o.webkitSlice||o.mozSlice;m=x.call(o,0,u,p.HttpContentTypeFieldValue);m.name=o.name}else{m=o}o=null;m.remoteFilename=p.__remoteFilename;v=this.httpUploadByBIO(p,k,m,w,s,l,q,r,y);m=null;return v},httpPostUploadString:function(o,k,q,n,u,l,p,r,w){var v,m,s,t;if(q==""){a.Errors.UploadFileCannotEmpty(o);if(a.isFunction(w)){w()}return f}m=o.MaxUploadImageSize;s=q.length;if(s>m&&m!=-1){a.Errors.UploadExceededMaxSize(o);if(a.isFunction(w)){w()}return f}v=new Blob([q],{type:"text/plain"});v.name=n;t=this.httpUploadByBIO(o,k,v,u,d,l,p,r,w);v=null;return t},httpUploadByBIO:function(p,l,k,t,s,m,q,r,v){var w,o,u,n;u=p.httpFormFields;n=new FormData();a.each(u,function(y,x){if(y instanceof Blob){var z=y.name;n.append(x,y,z)}else{n.append(x,y)}});a.bio=new a.BIO({action:l,data:n,async:s});w=a.bio.get("uploadType");if(w){o=w.get("ajaxConfig");if(o&&o.headers&&m){a.mix(o.headers,m)}if(t>=0){w.set("blockSize",t)}if(p.__withCredentials){a.mix(o.xhrFields,{withCredentials:true})}}p.__HTTPPostResponseString=f;a.bio.on(a.BIO.event.SUCCESS,function(x){a.bio=f;if(x&&a.isString(x.response)){p.__HTTPPostResponseString=x.response}else{p.__HTTPPostResponseString=""}if(a.isFunction(r)){r(p.__HTTPPostResponseString)}});a.bio.on(a.BIO.event.ERROR,function(A){var y=(A&&A.canceled),B=(A&&A.timeout),x=f,z=f;a.bio=f;if(A&&a.isString(A.response)){p.__HTTPPostResponseString=A.response}else{p.__HTTPPostResponseString=""}if(!y){if(A&&A.msg){x=A.msg}if(A&&A.httpStatus){z=A.httpStatus}}a.Errors.UploadError(p,y,x,z);if(a.isFunction(v)){v(p.__HTTPPostResponseString)}});if(q){a.bio.on(a.BIO.event.PROGRESS,function(x){delete (x.totalSize);delete (x.position);var y=(x.total===0)?100:Math.round(x.loaded*100/x.total),z=[x.loaded," / ",x.total].join("");p._OnPercentDone([0,y,"","http"])});p._OnPercentDone([0,-1,"uploading...","http"])}return a.bio.upload(k)},httpPutImage:function(n,k,m,o,s,l,q){var r=d,p={method:"PUT",url:k,hasContent:d,processData:f,async:o,data:m,onSuccess:s,onError:function(){r=f;if(a.isFunction(l)){l()}},onComplete:function(){a.bio=f},beforeSend:function(t){if(a.isFunction(q)){t.upload.addEventListener("progress",function(u){delete (u.totalSize);delete (u.position);q(u)},f)}}};if(n.HTTPUserName!=""){p.username=n.HTTPUserName;p.password=n.HTTPPassword}if(!o){a.mix(p,{headers:{"X-Requested-With":f}})}a.bio=new a.ajax(p);return r},dialog:f,dialogRef:0,showMask:function(l){var k=this;a.log("showMask:"+l+"--"+k.dialogRef);if(k.dialogRef==0){a.detect.showMask()}k.dialogRef++},hideMask:function(l){var k=this;a.log("hideMask:"+l+"--"+k.dialogRef);if(k.dialogRef>1){k.dialogRef--}else{if(k.dialogRef<=1){a.detect.hideMask();k.dialog=f;k.dialogRef=0}}},setBtnCancelVisibleForProgress:function(m,l){var k=this;if((a.cancelFrome==0&&m.__IfShowProgressBar==d)||(a.cancelFrome!=0&&m.__IfShowCancelDialogWhenImageTransfer==d)){var o=a.one(".dynamsoft-btnCancel"),n=o&&o[0];if(n){if(l==f){n.style.display="none"}else{n.style.display=""}}}},EVENTS:["OnPostAllTransfers","OnPostTransfer","OnPostLoad","OnPreTransfer","OnPreAllTransfers","OnResult","OnTransferCancelled","OnTransferError","OnSourceUIClose","OnBitmapChanged","OnGetFilePath","OnPercentDone"],SEND_BACK_EVENTS:["OnPreAllTransfers","OnPreTransfer","OnPostTransfer","OnGetFilePath","OnPostLoad"],handleEvent:function(n,l){var p=this,m=l.result[0],k=n._objWS,o=f;a.each(j.EVENTS,function(s,r){if(l.event===s){var q=["_",s].join("");o=d;if(a.isFunction(n[q])){n[q](l.result,l)}return f}});if(o){a.log("handled event:"+l.event);a.each(j.SEND_BACK_EVENTS,function(r,q){if(j.isServerInvalid(n)){return f}if(l.event===r){a.log("sendback event:"+l.event);j.sendData(k,j.getJson(n,l.event,j.makeParams(m),0),f,d);return f}})}else{a.each(a.Addon_Events,function(s,r){if(l.event===s){var q=["_",s].join("");o=d;if(a.isFunction(n[q])){n[q](l.result)}return f}});if(o){a.log("handled addon event:"+l.event);a.each(a.Addon_Sendback_Events,function(r,q){if(j.isServerInvalid(n)){return f}if(l.event===r){a.log("sendback addon event:"+l.event);j.sendData(k,j.getJson(n,l.event,j.makeParams(m),0),f,d);return f}})}}return o},getImageType:function(l){if(l===undefined){return -1}var k=l.length;if(k<4){return -1}var m=l.lastIndexOf(".");if(m===-1){return -1}var n=l.slice(m).toLowerCase();if(n===".bmp"||n===".dib"){return EnumDWT_ImageType.IT_BMP}if(n===".jpg"||n===".jpe"||n===".jpeg"||n===".jfif"){return EnumDWT_ImageType.IT_JPG}if(n===".tif"||n===".tiff"){return EnumDWT_ImageType.IT_TIF}if(n===".png"){return EnumDWT_ImageType.IT_PNG}if(n===".pdf"){return EnumDWT_ImageType.IT_PDF}if(n===".gif"){return 6}return -1},addImageFileExt:function(l,k){var m;var n=l.substring(l.lastIndexOf(".")).toLowerCase();if(n==".bmp"||n==".jpg"||n==".png"||n==".tif"||n==".tiff"||n==".pdf"){return l}if(k==EnumDWT_ImageType.IT_BMP){m=[l,".bmp"].join("")}else{if(k==EnumDWT_ImageType.IT_JPG){m=[l,".jpg"].join("")}else{if(k==EnumDWT_ImageType.IT_PNG){m=[l,".png"].join("")}else{if(k==EnumDWT_ImageType.IT_TIF){m=[l,".tif"].join("")}else{if(k==EnumDWT_ImageType.IT_PDF){m=[l,".pdf"].join("")}}}}}return m},autoDiscardBlankImage:function(n,k){if(a.config.bDiscardBlankImage){var l=n.__cIndex;if(n.IsBlankImage(l)){n.RemoveImage(l)}var m=["Blank Discard (",k,"): ",n.ErrorString].join("");if(a.isFunction(n.__OnPrintMsg)){n.__OnPrintMsg(m)}}},replaceLocalFilename:function(k){var l;if(k===undefined){return""}k=new String(k);l=k.replace(/\\/g,"\\\\");if(a.env.bFileSystem){l=decodeURI(l)}return l},__innerRefreshFromUIView:function(l,m,k){var n=l;if(m>=0){if(!k){n.CurrentImageIndexInBuffer=m}n._UIManager.refreshEditor(n._UIManager.GetCurrentImageIndex(),n._UIManager.count())}if(a.isFunction(n.__OnRefreshUI)){n.__OnRefreshUI(m)}},__SetSelectedImages:function(m,l,k){m.__SelectedImagesCount=k.length;if(l===undefined){l=""}return m._innerFun("SetSelectedImages",j.makeParams(l,k.join(",")))},GetImageInfo:function(k,l){var m=k;return k._innerFun("GetImageInfo",j.makeParams(l))},isServerInvalid:function(l){var n=l,k,m;k=!n.bReady||n._objWS===null;m=n.__bMustUpgradeService;if(k){a.Errors.Server_Invalid(n)}else{if(m){a.Errors.MustUpgradeService(n)}}return k||m||n._errorCode==-2208},isHttpServerInvalid:function(l){var n=l,k,m;k=!n.bReady||n.httpUrl===null;m=n.__bMustUpgradeService;if(k){a.Errors.Server_Invalid(n)}else{if(m){a.Errors.MustUpgradeService(n)}}return k||m||n._errorCode==-2208},isExpiredOrFuture:function(l,o){if(l==""){return f}if(!o){var k=l.length;if(k>2&&l[k-2]=="/"&&l[k-1]=="0"){return f}}var n=this.parseDateFromString(l),m=(new Date()).getTime(),p=m+(60*24*3600000);if(n.getTime()<m){return d}else{if(o&&(n.getTime()>p)){return d}}return f},isOSOK:function(k){if(k==""||k=="0"){return d}k=k.toLowerCase();if(k.indexOf("windows")>-1&&(a.env.bWin||a.env.bWin64)){return d}else{if(k.indexOf("mac")>-1&&a.env.bMac){return d}else{if(k.indexOf("linux")>-1&&a.env.bLinux){return d}}}return f},isBrowserOK:function(k){if(k==""||k=="0"){return d}if(k){k=k.toLowerCase();if(k=="chrome"&&a.env.bChrome){return d}else{if(k=="ie"&&a.env.bIE){return d}else{if(k=="firefox"&&a.env.bFirefox){return d}}}}return f},isBindDomainOK:function(q){if(a.isUndefined(q)||q==null||q==""||q=="*"||q=="*.*"){return d}var t=location.hostname,k=f;if(t==""){return d}var u=t.toLowerCase().split("."),l=u.length,o=q.toLowerCase().split(";");for(var p=0;p<o.length;p++){var n=o[p];if(n=="*.*"){k=d;break}var s=n.split("."),v=s.length;if(v>0&&v-1<=l){var r=d;for(var m=v-1;m>0;m--){if(m+l-v>=0){if(u[m+l-v]!=s[m]){r=f;break}}else{if(s[m]!="*"){r=f;break}}}if(r){if(s[0]=="*"||l>=v&&u[l-v]==s[0]){k=d;break}}}}return k},parseDateFromString:function(l){var m,k=l;k=k.replace(/-/g,"/");m=Date.parse(k);if(isNaN(m)){m=0}return new Date(m)},getEnumLicenseType:function(o){var l=f,s=f,q=f,n=f,t=f,r=f,p=f,m=f,k=f;if(a.isString(o)){a.each(o.split(";"),function(v){var u=v*1;if(u==c.HTML5||u==c.WinMacLinux){l=d}else{if(u==c.Barcode1D){s=d}else{if(u==c.QR){q=d}else{if(u==c.PDF417){n=d}else{if(u==c.DataMatrix){t=d}else{if(u==c.OCR){r=d}else{if(u==c.Webcam){p=d}else{if(u==c.PDFRasterizer){m=d}else{if(u==c.OCRPro){k=d}}}}}}}}}})}return{Core:l,PDFRasterizer:m,Webcam:p,barcode1D:s,QR:q,PDF417:n,DataMatrix:t,OCR:r,OCRPro:k}},getLicenseType:function(o){var l=f,s=f,q=f,n=f,t=f,r=f,p=f,m=f,k=f;if(o&&o!=""){o=o.toLowerCase();if(o=="html5"||o=="win=(aph) or mac=(ph) or linux(h)"){l=d}else{if(o=="1d barcode reader"){s=d}else{if(o=="2d barcode reader(qrcode)"){q=d}else{if(o=="2d barcode reader(pdf417)"){n=d}else{if(o=="2d barcode reader(data matrix)"){t=d}else{if(o=="ocr"){r=d}else{if(o=="webcam"){p=d}else{if(o=="pdf rasterizer"){m=d}else{if(o=="proocr"){k=d}}}}}}}}}}return{Core:l,PDFRasterizer:m,Webcam:p,barcode1D:s,QR:q,PDF417:n,DataMatrix:t,OCR:r,OCRPro:k}},isAllowLicenseType:function(k,l){if(l.Core){return k.Core}else{if(l.PDFRasterizer){return k.PDFRasterizer}else{if(l.Webcam){return k.Webcam}else{if(l.barcode1D){return k.barcode1D}else{if(l.QR){return k.QR}else{if(l.PDF417){return k.PDF417}else{if(l.DataMatrix){return k.DataMatrix}else{if(l.OCR){return k.OCR}else{if(l.OCRPro){return k.OCRPro}}}}}}}}}return k.Core},setNoAllowedLicenseTypeError:function(l,k){if(k.Core){a.Errors.LicenseNoCore(l)}else{if(k.PDFRasterizer){a.Errors.LicenseNoPDF(l)}else{if(k.Webcam){a.Errors.LicenseNoWebcam(l)}else{if(k.barcode1D){a.Errors.LicenseNo1D(l)}else{if(k.QR){a.Errors.LicenseNo2DQR(l)}else{if(k.PDF417){a.Errors.LicenseNo2DPDF417(l)}else{if(k.DataMatrix){a.Errors.LicenseNo2DDataMatrix(l)}else{if(k.OCR){a.Errors.LicenseNoOCR(l)}else{if(k.OCRPro){a.Errors.LicenseNoOCRPro(l)}else{a.Errors.LicenseEmptyOrInvalid(l)}}}}}}}}}},promptLicenseErr:function(l){if(l.ErrorCode<0){var k=['<div class="dynamsoft-dwt-dlg-tips">',l.ErrorString,"</div>",'<div style="padding-top:35px"></div>'];Dynamsoft.WebTwainEnv.ShowDialog(365,0,k.join(""))}},checkPDFProductKeyWhenNeeds:function(o,p){if(o.__addon&&o.__addon.PDF){var m=1,l=2,k=4,n=o.__addon.PDF.GetConvertMode();if(p==k){if(n==m||n==l){return this.checkProductKey(o,{PDFRasterizer:d})}}}return d},checkProductKey:function(H,A,F){var p;p=H.__licenseInfo;if(Dynamsoft.WebTwainEnv.ProductKey==""||Dynamsoft.WebTwainEnv.ProductKey=="******"||!p||!a.isArray(p.Detail)||(p.Detail.length==0)){a.Errors.LicenseEmptyOrInvalid(H);this.promptLicenseErr(H);return f}var G=0,k=0,E=[],m=f,r=f,u=f,I=f,w=f,D,x=H.__bTrial;if(!this.isBindDomainOK(p.Domain)){a.Errors.LicenseBadDomain(H);this.promptLicenseErr(H);return f}for(D=0;D<p.Detail.length;D++){var y=p.Detail[D],s=d,n;n=this.getEnumLicenseType(y.EnumLicenseType);if(this.isAllowLicenseType(n,A)){if(x&&y.Trial=="TRUE"||!x&&y.Trial=="FALSE"){var z=y.ExpireDate.replace(/-/g,"/");if(!this.isExpiredOrFuture(z,x)){if(n.Core&&parseInt(y.Version)>=13||!n.Core){if(this.isBrowserOK(y.Browser)||F){if(this.isOSOK(y.OS)){G++;s=f}else{u=d}}else{I=d}}else{w=d}}else{if(x){var C=z.length;if(C>2&&z[C-2]=="/"&&z[C-1]=="0"){z="2000/10/10"}}E.push(z)}}else{if(x){r=d}else{m=d}}if(s){k++}}}if(G>0){return d}if(k==0){this.setNoAllowedLicenseTypeError(H,A);this.promptLicenseErr(H);return f}if(m){a.Errors.LicenseTrialButServiceFull(H);this.promptLicenseErr(H);return f}if(r){a.Errors.LicenseFullButServiceTrial(H);this.promptLicenseErr(H);return f}if(E.length>0){var t=0,z="",q=100000000000000000000,B="",l=(new Date()).getTime();for(D=0;D<E.length;D++){var v=this.parseDateFromString(E[D]);if(v.getTime()<l&&v.getTime()>t){t=v.getTime();z=E[D]}else{if(v.getTime()>l&&v.getTime()<q){q=v.getTime();B=E[D]}}}if(z!=""){var v=this.parseDateFromString(z);z=this.getLicenseDateString(v);a.Errors.LicenseExpired(H,z)}else{if(B!=""){var v=this.parseDateFromString(B);B=this.getLicenseDateString(v);a.Errors.LicenseIsFuture(H,B)}else{a.Errors.LicenseExpired(H,"")}}this.promptLicenseErr(H);return f}if(w){a.Errors.LicenseLower(H);this.promptLicenseErr(H);return f}if(I){if(a.env.bEdge){a.Errors.LicenseNoEdge(H)}else{if(a.env.bChrome){a.Errors.LicenseNoChrome(H)}else{if(a.env.bFirefox){a.Errors.LicenseNoFirefox(H)}else{if(a.env.bIE){a.Errors.LicenseNoIE(H)}else{a.Errors.LicenseNotSupportBorwser(H)}}}}this.promptLicenseErr(H);return f}if(u){if(a.env.bWin||a.env.bWin64){a.Errors.LicenseNotSupportWindows(H)}else{if(a.env.bMac){a.Errors.LicenseNotSupportMAC(H)}else{if(a.env.bLinux){a.Errors.LicenseNotSupportLinux(H)}else{a.Errors.LicenseNotSupportOS(H)}}}this.promptLicenseErr(H);return f}a.Errors.LicenseEmptyOrInvalid(H);this.promptLicenseErr(H);return f},getLicenseDateString:function(k){var m=k.getFullYear(),l,o,n;l=k.getMonth()+1;if(l>=10){o=""+l}else{o="0"+l}if(k.getDate()>=10){n=""+k.getDate()}else{n="0"+k.getDate()}return[o,"/",n,"/",m].join("")},getBlobTypeByImageType:function(l){var k="application/octet-stream";switch(l){case 0:k="image/bmp";break;case 1:k="image/jpeg";break;case 2:k="image/tiff";break;case 3:k="image/png";break;case 4:k="application/pdf";break}return k},callbacks:[],pushCallback:function(k,p,l){var n={method:k,callback:p,ticks:l};j.callbacks(n)},refreshUIRef:0}})(Dynamsoft.Lib);(function(a){if(!a.product.bChromeEdition){return}a.html5=a.html5||{};var b=function(c){var d=c;Object.defineProperty(d,"width",{get:function(){return this._parent._width},set:function(e){this.SetSize(e,false)}});Object.defineProperty(d,"height",{get:function(){return this._parent._height},set:function(e){this.SetSize(false,e)}})};a.html5.STwainStyle=function(d){var c=this;c._parent=d;b(c)};a.html5.STwainStyle.prototype.SetSize=function(c,d){this._parent._innerSetSize(c,d)}})(Dynamsoft.Lib);(function(a){if(!a.product.bChromeEdition){return}var c=a.html5.Funs;a.html5.STwain=function(d){var e=this,f=d||{},g=f.bNoUI;e.clientId=c.getRandom();e._width=f.width;e._height=f.height;if(g||!a.isFunction(a.UI.ImageUIView)){e._bNoUI=true}else{e._bNoUI=false}e._strDWTControlContainerID=f.containerID||("dynamsoft-dwt-container-"+e.clientId);e._customIP=false;e._ssl=a.detect.ssl;e._ip=a.product.ip;if(f.customIP){e._customIP=true;e._ip=f.ip;e._port=f.port;e._portSSL=f.portSSL}e.containerClass="dynamsoft-dwt-container dynamsoft-dwt-noPadding";c.init(e,e._strDWTControlContainerID);e.objectName=e._strDWTControlContainerID+"_obj";e.bReady=false;e.httpFormFields={};e._objWS=null;e.__wsRetry=0;e.curCommand=[];e.curCommand_SaveImagesToBytes=[];a.__innerInitEvents(e,f);e.__OnMouseClick=!g&&f.onMouseClick||"";e.__OnMouseDoubleClick=!g&&f.onMouseDoubleClick||"";e.__OnMouseRightClick=!g&&f.onMouseRightClick||"";e.__OnMouseMove=!g&&f.onMouseMove||"";e.__OnImageAreaSelected=f.onImageAreaSelected||"";e.__OnImageAreaDeSelected=f.onImageAreaDeSelected||"";e.__OnInternetTransferPercentage=f.onInternetTransferPercentage||"";e.__OnInternetTransferPercentageEx=f.onInternetTransferPercentageEx||"";e.__OnWSReady=f.onWSReady||null;e.__OnWSReconnect=f.onWSReconnect||null;e.__OnWSClose=f.onWSClose||null;e.__OnWSMessage=f.onWSMessage||null;e.__OnWSError=f.onWSError||null;e.__OnPercentDone=f.onPercentDone||"";e.__OnRefreshUI=f.onRefreshUI||"";e.__OnPrintMsg=f.onPrintMsg||"";e.__OnResult=f.onResult||"";e.HTTPPassword=f.HTTPPassword||"";e.HTTPPort=f.HTTPPort||(a.detect.ssl?443:80);e.HTTPUserName=f.HTTPUserName||"";e.__HTTPPostResponseString="";e.__strHttpContentTypeFieldValue="application/octet-stream";e.__IfShowProgressBar=true;e.__IfShowCancelDialogWhenImageTransfer=true;e.__cIndex=-1;e._HowManyImagesInBuffer=0;e._errorCode=0;e._errorString="";e.__bLoadingImage=false;e.__backgroundColor=false;e.__MouseX=0;e.__MouseY=0;e.__style=new a.html5.STwainStyle(e);e.__addon={};e.__remoteFilename="RemoteFile";e.__sourceName=[];e.__defaultSourceName="";e.__sourceCount=-1;e.__SelectedImagesCount=0;e.__serverId="";e.__fSelectionRectAspectRatio=0;e.__bConnecting=false;e.__bTrial=Dynamsoft.WebTwainEnv.Trial;e.__licenseInfo=false;e.__httpHeaderMap=false;e.__bForceClose=false;e.__strProductName="";e.__versionInfo=Dynamsoft.WebTwainEnv.JSVersion;e.__bMustUpgradeService=false;e.__withCredentials=false;e._moduleSize=1024*1024;e._segementUploadThreshold=500*1024*1024};var b=a.html5.STwain.prototype;b.getInstance=function(){return this};b._OnReady=function(h){var g=this,f,e,d=g._objWS;if(d===null){return}if(g._customIP){f={ip:g._ip,ssl:g._ssl,port:g._ssl?g._portSSL:g._port}}else{f=a.detect.urls[a.detect.cUrlIndex];f.ip=a.product.ip}e=a.getHttpUrl(f);a.detect.starting=false;a.detect.bOK=true;g.bReady=true;g.__wsRetry=0;d.onopen=null;g.httpUrl=e;d.onmessage=function(m){var k=m.data;if(typeof(k)==="object"){var u=g.curCommand_SaveImagesToBytes.shift()||{};if(u.sFun){u.sFun(k)}u=null;k=null;m.data=null;m=null;return}if(g.__OnWSMessage){g.__OnWSMessage(k)}var l=k.replace(/\0/g,"");if(l.indexOf("Exception:")>=0||l.indexOf("Error")==0){var t=k,p=false,u=g.curCommand.pop()||{};a.log(t+"@"+u.cmd);if(u.fFun){p=u.fFun(t)}if(!p&&a.isFunction(g.__OnPrintMsg)){g.__OnPrintMsg(t)}return}try{l=a.parse(l)}catch(n){a.log(k)}if(l.event){c.handleEvent(g,l);return}var u;if(l.cmdId){var s=g.curCommand.length,o,j=-1;for(o=s-1;o>=0;o--){if(g.curCommand[o].cmdId==l.cmdId){j=o;u=g.curCommand.splice(j,1)[0];break}}if(j<0){s=g.curCommand_SaveImagesToBytes.length;for(o=s-1;o>=0;o--){if(g.curCommand_SaveImagesToBytes[o].cmdId==l.cmdId){j=o;u=g.curCommand_SaveImagesToBytes.splice(j,1)[0];break}}if(j<0){return}}}else{u=g.curCommand.pop()||{}}if(l.exception!==undefined&&l.description!==undefined){g._errorCode=l.exception;g._errorString=l.description}else{g._errorCode=0;g._errorString=""}if(l.method=="ReadBarcode"||l.method=="OCRRecognize"||(l.request&&l.request.method=="OCRProRecognize")){if(u.sFun){u.sFun(l)}return}else{if(l.method=="ActiveUI"||l.method=="VersionInfo"||l.method=="SaveSelectedImagesToBase64Binary"){if(u.sFun&&l.result.length>0){u.sFun(l.result);return}}else{if(l.method=="ShowFileDialog"||l.method=="SplitTiff"||l.method=="SplitPDF"||l.method=="EncodeAsBase64"){if(u.sFun){u.sFun(l.result);return}}}}if(l.result&&l.result.length&&l.result[0]=="1"){if(u.sFun){u.sFun()}}else{if(l.exception){var p=false;if(u.fFun){p=u.fFun(g._errorString)}if(!p&&l.exception&&l.exception<0&&l.exception!=-2115){if(a.isFunction(g.__OnPrintMsg)){g.__OnPrintMsg(g._errorString)}}}else{var q=["result:"];if(u.fFun){u.fFun(c.__pushElement(q,l.result))}}}l=null};d.onclose=function(){g.bReady=false;g.__wsRetry=0;a.Errors.Server_Invalid(g);if(!g.__bForceClose&&!a.page.bUnload&&!a.detect.starting){a.detect.aryReconnectSTwains.push(g);setTimeout(a._reconnect,1000);a.detect.starting=true}if(g.__OnWSClose){g.__OnWSClose()}c.hideMask(true);a.detect.bOK=false;g.__bForceClose=false};d.onerror=function(j){g.bReady=false;g.__wsRetry=0;a.Errors.Server_Invalid(g);a.detect.bOK=false;if(!a.page.bUnload&&!a.detect.starting){a.detect.aryReconnectSTwains.push(g);setTimeout(a._reconnect,1000);a.detect.starting=true}if(j){a.log("websocket error: "+j)}if(g.__OnWSError){g.__OnWSError()}c.hideMask(true)};if(h){g._innerActiveUI(function(m){var n=g.__serverId,k,o;if(m&&m.length>=3){k=m[1];o=m[2];g.__strProductName=o}else{if(m&&m.length>=2){k=m[1]}else{a.log("ActiveUI return parameters error.")}}if(o){o=o.toLowerCase();if(o.indexOf("trial")>-1){g.__bTrial=true}else{g.__bTrial=false}}g.__serverId=k;a.closeProgress("Reconnect");if(Dynamsoft.WebTwainEnv.ProductKey!==""&&Dynamsoft.WebTwainEnv.ProductKey!=="******"){g.ProductKey=Dynamsoft.WebTwainEnv.ProductKey}if(n!=k){a.Errors.Server_Restarted(g);if(a.isFunction(g.__OnWSReconnect)){var j,l;j=(g._ssl)?g._portSSL:g._port;l=a.getWSUrl(g._ip,j,g._ssl);g.__OnWSReconnect(l,e)}}else{g._errorCode=0;g._errorString=""}});return}if(g._ip==="127.0.0.1"||g._ip==="localhost"){a.LS.item("DWT_port",f.port);a.LS.item("DWT_ssl",f.ssl?"true":"false")}a.attachProperty(g);a.attachAddon(g);g._UIManager.OnReady();g.SetViewMode(1,1);g._innerActiveUI(function(k){var j,m,l=false;if(k&&k.length>=3){j=k[1];m=k[2];g.__strProductName=m}else{if(k&&k.length>=2){j=k[1];l=true}else{l=true;a.log("ActiveUI return parameters error.")}}if(m){m=m.toLowerCase();if(m.indexOf("trial")>-1){g.__bTrial=true}else{g.__bTrial=false}}g.__serverId=j;g.__bMustUpgradeService=l;if(!l){if(Dynamsoft.WebTwainEnv.ProductKey!==""&&Dynamsoft.WebTwainEnv.ProductKey!=="******"){g.ProductKey=Dynamsoft.WebTwainEnv.ProductKey}g.LogLevel=0}if(a.isFunction(g.__OnWSReady)){g.__OnWSReady(g)}})};b.__unload=function(){var g=this,d,e=g._strDWTControlContainerID,f=document.getElementById(e);if(g._UIManager){g._UIManager.clear()}if(g.bReady){d=g._objWS;if(d){g.__bForceClose=true;d.close();g.curCommand.splice(0);delete g._objWS}g.bReady=false}if(f){f.innerHTML=""}}})(Dynamsoft.Lib);(function(c){if(!c.product.bChromeEdition){return}var e=c.html5.Funs,d=0,f=1,a=1,b=function(h,g,l,j){var k;if(l!==d&&l!==f){k=l}else{k={};if(l){k.set=j?function(m){var n=m*1;return h._innerFun(g,e.makeParams(n))}:function(m){return h._innerFun(g,e.makeParams(m))}}}if(!k.get){k.get=function(){return h._innerFun(g)}}Object.defineProperty(h,g,k)};c.DynamicLoadAddonFuns=[];c.attachAddon=function(g){c.each(c.DynamicLoadAddonFuns,function(h){if(c.isFunction(h)){h(g)}})};Dynamsoft.Lib.attachProperty=function(g){var h=g;b(h,"ErrorCode",{get:function(){return h._errorCode}});b(h,"ErrorString",{get:function(){if(h._errorCode==-2207){if(h.__bMustUpgradeService){c.Errors.MustUpgradeService(h)}}if(h._errorCode!=0){return h._errorString}return"Successful."}});b(h,"LogLevel",f,a);b(h,"Manufacturer",f);b(h,"ProductFamily",f);b(h,"ProductKey",{get:function(){return Dynamsoft.WebTwainEnv.ProductKey},set:function(j){Dynamsoft.WebTwainEnv.ProductKey=j;var k=h._innerFun("ProductKey",e.makeParams(j));h.__licenseInfo=false;h.GetLicenseInfo();return k}});b(h,"ProductName",{get:function(){return h.__strProductName},set:function(j){h.__strProductName=j;return true}});b(h,"VersionInfo",{get:function(){return h.__versionInfo}});b(h,"BitDepth",f);b(h,"Brightness",f);b(h,"Contrast",f);b(h,"CurrentSourceName",d);b(h,"DataSourceStatus",d);b(h,"DefaultSourceName",{get:function(){var j;if(h.__defaultSourceName==""||h.__sourceCount==-1){j=h.SourceCount}return h.__defaultSourceName}});b(h,"Duplex",d);b(h,"IfAppendImage",f);b(h,"IfAutoBright",f);b(h,"IfAutoDiscardBlankpages",f);b(h,"IfAutoFeed",f);b(h,"IfAutomaticBorderDetection",f);b(h,"IfAutomaticDeskew",f);b(h,"IfAutoScan",f);b(h,"IfDisableSourceAfterAcquire",f);b(h,"IfDuplexEnabled",f);b(h,"IfFeederEnabled",f);b(h,"IfFeederLoaded",d);b(h,"IfModalUI",f);b(h,"IfPaperDetectable",d);b(h,"IfScanInNewThread",f);Object.defineProperty(h,"IfShowCancelDialogWhenImageTransfer",{get:function(){return h.__IfShowCancelDialogWhenImageTransfer},set:function(j){return h.__IfShowCancelDialogWhenImageTransfer=j}});b(h,"IfShowUI",f);b(h,"IfShowIndicator",f);b(h,"IfUseTwainDSM",f);b(h,"IfUIControllable",d);b(h,"ImageBitsPerPixel",d);b(h,"ImageCaptureDriverType",f);b(h,"ImageLayoutDocumentNumber",d);b(h,"ImageLayoutFrameBottom",d);b(h,"ImageLayoutFrameLeft",d);b(h,"ImageLayoutFrameNumber",d);b(h,"ImageLayoutFrameRight",d);b(h,"ImageLayoutFrameTop",d);b(h,"ImageLayoutPageNumber",d);b(h,"ImageLength",d);b(h,"ImagePixelType",d);b(h,"ImageWidth",d);b(h,"ImageXResolution",d);b(h,"ImageYResolution",d);b(h,"MagData",d);b(h,"MagType",d);b(h,"PageSize",f,a);b(h,"PendingXfers",d);b(h,"PixelFlavor",f);b(h,"PixelType",f);b(h,"Resolution",f,a);b(h,"SourceCount",{get:function(){var k=h._innerFunRaw("GetSourceNames"),j=k.length-1;if(h._errorCode!=0){return 0}if(j<=0){h.__sourceName=[];h.__defaultSourceName="";h.__sourceCount=-1;return 0}else{if(j==1){if(k[0]==""){h.__sourceName=[];h.__defaultSourceName="";h.__sourceCount=0;return 0}}}h.__defaultSourceName=k[k.length-1];k.splice(k.length-1,1);h.__sourceName=k;h.__sourceCount=j;return j}});b(h,"TransferMode",f);b(h,"Unit",f);b(h,"XferCount",f,a);b(h,"Capability",f);b(h,"CapCurrentIndex",f);b(h,"CapCurrentValue",f);b(h,"CapDefaultIndex",d);b(h,"CapDefaultValue",d);b(h,"CapDescription",f);b(h,"CapMaxValue",f);b(h,"CapMinValue",f);b(h,"CapNumItems",f);b(h,"CapStepSize",f);b(h,"CapType",f);b(h,"CapValue",f);b(h,"CapValueString",f);b(h,"CapValueType",f);b(h,"AllowMultiSelect",{get:function(){return h._UIManager.GetAllowMultiSelect()},set:function(j){h._UIManager.SetAllowMultiSelect(j)}});b(h,"BackgroundColor",{get:function(){return h._UIManager.GetBackgroundColor()},set:function(j){return h._UIManager.SetBackgroundColor(j)}});b(h,"BackgroundFillColor",f);b(h,"BlankImageCurrentStdDev",d);b(h,"BlankImageMaxStdDev",f);b(h,"BlankImageThreshold",f);b(h,"CurrentImageIndexInBuffer",{get:function(){return h.__cIndex},set:function(j){var k=j*1;if(k>=0&&k<h._UIManager.count()){if(k!=h.__cIndex){h._innerSendCmd("CurrentImageIndexInBuffer",e.makeParams(k))}h.__cIndex=k;h._UIManager.Go(h.__cIndex);e.__innerRefreshFromUIView(h,h.__cIndex,true)}return true}});b(h,"FitWindowType",{get:function(){return h._UIManager.GetFitWindowType()},set:function(j){var k=j*1;return h._UIManager.SetFitWindowType(k)}});b(h,"HowManyImagesInBuffer",{get:function(){return h._HowManyImagesInBuffer}});b(h,"IfFitWindow",{get:function(){return h._UIManager.GetIfFitWindow()},set:function(j){if(j){return h._UIManager.SetIfFitWindow(true)}else{return h._UIManager.SetIfFitWindow(false)}}});b(h,"ImageMargin",{get:function(){return h._UIManager.GetImageMargin()},set:function(j){return h._UIManager.SetImageMargin(j)}});b(h,"MaxImagesInBuffer",f);b(h,"MouseX",{get:function(){return h.__MouseX}});b(h,"MouseY",{get:function(){return h.__MouseY}});b(h,"SelectedImagesCount",{get:function(){if(h._UIManager.count()<=0){return 0}if(h.__SelectedImagesCount==0){return 1}return h.__SelectedImagesCount},set:function(k){var l,j=k*1;if(h._UIManager.count()<=0){j=0}else{if(j<1){j=1}}h.__SelectedImagesCount=j;h._UIManager.SetSelectedImageCount(j);return h._innerFun("SelectedImagesCount",e.makeParams(j))}});b(h,"SelectionImageBorderColor",{get:function(){return h._UIManager.GetSelectionImageBorderColor()},set:function(j){return h._UIManager.SetSelectionImageBorderColor(j)}});b(h,"Zoom",{get:function(){return h._UIManager.GetZoom()},set:function(j){return h._UIManager.SetZoom(j)}});b(h,"MouseShape",{get:function(){var j=h._UIManager.GetMouseShape();return(j==EnumDWT_MouseShape.Hand)},set:function(j){var k=EnumDWT_MouseShape.Default;if(j){k=EnumDWT_MouseShape.Hand}return h._UIManager.SetMouseShape(k)}});b(h,"HTTPPostResponseString",{get:function(){if(h.__HTTPPostResponseString){return h.__HTTPPostResponseString}else{return""}}});b(h,"FTPPassword",f);b(h,"FTPPort",{get:function(){return h._innerFun("FTPPort")},set:function(j){if(j!==""){var k=j*1;return h._innerFun("FTPPort",e.makeParams(k))}}});b(h,"FTPUserName",f);b(h,"IfPASVMode",f);b(h,"IfShowProgressBar",{get:function(){return h.__IfShowProgressBar},set:function(j){return h.__IfShowProgressBar=j}});b(h,"ProxyServer",f);b(h,"IfShowFileDialog",f);b(h,"IfTiffMultiPage",f);b(h,"PDFAuthor",f);b(h,"PDFCompressionType",f);b(h,"PDFCreationDate",f);b(h,"PDFCreator",f);b(h,"PDFKeywords",f);b(h,"PDFModifiedDate",f);b(h,"PDFProducer",f);b(h,"PDFSubject",f);b(h,"PDFTitle",f);b(h,"PDFVersion",f);b(h,"TIFFCompressionType",f);b(h,"JPEGQuality",{get:function(){return h._innerFun("JPEGQuality")},set:function(j){var k=j*1;if(k>=100){k=100}return h._innerFun("JPEGQuality",e.makeParams(k))}});b(h,"HttpContentTypeFieldValue",{get:function(){return h.__strHttpContentTypeFieldValue},set:function(j){h.__strHttpContentTypeFieldValue=j;return j}});b(h,"SelectionRectAspectRatio",{get:function(){return h._UIManager.GetSelectionRectAspectRatio()},set:function(j){var k=parseFloat(j);if(k>=0){h._UIManager.SetSelectionRectAspectRatio(k);return true}return false}});b(h,"IfAllowLocalCache",f);b(h,"_AutoCropMethod",f);b(h,"BrokerProcessType",{get:function(){return 1},set:function(j){return true}});b(h,"BorderStyle",{get:function(){return 0},set:function(j){return false}});b(h,"IfSSL",f);b(h,"AllowPluginAuthentication",f);b(h,"HttpFieldNameOfUploadedImage",{get:function(){return h.__remoteFilename},set:function(j){return h.__remoteFilename=j}});b(h,"MaxInternetTransferThreads",f);b(h,"MaxUploadImageSize",f);b(h,"style",{get:function(){return h.__style}});b(h,"Addon",{get:function(){return h.__addon}});b(h,"BufferMemoryLimit",f);b(h,"Width",{get:function(){return h._width},set:function(j){var l=false;if(Dynamsoft.Lib.isString(j)){if(j.length>0){if(j.charAt(j.length-1)==="%"){l=j}}}if(!l&&j){var k=parseInt(j);if(k){l=k+"px"}}if(l){h._width=l;return e.changeImageUISize(h,l,false)}return false}});b(h,"Height",{get:function(){return h._height},set:function(j){var l=false;if(Dynamsoft.Lib.isString(j)){if(j.length>0){if(j.charAt(j.length-1)==="%"){l=j}}}if(!l&&j){var k=parseInt(j);if(k){l=k+"px"}}if(l){h._height=l;return e.changeImageUISize(h,false,l)}return false}});b(h,"ShowPageNumber",{get:function(){return h._UIManager.GetShowPageNumber()},set:function(j){return h._UIManager.SetShowPageNumber(j)}});b(h,"IfAutoScroll",{get:function(){return h._UIManager.GetIfAutoScroll()},set:function(j){return h._UIManager.SetIfAutoScroll(j)}});b(h,"HTTPRequestswithCredentials",{get:function(){return h.__withCredentials},set:function(j){return h.__withCredentials=j}});b(h,"ImageEditorIfEnableEnumerator",{get:function(){return true},set:function(j){return true}});b(h,"ImageEditorIfReadonly",{get:function(){return true},set:function(j){return true}});b(h,"ImageEditorIfModal",{get:function(){return true},set:function(j){return true}});b(h,"ImageEditorWindowTitle",{get:function(){return true},set:function(j){return true}});b(h,"EnableInteractiveZoom",{get:function(){return true},set:function(j){return true}});b(h,"IfShowPrintUI",{get:function(){return true},set:function(j){return true}});b(h,"VScrollBar",{get:function(){return true},set:function(j){return true}});b(h,"AsyncMode",{get:function(){return true},set:function(j){return true}});b(h,"IfThrowException",{get:function(){return true},set:function(j){return true}});b(h,"IfOpenImageWithGDIPlus",{get:function(){return true},set:function(j){return true}})}})(Dynamsoft.Lib);(function(a){if(!a.product.bChromeEdition){return}var c=a.html5.STwain,b=c.prototype,d=a.html5.Funs;b.__innerLoadImage=function(e,k,j,h,g,f){var l=this;if(!a.html5.Funs.checkProductKey(l,{Core:true})){if(a.isFunction(f)){f(l._errorCode,l._errorString)}return false}if(!a.html5.Funs.checkPDFProductKeyWhenNeeds(l,j)){if(a.isFunction(f)){f(l._errorCode,l._errorString)}return false}if(a.isFunction(g)){return l.__innerAcquireImage(e,k,h,g,f)}else{return l.__innerLoadImageFun(e,k)}};b.__innerLoadImageFun=function(e,g){var h=this;if(d.isServerInvalid(h)){return false}var f=h._innerFun(e,g);if(f){h._HowManyImagesInBuffer=h._innerFun("HowManyImagesInBuffer");h.__cIndex=h._innerFun("CurrentImageIndexInBuffer")}if(h.__cIndex>=0){if(f){h._UIManager.refreshEditor(h.__cIndex,h._UIManager.count())}h.OnRefreshUI(h.__cIndex)}return f};b.__innerAcquireImage=function(f,l,j,h,g){var n=this,e=(f=="LoadImage"||f=="LoadImageEx");var k=function(m){n.__bLoadingImage=false;var o=n.__cIndex;if(o>=0){n.OnRefreshUI(o)}if(a.isFunction(g)){g(n.ErrorCode,n.ErrorString)}if(e){Dynamsoft.Lib.closeProgress(f)}else{d.hideMask(f)}if(m){Dynamsoft.Lib.log(m)}return false};if(d.isServerInvalid(n)){k();return false}if(e){Dynamsoft.Lib.showProgress(n,f,false)}else{d.showMask(f)}n._innerSend(f,l,true,function(){n.__bLoadingImage=false;if(e){Dynamsoft.Lib.closeProgress(f);var m=n._UIManager.GetCurrentImageIndex();if(m>=0){n._UIManager.refreshEditor(m,n._UIManager.count());n.OnRefreshUI(m)}}else{d.hideMask(f)}if(a.isFunction(h)){h()}},k);return true};b.__innerSaveImage=function(e,g,f,h){return this.__innerProgressFunction(e,g,false,f,h)};b.__innerFTPDownloadDirectly=function(e,h,g,f,k){var j=this;if(!a.html5.Funs.checkProductKey(j,{Core:true})){if(a.isFunction(k)){k(j._errorCode,j._errorString)}return false}if(!a.html5.Funs.checkPDFProductKeyWhenNeeds(j,g)){if(a.isFunction(k)){k(j._errorCode,j._errorString)}return false}a.cancelFrome=4;return j.__innerProgressFunction(e,h,true,f,k)};b.__innerFTPDownload=function(e,k,j,h,n){var l=this,g;if(!a.html5.Funs.checkProductKey(l,{Core:true})){if(a.isFunction(n)){n(l._errorCode,l._errorString)}return false}if(!a.html5.Funs.checkPDFProductKeyWhenNeeds(l,j)){if(a.isFunction(n)){n(l._errorCode,l._errorString)}return false}a.cancelFrome=4;if(a.isFunction(n)){return l.__innerProgressFunction(e,k,true,function(){var m=l.__cIndex;if(m>=0){l.OnRefreshUI(m)}if(a.isFunction(h)){h()}},n)}else{g=l._innerFun(e,k);var f=l.__cIndex;if(f>=0){l.OnRefreshUI(f)}return g}};b.__innerFTPUpload=function(e,g,f,h){Dynamsoft.Lib.cancelFrome=3;return this.__innerProgressFunction(e,g,true,f,h)};b.__innerProgressFunction=function(e,j,f,g,l){var k=this;if(!a.isFunction(l)){return this._innerFun(e,j)}var h=function(m){if(a.isFunction(l)){l(k.ErrorCode,k.ErrorString)}Dynamsoft.Lib.closeProgress(e);if(m){Dynamsoft.Lib.log(m)}return true};Dynamsoft.Lib.showProgress(k,e,f);return this._innerSend(e,j,true,function(){Dynamsoft.Lib.closeProgress(e);if(a.isFunction(g)){g()}},h)};b.__innerGetBarcodeResultAsyncFunction=function(f){var e=Dynamsoft.Lib.NewBarcodeResult();if(f){e._errorCode=f.exception;e._errorString=f.description;e._resultlist=f.result;e._Count=f.result.length}return e};b.__innerGetOCRResultAsyncFunction=function(f){var e=Dynamsoft.Lib.NewOCRResult(this);if(f){e._errorCode=f.exception;e._errorString=f.description;e._resultlist=f.result}return e};b.__innerGetOCRProResultAsyncFunction=function(f){var e=Dynamsoft.Lib.NewOCRProResult(this);if(f){e._errorCode=f.code;e._errorString=f.message;e._request=f.request;e._errorlist=f.errorList;e._ocrTotalCount=f.ocrTotalCount;e._alreadyOCRCount=f.alreadyOCRCount;e._resultlist=f.resultDetail}return e};b._innerSendCmd=function(e,f){var g=this;if(d.isHttpServerInvalid(g)){return false}g._innerFunRaw(e,f,true,false,false)};b._innerFun=function(e,g){var h=this,f;if(d.isHttpServerInvalid(h)){return false}f=h._innerFunRaw(e,g,false,false,false);if(Dynamsoft.Lib.isArray(f)){return f[0]}return f};b._innerFunRaw=function(h,g,q,j,r,s,f){var n=this,e,t,l;if(d.isHttpServerInvalid(n)){return false}n._errorCode=0;n._errorString="";e=[n.httpUrl,"f/",h,"?",d.getRandom()].join("");t=d.getJson(n,h,g,0);var o,k=false;if(q){k=true}else{}l={method:"POST",url:e,data:t,async:k,onSuccess:function(u,p,m){var v=false;try{if(a.isString(u)&&m.getResponseHeader("content-type")==="text/json"){v=a.parse(u)}else{v=u}}catch(w){}if(v){if(v.exception!==undefined&&v.description!==undefined){n._errorCode=v.exception;n._errorString=v.description}else{n._errorCode=0;n._errorString=""}if(r){o=v}else{o=v.result}}else{Dynamsoft.Lib.Errors.InvalidResultFormat(n);o=""}if(a.isFunction(s)){s(o)}},onError:function(){Dynamsoft.Lib.Errors.NetworkError(n);o="";if(a.isFunction(f)){f()}}};if(j){if(Dynamsoft.Lib.env.bIE){l.dataType="arraybuffer";l.onSuccess=function(A,C,v){var p,x,B=false;if(v.responseHeadersString){var u=v.responseHeadersString;if(u.indexOf("text/json")!=-1){B=true}}p=v.responseData;n._errorCode=0;n._errorString="";o=false;if(p){x=new Uint8Array(p);if(B){p=String.fromCharCode.apply(null,x)}else{o=new Blob([x],{type:n.__strHttpContentTypeFieldValue})}}if(!p||B){var z,y,m=false;if(B){z=p}else{z=v.responseText}y=z.length;if(y>0){if(z.charAt(0)=="{"){try{m=a.parse(z);B=true}catch(w){Dynamsoft.Lib.log(z)}}if(B){if(m.exception!==undefined&&m.description!==undefined){n._errorCode=m.exception;n._errorString=m.description;o=false}else{o=true}}else{x=new Uint8Array(z);o=new Blob([x],{type:n.__strHttpContentTypeFieldValue})}}}}}else{if(!k){l.contentType="text/plain; charset=x-user-defined";l.mimeType="text/plain; charset=x-user-defined"}l.onSuccess=function(z,B,p){var x,u,y;x=p.responseText;u=x.length;n._errorCode=0;n._errorString="";if(u>0){var A=false,m;if(x.charAt(0)=="{"){try{m=a.parse(x);A=true}catch(v){Dynamsoft.Lib.log(x)}}if(A){if(m.exception!==undefined&&m.description!==undefined){n._errorCode=m.exception;n._errorString=m.description;o=false}else{o=true}}else{y=new Uint8Array(u);for(var w=0;w<u;w++){y[w]=x.charCodeAt(w)}o=new Blob([y],{type:n.__strHttpContentTypeFieldValue})}}else{o=""}}}}if(!k){a.mix(l,{headers:{"X-Requested-With":false}})}if(a.env.bFileSystem){l.crossDomain=false}new a.ajax(l);if(k){return true}return o};b._innerSend=function(j,f,h,l,q){var n=this,g=n._objWS,r=false,k=false,e=false;if(j!="ActiveUI"){e=d.isServerInvalid(n)}if(e){if(a.isFunction(q)){q()}return true}if(a.isFunction(l)){k=l}if(a.isFunction(q)){r=q}var s=d.generateCmdId(),o;if(j=="SaveSelectedImagesToBytes"){n.curCommand_SaveImagesToBytes.push({cmdId:s,sFun:k,fFun:r,objWS:g,json:d.getJson(n,j,f,s),binary:h});if(n.curCommand_SaveImagesToBytes.length==1){o=d.sendData(g,d.getJson(n,j,f,s),false,h)}else{o=true}}else{n.curCommand.push({cmd:j,cmdId:s,sFun:k,fFun:r});o=d.sendData(g,d.getJson(n,j,f,s),false,h)}return o};b.__SaveSelectedImagesToBytes=function(k,j,g,l,o,f){var m=this;if(l){return m.__SaveSelectedImagesToBytesByBlock(k,j,g,o,f)}else{if(j<=0&&g<=0){if(a.isFunction(f)){f()}return false}var n=false,h=true,e=m._innerFunRaw("SaveSelectedImagesToBytes",d.makeParams(k,-2,"",j,g),n,h,false);if(m.ErrorCode==0){return o(e,j)}else{if(a.isFunction(f)){f()}return false}}};b.__GetSelectedImagesLength=function(g,k,j,m,e){var h=this,l=false,n;var f=false,o=false;n=h._innerFunRaw("SaveSelectedImagesToBytes",d.makeParams(g,k,"",0,0),j,f,o,function(p){if(h.ErrorCode==0){if(a.isFunction(m)){if(a.isArray(p)){l=m(p[0])}else{l=m(p)}}return true}else{if(a.isFunction(e)){e()}return false}},e);if(j){return n}else{return l}};b.__SaveSelectedImagesToBytesByBlock=function(g,h,f,e,k){var j=this;if(h<=0&&f<=0){if(a.isFunction(k)){k()}return false}return j._innerSend("SaveSelectedImagesToBytes",d.makeParams(g,-2,"",h,f),true,function(l){if(a.isFunction(e)){e(l,h)}},k)};b.__SaveLocalFileToBytes=function(g,e,j,m){var l=this;if(e){return l._innerSend("SaveSelectedImagesToBytes",d.makeParams(0,0,g),true,j,m)}else{var k=false,h=true,f=l._innerFunRaw("SaveSelectedImagesToBytes",d.makeParams(0,0,g),k,h,false);if(l.ErrorCode==0){return j(f)}else{m();return false}}};b.__LoadImageFromBytes=function(u,l,q,n,s,h,j,v){var o=this,k="LoadImageFromBytes",y=l||3,r=u.size||u.length,g,e=d.isServerInvalid(o),x=true;if(!isNaN(j)&&j>=0&&!isNaN(v)&&v>0){g=["[",r,",",0,",",y,',"',q,'", ',j,",",v,"]"].join("")}else{g=["[",r,",",0,",",y,',"',q,'"]'].join("")}var w=function(){Dynamsoft.Lib.closeProgress(k);o.__bLoadingImage=false;if(x){var f=o.__cIndex;if(f>=0){o.OnRefreshUI(f)}}if(a.isFunction(h)){h(o._errorCode,o._errorString)}return false};if(e){x=false;return w()}if(!a.html5.Funs.checkProductKey(o,{Core:true})){x=false;return w()}if(!a.html5.Funs.checkPDFProductKeyWhenNeeds(o,l)){x=false;return w()}if(r===0){Dynamsoft.Lib.Errors.ImageFileLengthCannotZero(o);x=false;return w()}d.setBtnCancelVisibleForProgress(o,false);return this._innerSendBlob(k,g,u,n,function(){if(j+r==v||v<=0||isNaN(v)){Dynamsoft.Lib.closeProgress(k)}o.__bLoadingImage=false;var f=o._UIManager.GetCurrentImageIndex();if(n&&f>=0){o._UIManager.refreshEditor(f,o._UIManager.count());o.OnRefreshUI(f)}if(a.isFunction(s)){s()}return true},w)};b._innerSendBlob=function(h,f,s,l,k,r){var o=this,g=o._objWS,j=false,t=false;if(d.isServerInvalid(o)){if(a.isFunction(r)){r()}return false}if(a.isFunction(k)){j=k}if(a.isFunction(r)){t=r}if(l){var u=d.generateCmdId();o.curCommand.push({cmd:h,cmdId:u,sFun:j,fFun:t});d.sendData(g,d.getJson(o,h,f,u),s,true)}else{var q,e,v,n;if(d.isHttpServerInvalid(o)){return false}o._errorCode=0;o._errorString="";e=[o.httpUrl,"f/",h,"?",d.getRandom()].join("");v=d.getJson(o,h,f,0);v+="\r\n\r\n";v+=Dynamsoft.Lib.base64.encodeArray(s);n={method:"post",url:e,processData:false,data:v,async:false,onSuccess:function(w,p,m){var x=false;try{if(a.isString(w)&&m.getResponseHeader("content-type")==="text/json"){x=a.parse(w)}else{x=w}}catch(y){}if(x!==undefined&&x!==null){if(x.exception!==undefined&&x.description!==undefined){o._errorCode=x.exception;o._errorString=x.description}else{o._errorCode=0;o._errorString=""}q=x.result}else{Dynamsoft.Lib.Errors.InvalidResultFormat(o);q=""}},onError:function(){Dynamsoft.Lib.Errors.NetworkError(o);q=""}};a.mix(n,{headers:{"X-Requested-With":false}});if(a.env.bFileSystem){n.crossDomain=false}new a.ajax(n);if(o._errorCode==0){if(a.isFunction(j)){j()}}else{if(a.isFunction(t)){t()}}return q}};b._innerActiveUI=function(f,e){this._innerSend("ActiveUI",d.makeParams(Dynamsoft.Lib.env.WSVersion,Dynamsoft.Lib.env.WSSession),false,f,e)};b._innerSetSize=function(e,j){var l=this,g=false,k=false;if(l._bNoUI){return false}if(Dynamsoft.Lib.isString(e)){if(e.length>0){if(e.charAt(e.length-1)==="%"){g=e}}}if(!g&&e){var f=parseInt(e);if(f){g=f+"px"}}if(Dynamsoft.Lib.isString(j)){if(j.length>0){if(j.charAt(j.length-1)==="%"){k=j}}}if(!k&&j){var f=parseInt(j);if(f){k=f+"px"}}if(g){l._width=g}if(k){l._height=k}return d.changeImageUISize(l,g,k)}})(Dynamsoft.Lib);(function(b){if(!b.product.bChromeEdition){return}var d=b.html5.STwain,c=d.prototype,e=b.html5.Funs,a=["OnPreAllTransfers","OnPreTransfer","OnPostTransfer"];c.LoadDibFromClipboard=function(h,f){var g=-1;return this.__innerLoadImage("LoadDibFromClipboard",null,g,true,h,f)};c.LoadImage=function(h,l,g){var j=e.replaceLocalFilename(h),k=b.html5.Funs.getImageType(j);return this.__innerLoadImage("LoadImage",e.makeParams(j),k,true,l,g)};c.LoadImageEx=function(j,k,m,h){var l=e.replaceLocalFilename(j),g=k;if(g==EnumDWT_ImageType.IT_ALL){g=-1}return this.__innerLoadImage("LoadImageEx",e.makeParams(l,g),g,true,m,h)};c.EnableSource=function(g,h,f){return this.AcquireImage(g,h,f)};c.AcquireImage=function(o,n,m){var j=this,l=null,f=null,p,k;if(b.isUndefined(m)&&(b.isFunction(o)&&b.isFunction(n)||b.isFunction(o)&&b.isUndefined(n)||b.isFunction(o)&&n==null||o==null&&b.isFunction(n))){k={};if(b.isFunction(o)){l=o}if(b.isFunction(n)){f=n}}else{if(b.isUndefined(o)||o==null){k={}}else{k=o}if(b.isFunction(n)){l=n}if(b.isFunction(m)){f=m}}if(e.isServerInvalid(j)){if(b.isFunction(f)){f(j._errorCode,j._errorString)}return false}if(!b.html5.Funs.checkProductKey(j,{Core:true})){if(b.isFunction(f)){f(j._errorCode,j._errorString)}return false}var h=0;for(var g=0;g<a.length;g++){var q=["__",a[g]].join("");if(b.isFunction(j[q])){h=h|(1<<g)}}k.EnableEvents=h;p=["[",b.stringify(k),"]"].join("");return j.__innerAcquireImage("AcquireImage",p,false,l,f)};c.CancelAllPendingTransfers=function(){return this._innerFun("CancelAllPendingTransfers")};c.CloseSource=function(){return this._innerFun("CloseSource")};c.CloseSourceManager=function(){return this._innerFun("CloseSourceManager")};c.DisableSource=function(){return this._innerFun("DisableSource")};c.FeedPage=function(){return this._innerFun("FeedPage")};c.GetDeviceType=function(){return this._innerFun("GetDeviceType")};c.GetSourceNameItems=function(f){if(this.__sourceCount<0){this.SourceCount}if(f<this.__sourceCount&&f>=0){return this.__sourceName[f]}else{return""}};c.SourceNameItems=function(f){if(this.__sourceCount<0){this.SourceCount}if(f<this.__sourceCount&&f>=0){return this.__sourceName[f]}else{return""}};c.GetSourceNames=function(){var g=this,f=g._innerFunRaw("GetSourceNames");if(g._errorCode!=0){return[]}return f};c.GetSourceType=function(f){return this._innerFun("GetSourceType",e.makeParams(f))};c.OpenSource=function(){return this._innerFun("OpenSource")};c.OpenSourceManager=function(){return this._innerFun("OpenSourceManager")};c.ResetImageLayout=function(){return this._innerFun("ResetImageLayout")};c.RewindPage=function(){return this._innerFun("RewindPage")};c.SelectSource=function(){return this._innerFun("SelectSource")};c.SelectSourceByIndex=function(f){return this._innerFun("SelectSourceByIndex",e.makeParams(f))};c.SetFileXferInfo=function(g,j){var h=e.replaceLocalFilename(g);return this._innerFun("SetFileXferInfo",e.makeParams(h,j))};c.SetImageLayout=function(j,h,g,f){return this._innerFun("SetImageLayout",e.makeParams(j,h,g,f))};c.CapGet=function(){return this._innerFun("CapGet")};c.CapGetCurrent=function(){return this._innerFun("CapGetCurrent")};c.CapGetDefault=function(){return this._innerFun("CapGetDefault")};c.CapGetFrameBottom=function(f){return this._innerFun("CapGetFrameBottom",e.makeParams(f))};c.CapGetFrameLeft=function(f){return this._innerFun("CapGetFrameLeft",e.makeParams(f))};c.CapGetFrameRight=function(f){return this._innerFun("CapGetFrameRight",e.makeParams(f))};c.CapGetFrameTop=function(f){return this._innerFun("CapGetFrameTop",e.makeParams(f))};c.CapGetHelp=function(){return this._innerFun("CapGetHelp")};c.CapGetLabel=function(){return this._innerFun("CapGetLabel")};c.CapGetLabels=function(){return this._innerFun("CapGetLabels")};c.CapIfSupported=function(f){return this._innerFun("CapIfSupported",e.makeParams(f))};c.CapReset=function(){return this._innerFun("CapReset")};c.CapSet=function(){return this._innerFun("CapSet")};c.CapSetFrame=function(g,k,j,h,f){return this._innerFun("CapSetFrame",e.makeParams(g,k,j,h,f))};c.GetCapItems=function(f){return this._innerFun("GetCapItems",e.makeParams(f))};c.GetCapItemsString=function(f){return this._innerFun("GetCapItemsString",e.makeParams(f))};c.SetCapItems=function(g,f){return this._innerFun("SetCapItems",e.makeParams(g,f))};c.SetCapItemsString=function(g,f){return this._innerFun("SetCapItemsString",e.makeParams(g,f))}})(Dynamsoft.Lib);(function(a){if(!a.product.bChromeEdition){return}function c(d){var e=this;e.aryCurrentSelectedImageIndicesInBuffer=[];e.aryModelImageControl=d.aryModelImageControl;e.__bAddingImage=false;if(a.isFunction(d.onResetCurrentIndex)){e.onResetCurrentIndex=d.onResetCurrentIndex}}var b=c.prototype;b.UpdateAllImage=function(h,d,f,e){var g=this;return g.UpdateAllImageInner(h,d,false,f,e)};b.UpdateAllImageInner=function(k,d,g,f,e){var j=this;j.aryModelImageControl=k;j.__OnlySetCurrentIndex(d);j.sHowManyImages=j.aryModelImageControl.length;var h=(j.imagesPerRow*j.imagesPerColumn)>j.sHowManyImages?j.sHowManyImages:j.imagesPerRow*j.imagesPerColumn;return true};b.__GetHowManyRows=function(){var d=this;return parseInt((d.sHowManyImages+d.imagesPerColumn-1)/d.imagesPerColumn)};b.__GetRow=function(d){var e=this;return parseInt(d/e.imagesPerColumn)};b.__GetFirstVisibleColumn=function(){var d=this;return parseInt(d.__GetVisibleRow(d.__GetHScrollPosionValue()))};b.__GetFirstVisibleRow=function(){var d=this;return parseInt(d.__GetVisibleRow(d.__GetVScrollPosionValue()))};b.__GetVisibleRow=function(f){var e=this;if(e.__GetHowManyRows()==0){return 0}var d=f;if(e.bSingleMode){return e.cCurrentIndex}else{if(e.bVerticalMode==true){if(e.__GetHowManyRows()-d<e.imagesPerRow){d=d-(e.imagesPerRow-(e.__GetHowManyRows()-d))}}else{if(e.sHowManyImages-d<e.imagesPerColumn){d=d-(e.imagesPerColumn-(e.sHowManyImages-d))}}}if(d<0){d=0}return d};b.GetDataImageControlList=function(){var d=this;return d.aryModelImageControl};b.SetDataImageControl=function(d,f){var g=this;if(d>g.aryModelImageControl.length||g.aryModelImageControl.length<=0){return}var e;if(d==g.aryModelImageControl.length){e=new a.UI.ModelImageControl();e.imageIndex=d;e.rawWidth=f;g.aryModelImageControl.push(e)}else{e=g.aryModelImageControl[d];e.rawWidth=f}if(e!=null){e.bIsDirty=true}return true};b.RemoveAllImages=function(){return this.Clear()};b.Clear=function(){var e=this;var d=0;for(d=0;d<e.aryModelImageControl.length;d++){e.aryModelImageControl[d].Clear()}e.aryModelImageControl=[];e.cCurrentIndex=-1;return true};b.Go=function(d){var e=this;e.__GoInner(d,true,false);return true};b.SetCurrentIndexOnly=function(d){var e=this;return e.__GoInner(d,true,false)};b.__GoInner=function(d,e,f){var h=this,g=h.cCurrentIndex;if(d<h.aryModelImageControl.length&&d>=0){h.__OnlySetCurrentIndex(d);h.iCurrentRow=-1;h.iCurrentColumn=-1}return true};b.SetSelectedImageCount=function(d){var e=this;e.aryCurrentSelectedImageIndicesInBuffer.splice(d);e.__SetSelectedImageIndicesInBuffer();return true};b.SetSelectedImageIndex=function(h,g){var k=this;k.aryCurrentSelectedImageIndicesInBuffer[h]=g;k.__SetSelectedImageIndicesInBuffer();var e=-1,d=k.aryCurrentSelectedImageIndicesInBuffer.length,j;for(var f=0;f<d;f++){var j=k.aryCurrentSelectedImageIndicesInBuffer[f];if(e==-1){e=j}else{if(j<e){e=j}}}if(e>=0&&e<k.aryModelImageControl.length&&k.cCurrentIndex!=e){k.cCurrentIndex=e;k.__fireEvent("onResetCurrentIndex",k.cCurrentIndex)}return true};b.__SetSelectedImageIndicesInBuffer=function(){var d=this;if(d.aryCurrentSelectedImageIndicesInBuffer.length==0){if(d.cCurrentIndex>=0){d.aryCurrentSelectedImageIndicesInBuffer.push(d.cCurrentIndex)}}};b.__OnlySetCurrentIndex=function(d){var f=this,e=f.cCurrentIndex;f.cCurrentIndex=d;if(e!=d){f.__fireEvent("onResetCurrentIndex",d)}if(f.aryCurrentSelectedImageIndicesInBuffer[0]!=f.cCurrentIndex){f.aryCurrentSelectedImageIndicesInBuffer=[];f.aryCurrentSelectedImageIndicesInBuffer.push(f.cCurrentIndex)}};b.__Previous=function(){var d=this;d.Go(d.cCurrentIndex-1);return true};b.__Next=function(){var d=this;d.Go(d.cCurrentIndex+1);return true};b.__fireEvent=function(d,e){var f=this;if(a.isFunction(f[d])){return f[d](e)}return true};b.AddImage=function(g,e,l){var h=this,j=g*1,k,m,f,d;m=h.GetDataImageControlList();k=m.length;if(j<0||j>e){return false}f=j;for(;f<k;f++){d=m[f];d.imageIndex=(f+1)}d=new a.UI.ModelImageControl();d.bIsDirty=true;d.rawWidth=l;if(j>=k){d.imageIndex=k;j=k;m.push(d)}else{d.imageIndex=j;m.splice(j,0,d)}h.__bAddingImage=true;h.UpdateAllImage(m,j,j,k);h.__bAddingImage=false;return true};b.RemoveImage=function(f,d){var h=this,j=f*1,l=d*1,k,n,m;if(typeof(j)==="undefined"||j<0){return}n=h.GetDataImageControlList();k=n.length;if(k==1){h.RemoveAllImages();return}if(j>=k){j=k-1}else{var g=j,e;for(;g<n.length;g++){e=n[g];e.imageIndex=(g-1)}}m=n.splice(j,1);if(m&&m[0]){m[0].Clear()}h.UpdateAllImage(n,l,j,k-2);return true};b.MoveImage=function(e,n){var h=this,l,m,g,f,k,j,d;m=h.GetDataImageControlList();l=m.length;g=e;k=m[e];for(;g<m.length;g++){f=m[g];f.imageIndex=(g-1)}m.splice(e,1);g=n;for(;g<m.length;g++){f=m[g];f.imageIndex=(g+1)}m.splice(n,0,k);k.imageIndex=n;if(e<n){j=e;d=n}else{j=n;d=e}h.UpdateAllImage(m,h.GetCurrentImageIndex(),j,d);return true};b.GetCurrentImageIndex=function(){return this.cCurrentIndex};b.GetSelectedIndexes=function(){return this.aryCurrentSelectedImageIndicesInBuffer};b.HowManyImagesInBuffer=function(){return this.GetDataImageControlList().length};b.SwitchImage=function(f,e){var k=this,d,j,h,g;j=k.GetDataImageControlList();d=j.length;if(f<j.length&&f>=0&&e<j.length&&e>=0){h=j[f];h.imageIndex=e;g=j[e];g.imageIndex=f;j[e]=h;j[f]=g}return true};a.UI=a.UI||{};a.UI.FakeView=c})(Dynamsoft.Lib);(function(a){if(!a.product.bChromeEdition){return}var c=a.html5.STwain,b=c.prototype,d=a.html5.Funs;b.AddText=function(k,e,m,l,j,g,h,f){return this._innerFun("AddText",d.makeParams(k,e,m,l,j,g,h,f))};b.CreateTextFont=function(g,s,m,l,o,p,h,q,e,n,j,k,r,f){return this._innerFun("CreateTextFont",d.makeParams(g,s,m,l,o,p,h,q,e,n,j,k,r,f))};b.CopyToClipboard=function(e){return this._innerFun("CopyToClipboard",d.makeParams(e))};b.Erase=function(g,j,h,f,e){return this._innerFun("Erase",d.makeParams(g,j,h,f,e))};b.GetImageBitDepth=function(e){return this._innerFun("GetImageBitDepth",d.makeParams(e))};b.GetImageWidth=function(e){return this._innerFun("GetImageWidth",d.makeParams(e))};b.GetImageHeight=function(e){return this._innerFun("GetImageHeight",d.makeParams(e))};b.GetImageSize=function(f,e,g){return this._innerFun("GetImageSize",d.makeParams(f,e,g))};b.GetImageSizeWithSpecifiedType=function(e,f){return this._innerFun("GetImageSizeWithSpecifiedType",d.makeParams(e,f))};b.GetImageXResolution=function(e){return this._innerFun("GetImageXResolution",d.makeParams(e))};b.GetImageYResolution=function(e){return this._innerFun("GetImageYResolution",d.makeParams(e))};b.GetSelectedImageIndex=function(e){var f=this;if(e>=0){return f._UIManager.GetSelectedImageIndex(e)}return -1};b.SetSelectedImageIndex=function(g,f){var h=this,e=h.__SelectedImagesCount;if(g<h.__SelectedImagesCount&&g>=0){h._UIManager.SetSelectedImageIndex(g,f);return this._innerFun("SetSelectedImageIndex",d.makeParams(g,f))}else{a.Errors.InvalidIndex(h);return false}};b.GetSkewAngle=function(e){return this._innerFun("GetSkewAngle",d.makeParams(e))};b.GetSkewAngleEx=function(g,j,h,f,e){return this._innerFun("GetSkewAngleEx",d.makeParams(g,j,h,f,e))};b.IsBlankImageEx=function(g,j,h,f,e,k){return this._innerFun("IsBlankImageEx",d.makeParams(g,j,h,f,e,k))};b.Mirror=function(e){return this._innerFun("Mirror",d.makeParams(e))};b.RemoveAllImages=function(){var f=this,e;e=f._innerFun("RemoveAllImages");if(e){f._HowManyImagesInBuffer=0;f._UIManager.clear()}return e};b.RemoveImage=function(g){var h=this,f=parseInt(g),e;if(f<0||f>=h.HowManyImagesInBuffer){a.Errors.IndexOutOfRange(h);return false}e=h._innerFun("RemoveImage",d.makeParams(f));if(e){h._HowManyImagesInBuffer=h._innerFun("HowManyImagesInBuffer");h.__cIndex=h._innerFun("CurrentImageIndexInBuffer");if(h._HowManyImagesInBuffer==0){h._UIManager.clear()}}return e};b.Rotate=function(h,f,g){var l=this,e=parseInt(h),j,k;if(e<0||e>=l.HowManyImagesInBuffer){a.Errors.IndexOutOfRange(l);return false}j=l._innerFun("Rotate",d.makeParams(e,f,g));k=(j==1);if(k){d.refreshImageAfterInvokeFun(l,e)}return k};b.RotateEx=function(j,g,h,e){var m=this,f=parseInt(j),k,l;if(f<0||f>=m.HowManyImagesInBuffer){a.Errors.IndexOutOfRange(m);return false}k=m._innerFun("RotateEx",d.makeParams(f,g,h,e));l=(k==1);if(l){d.refreshImageAfterInvokeFun(m,f)}return l};b.RotateLeft=function(f){var j=this,e=parseInt(f),g,h;if(e<0||e>=j.HowManyImagesInBuffer){a.Errors.IndexOutOfRange(j);return false}g=j._innerFun("RotateLeft",d.makeParams(e));h=(g==1);if(h){d.refreshImageAfterInvokeFun(j,e)}return h};b.RotateRight=function(f){var j=this,e=parseInt(f),g,h;if(e<0||e>=j.HowManyImagesInBuffer){a.Errors.IndexOutOfRange(j);return false}g=j._innerFun("RotateRight",d.makeParams(e));h=(g==1);if(h){d.refreshImageAfterInvokeFun(j,e)}return h};b.ChangeImageSize=function(o,f,l,n){var h=this,j=parseInt(o),m=1*f,k=1*l,e,g;if(j<0||j>=h.HowManyImagesInBuffer){a.Errors.IndexOutOfRange(h);return false}if(m<=0||k<=0){a.Errors.InvalidWidthOrHeight(h);return false}e=h._innerFun("ChangeImageSize",d.makeParams(j,m,k,n));g=(e==1);if(g){d.refreshImageAfterInvokeFun(h,j)}return g};b.Flip=function(f){var j=this,e=parseInt(f),g,h;if(e<0||e>=j.HowManyImagesInBuffer){a.Errors.IndexOutOfRange(j);return false}g=j._innerFun("Flip",d.makeParams(e));h=(g==1);if(h){d.refreshImageAfterInvokeFun(j,e)}return h};b.Crop=function(n,g,l,m,f){var j=this,k=parseInt(n),e,h;if(k<0||k>=j.HowManyImagesInBuffer){a.Errors.IndexOutOfRange(j);return false}e=j._innerFun("Crop",d.makeParams(k,g,l,m,f));h=(e==1);if(h){d.refreshImageAfterInvokeFun(j,k)}return h};b.CropToClipboard=function(n,g,l,m,f){var j=this,k=parseInt(n),e,h;if(k<0||k>=j.HowManyImagesInBuffer){a.Errors.IndexOutOfRange(j);return false}e=j._innerFun("CropToClipboard",d.makeParams(k,g,l,m,f));h=(e==1);if(h){d.refreshImageAfterInvokeFun(j,k)}return h};b.CutFrameToClipboard=function(n,g,l,m,f){var j=this,k=parseInt(n),e,h;if(k<0||k>=j.HowManyImagesInBuffer){a.Errors.IndexOutOfRange(j);return false}e=j._innerFun("CutFrameToClipboard",d.makeParams(k,g,l,m,f));h=(e==1);if(h){d.refreshImageAfterInvokeFun(j,k)}return h};b.CutToClipboard=function(f){var j=this,e=parseInt(f),g,h;if(e<0||e>=j.HowManyImagesInBuffer){a.Errors.IndexOutOfRange(j);return false}g=j._innerFun("CutToClipboard",d.makeParams(e));h=(g==1);if(h){d.refreshImageAfterInvokeFun(j,e)}return h};b.SetDPI=function(k,f,j,e,g){var l=this,h=parseInt(k);if(h<0||h>=l.HowManyImagesInBuffer){a.Errors.IndexOutOfRange(l);return false}return l._innerFun("SetDPI",d.makeParams(h,f,j,e,g))};b.SetViewMode=function(j,f){var k=this,g,e;g=Math.floor(j);e=Math.floor(f);k._UIManager.SetViewMode(g,e);return true};b.MoveImage=function(j,h){var k=this,g=parseInt(j),e=parseInt(h),f;if(g<0||g>=k.HowManyImagesInBuffer||e<0||e>=k.HowManyImagesInBuffer){a.Errors.IndexOutOfRange(k);return false}f=k._innerFun("MoveImage",d.makeParams(g,e));if(f){f=k._UIManager.MoveImage(g,e)}return f};b.SwitchImage=function(j,h){var k=this,g=parseInt(j),e=parseInt(h),f;if(g<0||g>=k.HowManyImagesInBuffer||e<0||e>=k.HowManyImagesInBuffer){a.Errors.IndexOutOfRange(k);return false}f=k._innerFun("SwitchImage",d.makeParams(g,e));if(f){k._UIManager.SwitchImage(g,e)}return f};b.CloseWorkingProcess=function(){return this._innerFun("CloseWorkerProcess")};b.OverlayRectangle=function(j,l,k,g,f,e,h){var m=this;if(d.isServerInvalid(m)){return false}if(l>g||k>f||(l==g&&k==f)){a.Errors.Overlay_InvalidLeftOrTopOrRightOrBottom(m);return false}return this._UIManager.OverlayRectangle(j,l,k,g,f,e,h)};b.RemoveAllSelectedImages=function(){var f=this,e;e=d.__SetSelectedImages(f,f._UIManager.GetCurrentImageIndex(),f._UIManager.GetSelectedIndexes());if(e){e=f._innerFun("RemoveAllSelectedImages");if(e){f._HowManyImagesInBuffer=f._innerFun("HowManyImagesInBuffer");f.__cIndex=f._innerFun("CurrentImageIndexInBuffer");if(f._HowManyImagesInBuffer==0){f._UIManager.clear()}f._UIManager.SetSelectedImageCount(0);f.__SelectedImagesCount=0}}return e};b.Print=function(e){var g=this;if(e){var f=true;return this._innerSend("PrintEx",d.makeParams(f),function(){},function(){})}g._UIManager.Print();return true};b.SetSelectedImageArea=function(h,k,j,g,e){var l=this,f=parseInt(h);if(f<0||f>=l.HowManyImagesInBuffer){a.Errors.IndexOutOfRange(l);return false}if(d.isServerInvalid(l)){return false}return l._UIManager.SetSelectedImageArea(f,k,j,g,e)}})(Dynamsoft.Lib);(function(b){if(!b.product.bChromeEdition){return}var e=b.html5.STwain,d=e.prototype,c=!1,a=!0,g=b.html5.Funs;d.FileExists=function(h){var j=g.replaceLocalFilename(h);return this._innerFun("FileExists",g.makeParams(j))};d.SaveAllAsMultiPageTIFF=function(h,l,j){var k=g.replaceLocalFilename(h);return this.__innerSaveImage("SaveAllAsMultiPageTIFF",g.makeParams(k),l,j)};d.SaveAllAsPDF=function(h,l,j){var k=g.replaceLocalFilename(h);return this.__innerSaveImage("SaveAllAsPDF",g.makeParams(k),l,j)};d.SaveAsBMP=function(h,k,m,j){var l=g.replaceLocalFilename(h);return this.__innerSaveImage("SaveAsBMP",g.makeParams(l,k),m,j)};d.SaveAsJPEG=function(h,k,m,j){var l=g.replaceLocalFilename(h);return this.__innerSaveImage("SaveAsJPEG",g.makeParams(l,k),m,j)};d.SaveAsPDF=function(h,k,m,j){var l=g.replaceLocalFilename(h);return this.__innerSaveImage("SaveAsPDF",g.makeParams(l,k),m,j)};d.SaveAsPNG=function(h,k,m,j){var l=g.replaceLocalFilename(h);return this.__innerSaveImage("SaveAsPNG",g.makeParams(l,k),m,j)};d.SaveAsTIFF=function(h,k,m,j){var l=g.replaceLocalFilename(h);return this.__innerSaveImage("SaveAsTIFF",g.makeParams(l,k),m,j)};d.SaveAsGIF=function(h,k,m,j){var l=g.replaceLocalFilename(h);return this.__innerSaveImage("SaveAsGIF",g.makeParams(l,k),m,j)};d.SaveSelectedImagesAsMultiPagePDF=function(j,m,k){var n=this,l=g.replaceLocalFilename(j),h;h=g.__SetSelectedImages(n,n._UIManager.GetCurrentImageIndex(),n._UIManager.GetSelectedIndexes());if(h){return n.__innerSaveImage("SaveSelectedImagesAsMultiPagePDF",g.makeParams(l),m,k)}return false};d.SaveSelectedImagesAsMultiPageTIFF=function(j,m,k){var n=this,l=g.replaceLocalFilename(j),h;h=g.__SetSelectedImages(n,n._UIManager.GetCurrentImageIndex(),n._UIManager.GetSelectedIndexes());if(h){return n.__innerSaveImage("SaveSelectedImagesAsMultiPageTIFF",g.makeParams(l),m,k)}return false};d.SaveSelectedImagesToBase64Binary=function(k,j){var l=this,h;h=g.__SetSelectedImages(l,l._UIManager.GetCurrentImageIndex(),l._UIManager.GetSelectedIndexes());if(h){if(b.isFunction(k)){return this._innerSend("SaveSelectedImagesToBase64Binary",null,true,k,j)}else{return l._innerFun("SaveSelectedImagesToBase64Binary")}}return false};d.ShowFileDialog=function(l,j,q,p,o,h,k,r){var n=this,m=g.replaceLocalFilename(o);return this._innerSend("ShowFileDialog",g.makeParams(l,j,q,p,m,h,k,r),true)};d.FTPDownload=function(n,l,k,h){var m=this,j=b.html5.Funs.getImageType(l);return m.__innerFTPDownload("FTPDownload",g.makeParams(n,l),j,k,h)};d.FTPDownloadDirectly=function(p,n,h,m,j){var o=this,k=g.replaceLocalFilename(h),l=b.html5.Funs.getImageType(k);return o.__innerFTPDownloadDirectly("FTPDownloadDirectly",g.makeParams(p,n,k),l,m,j)};d.FTPDownloadEx=function(m,l,j,k,h){return this.__innerFTPDownload("FTPDownloadEx",g.makeParams(m,l,j),j,k,h)};d.FTPUpload=function(m,j,l,k,h){return this.__innerFTPUpload("FTPUpload",g.makeParams(m,j,l),k,h)};d.FTPUploadDirectly=function(o,h,m,l,j){var n=this,k;if(!b.html5.Funs.checkProductKey(n,{Core:true})){if(b.isFunction(j)){j(n._errorCode,n._errorString)}return false}k=g.replaceLocalFilename(h);return n.__innerFTPUpload("FTPUploadDirectly",g.makeParams(o,k,m),l,j)};d.FTPUploadEx=function(n,j,m,k,l,h){return this.__innerFTPUpload("FTPUploadEx",g.makeParams(n,j,m,k),l,h)};d.FTPUploadAllAsMultiPageTIFF=function(l,k,j,h){return this.__innerFTPUpload("FTPUploadAllAsMultiPageTIFF",g.makeParams(l,k),j,h)};d.FTPUploadAllAsPDF=function(l,k,j,h){return this.__innerFTPUpload("FTPUploadAllAsPDF",g.makeParams(l,k),j,h)};d.FTPUploadAsMultiPagePDF=function(l,k,j,h){return this.__innerFTPUpload("FTPUploadAsMultiPagePDF",g.makeParams(l,k),j,h)};d.FTPUploadAsMultiPageTIFF=function(l,k,j,h){return this.__innerFTPUpload("FTPUploadAsMultiPageTIFF",g.makeParams(l,k),j,h)};d.HTTPDownload=function(k,j,m,h){var n=this,l=g.getImageType(j);return n.HTTPDownloadThroughGet(k,j,l,m,h)};e.prototype.HTTPDownloadEx=function(k,j,l,m,h){var n=this;return n.HTTPDownloadThroughGet(k,j,l,m,h)};d.HTTPDownloadDirectly=function(u,h,o,t,m){var q=this,j=f.GetHttpHeadersAndClear(q),l=g.combineUrl(q,u,h),k,r,p;if(l===false){b.Errors.ParameterCannotEmpty(q);return false}if(!o||o==""){b.Errors.InvalidLocalFilename(q,"HTTPDownloadDirectly");if(b.isFunction(m)){m(q.ErrorCode,q.ErrorString)}return false}k=b.html5.Funs.getImageType(o);if(g.isServerInvalid(q)){if(b.isFunction(m)){m(q.ErrorCode,q.ErrorString)}return false}if(!b.html5.Funs.checkProductKey(q,{Core:true})){if(b.isFunction(m)){m(q._errorCode,q._errorString)}return false}if(!b.html5.Funs.checkPDFProductKeyWhenNeeds(q,k)){if(b.isFunction(m)){m(q._errorCode,q._errorString)}return false}b.cancelFrome=2;p=g.replaceLocalFilename(o);r="get";b.showProgress(q,"HTTPDownloadDirectly",true);var s=function(v){var w=(v.total===0)?100:Math.round(v.loaded*100/v.total),x=[v.loaded," / ",v.total].join("");q._OnPercentDone([0,w,"","http"])},n=true;q._OnPercentDone([0,-1,"HTTP Downloading...","http"]);if(!b.isFunction(t)){n=false}ret=g.loadHttpBlob(q,r,l,n,function(v){q._OnPercentDone([0,-1,"Loading..."]);var w=3;return q.__LoadImageFromBytes(v,w,p,n,t,m)},function(){b.closeProgress("HTTPDownloadDirectly");if(b.isFunction(m)){m(q.ErrorCode,q.ErrorString)}return false},s,j);return ret};d.HTTPUploadThroughPostDirectly=function(v,q,h,o,u,n){var s=this,j=f.GetHttpHeadersAndClear(s),k="HTTPUploadThroughPostDirectly",l=g.combineUrl(s,v,h),p=true,r,t;if(v===""){b.Errors.HttpServerCannotEmpty(s);if(b.isFunction(n)){n(s.ErrorCode,s.ErrorString,"")}return false}if(l===false||l===""){b.Errors.ParameterCannotEmpty(s);if(b.isFunction(n)){n(s.ErrorCode,s.ErrorString,"")}return false}if(!b.isFunction(u)){p=false}if(!b.html5.Funs.checkProductKey(s,{Core:true})){if(b.isFunction(n)){n(s.ErrorCode,s.ErrorString,"")}return false}b.cancelFrome=1;var w=function(){b.needShowTwiceShowDialog=false;b.closeProgress(k);if(b.isFunction(n)){n(s.ErrorCode,s.ErrorString,s.__HTTPPostResponseString)}return false};b.needShowTwiceShowDialog=true;b.showProgress(s,k,false);r=g.replaceLocalFilename(q);t=s.__SaveLocalFileToBytes(r,p,function(m){b.needShowTwiceShowDialog=false;if(m&&(b.dlgRef>0||s.__IfShowCancelDialogWhenImageTransfer==false||p==false)){m.name=o;g.setBtnCancelVisibleForProgress(s,true);return g.httpPostUpload(s,l,m,p,0,j,true,function(x){b.closeProgress(k);if(b.isFunction(u)){u(x)}},w)}else{b.closeProgress(k);return false}},w);return t};d.HTTPUploadThroughPost=function(l,k,h,o,n,j){var m=g.getImageType(o);return this.HTTPUploadThroughPostEx(l,k,h,o,m,n,j)};d.HTTPUploadThroughPostEx=function(x,z,j,q,v,w,p){var s=this,n="HTTPUploadThroughPostEx",o=g.combineUrl(s,x,j),r=true,u=false,t="",l=0,h=[],k;s.__HTTPPostResponseString="";if(!b.isFunction(w)){r=false}if(r){switch(z){case -1:h=-1;break;case -2:h=s._UIManager.GetSelectedIndexes();break;default:h.push(z);break}k={bOnlyUploadForm:c,_this:s,url:o,indices:h,enumImageType:v,filename:q,dataFormat:EnumDWT_UploadDataFormat.Binary,asyncSuccessFunc:w,asyncFailureFunc:p};b._aryUploadCmd.push(k);return true}else{b.cancelFrome=1;var y=function(){var m=s.curCommand_SaveImagesToBytes.length;b.needShowTwiceShowDialog=false;b.closeProgress(n);if(b.isFunction(p)){p(s.ErrorCode,s.ErrorString,s.__HTTPPostResponseString)}if(m>0){b.cancelFrome=1;b.needShowTwiceShowDialog=true;b.showProgress(s,n,false);var A=s.curCommand_SaveImagesToBytes[0];g.sendData(A.objWS,A.json,false,A.binary)}return false};b.needShowTwiceShowDialog=true;b.showProgress(s,n,false);if(x===""){b.Errors.HttpServerCannotEmpty(s);return y()}if(o===false){b.Errors.ParameterCannotEmpty(s);return y()}if(z==-2){u=g.__SetSelectedImages(s,s._UIManager.GetCurrentImageIndex(),s._UIManager.GetSelectedIndexes());if(!u){return y()}}else{if(z==-1||z>=0){}else{b.Errors.IndexOutOfRange(s);return y()}}u=s.__GetSelectedImagesLength(v,z,r,function(A){var m=A.split(";");if(m.length==2){t=m[0];l=parseInt(m[1])}if(l==0){b.Errors.UploadFileCannotEmpty(s);return y()}var B=f.GetHttpHeadersAndClear(s);B["dwt-md5"]=t;u=s.__SaveSelectedImagesToBytes(v,0,l,r,function(C){b.needShowTwiceShowDialog=false;if(C&&(b.dlgRef>0||s.__IfShowCancelDialogWhenImageTransfer==false||r==false)){C.name=q;g.setBtnCancelVisibleForProgress(s,true);return g.httpPostUpload(s,o,C,r,0,B,true,function(D){var E=s.curCommand_SaveImagesToBytes.length;b.closeProgress(n);if(b.isFunction(w)){w(D)}if(E>0){b.cancelFrome=1;b.needShowTwiceShowDialog=true;b.showProgress(s,n,false);var F=s.curCommand_SaveImagesToBytes[0];g.sendData(F.objWS,F.json,false,F.binary)}return true},y)}else{b.closeProgress(n);return false}},y);return u},y);return u}};d._checkIndices=function(l){var m=this,h,j;if(!b.isArray(l)){b.Errors.IndicesNotArray(m);return false}if(l.length==0){b.Errors.IndicesCannotEmpty(m);return false}h=m._HowManyImagesInBuffer;for(j=0;j<l.length;j++){var k=l[j];if(b.isUndefined(k)||k===null){b.Errors.IndexNullOrUndefined(m);return false}k=parseInt(k);if(isNaN(k)){b.Errors.InvalidIndex(m);return false}if(k<0||k>=h){b.Errors.IndicesOutOfRange(m);return false}}return true};d.SetUploadSegment=function(h,j){var k=this;if(!(h>=0)){b.Errors.InvalidSegmentUploadThreshold(k);return false}if(!(j>0)){b.Errors.InvalidModuleSize(k);return false}k._segementUploadThreshold=h*1024*1024;k._moduleSize=j*1024;return true};d.HTTPUpload=function(j,q,o,p,l,h){var n=this,k;if(arguments.length<=3){var r=q,m=o;k={bOnlyUploadForm:a,_this:n,url:j,asyncSuccessFunc:r,asyncFailureFunc:m}}else{k={bOnlyUploadForm:c,_this:n,url:j,indices:q,enumImageType:o,dataFormat:p,filename:"RemoteFile",asyncSuccessFunc:l,asyncFailureFunc:h}}b._aryUploadCmd.push(k);return true};d._innerHTTPUpload=function(l,o,q,G,H,n,A){var y=this,r=parseInt(q),C=parseInt(G),j=H,E,u="HTTPUpload",p=l,B=true,I=false,x=y._moduleSize,F=y._segementUploadThreshold,z,D,s,t;y.__HTTPPostResponseString="";E=function(){if(b.isFunction(A)){A(y.ErrorCode,y.ErrorString,y.__HTTPPostResponseString)}return false};if(b.isUndefined(p)||p===""){b.Errors.ParameterCannotEmpty(y);return E()}else{if(!b.isString(p)){b.Errors.InvalidUrl(y);return E()}}if((p.indexOf("http://")!=0)&&(p.indexOf("https://")!=0)){if(b.detect.ssl){p="https://"+p}else{p="http://"+p}}if(g.isServerInvalid(y)){return E()}if(!y._checkIndices(o)&&o!=-1){return E()}if(r==EnumDWT_ImageType.IT_BMP||r==EnumDWT_ImageType.IT_JPG||r==EnumDWT_ImageType.IT_PNG){if(o==-1&&o.length>1){b.Errors.UploadIndexMoreThanOne(y);return E()}}else{if(r==EnumDWT_ImageType.IT_TIF||r==EnumDWT_ImageType.IT_PDF){}else{b.Errors.InvalidImageType(y);return E()}}if(C!=EnumDWT_UploadDataFormat.Binary&&C!=EnumDWT_UploadDataFormat.Base64){b.Errors.InvalidDataFormat(y);return E()}y.__HTTPPostResponseString="";b.cancelFrome=1;var h=function(){var m=y.curCommand_SaveImagesToBytes.length;b.needShowTwiceShowDialog=false;b.closeProgress(u);if(m>0){b.cancelFrome=1;b.needShowTwiceShowDialog=true;b.showProgress(y,u,false);var J=y.curCommand_SaveImagesToBytes[0];g.sendData(J.objWS,J.json,false,J.binary)}if(b.isFunction(A)){A(y.ErrorCode,y.ErrorString,y.__HTTPPostResponseString)}return false};t=function(m){var J=(m.total===0)?100:Math.round(m.loaded*100/m.total),K=[m.loaded," / ",m.total].join("");y._OnPercentDone([0,J,"","http"])};if(C==EnumDWT_UploadDataFormat.Binary){var k="",w=0;if(o!=-1){I=g.__SetSelectedImages(y,y._UIManager.GetCurrentImageIndex(),o);if(!I){return h()}}b.needShowTwiceShowDialog=true;b.showProgress(y,u,false);var v;if(o==-1){v=-1}else{v=-2}I=y.__GetSelectedImagesLength(r,v,B,function(J){var m=J.split(";");if(m.length==2){k=m[0];w=parseInt(m[1])}if(w==0){b.Errors.UploadFileCannotEmpty(y);return h()}if(F>0&&w>F){var L=0,K=f.GetHttpHeadersAndClear(y);K["dwt-md5"]=k;y._OnPercentDone([0,-1,"HTTP Uploading...","http"]);I=f.UploadBinary(y,p,r,j,w,K,L,x,t,function(){b.needShowTwiceShowDialog=false;b.closeProgress(u);if(b.isFunction(n)){n(y.__HTTPPostResponseString)}return true},h)}else{I=y.__innnerHTTPUploadBinaryFull(p,k,w,r,j,n,h)}return I},h)}else{if(C==EnumDWT_UploadDataFormat.Base64){var H=g.addImageFileExt("RemoteFile",r);b.needShowTwiceShowDialog=true;b.showProgress(y,u,false);I=y.ConvertToBase64(o,r,function(L){if(!L||L.getLength()<=0){b.Errors.UploadFileCannotEmpty(y);return h()}if(F>0&&L.getLength()>F){var M=0,K=L.getMD5(),J=f.GetHttpHeadersAndClear(y);J["dwt-md5"]=K;y._OnPercentDone([0,-1,"HTTP Uploading...","http"]);f.UploadBase64(y,p,r,L,H,J,M,x,t,function(){b.needShowTwiceShowDialog=false;b.closeProgress(u);if(b.isFunction(n)){n(y.__HTTPPostResponseString)}},h)}else{var m,K=L.getMD5();m=L.getData(0,L.getLength());if(!m||m==""){b.Errors.UploadFileCannotEmpty(y);return h()}y.__innnerHTTPUploadBase64Full(p,K,m,r,n,h)}},h)}}return I};d._innerFormFieldHTTPUpload=function(j,p,h){var r=this,l,n="HTTPUpload",o=j,q=true,s=false;r.__HTTPPostResponseString="";l=function(){b.needShowTwiceShowDialog=false;b.closeProgress(n);if(b.isFunction(h)){h(r.ErrorCode,r.ErrorString,r.__HTTPPostResponseString)}return false};if(b.isUndefined(o)||o===""){b.Errors.ParameterCannotEmpty(r);return l()}else{if(!b.isString(o)){b.Errors.InvalidUrl(r);return l()}}if((o.indexOf("http://")!=0)&&(o.indexOf("https://")!=0)){if(b.detect.ssl){o="https://"+o}else{o="http://"+o}}if(g.isServerInvalid(r)){return l()}r.__HTTPPostResponseString="";b.cancelFrome=1;b.showProgress(r,n,false);b.needShowTwiceShowDialog=true;var k=f.GetHttpHeadersAndClear(r);r._OnPercentDone([0,-1,"HTTP Uploading...","http"]);s=g.httpUploadByBIO(r,o,c,0,true,k,true,function(m){b.needShowTwiceShowDialog=false;b.closeProgress(n);if(b.isFunction(p)){p(m)}},l);return s};var f={UploadBinary:function(r,n,t,q,k,h,o,s,u,p,w){var v,j,l="HttpUpload";v=k-o;if(v>0){if(v>=s){v-=s;j=s}else{j=v;v=0}r.__SaveSelectedImagesToBytesByBlock(t,o,j,function(x,m){if(!x){b.Errors.UploadFileCannotEmpty(r);return w()}if(b.dlgRef>0||r.__IfShowCancelDialogWhenImageTransfer==false){x.name=q;g.setBtnCancelVisibleForProgress(r,true);h["Content-Range"]=["bytes ",m,"-",m+x.size-1,"/",k].join("");u({total:k,loaded:o});g.httpPostUpload(r,n,x,true,0,h,false,function(y){var z=r.curCommand_SaveImagesToBytes.length;if(z>0){b.cancelFrome=1;var A=r.curCommand_SaveImagesToBytes[0];g.sendData(A.objWS,A.json,false,A.binary)}if(v==0){b.needShowTwiceShowDialog=false;u({total:k,loaded:k});if(b.isFunction(p)){p(y)}}else{o+=j;setTimeout(function(){b.cancelFrome=1;f.UploadBinary(r,n,t,k,h,o,s,u,p,w)},100)}},w);return true}else{b.Errors.UploadError(r,true);return w()}},w)}else{b.needShowTwiceShowDialog=false;b.closeProgress(l);if(b.isFunction(p)){p("")}}return true},UploadBase64:function(r,n,t,y,o,h,p,s,u,q,w){var k=y.getLength(),l="HttpUpload",v,j,x=0;v=k-p;if(v>0){if(v>=s){v-=s;j=s}else{j=v;v=0}r.__GetBase64ResultDataAsync(-1,p,s,function(m){strBase64Data=m[0];if(!strBase64Data||strBase64Data==""){b.Errors.UploadFileCannotEmpty(r);return w()}if(b.dlgRef>0||r.__IfShowCancelDialogWhenImageTransfer==false){g.setBtnCancelVisibleForProgress(r,true);h["Content-Range"]=["bytes ",p,"-",p+j-1,"/",k].join("");u({total:k,loaded:p});g.httpPostUploadString(r,n,strBase64Data,o,0,h,false,function(z){var A=r.curCommand_SaveImagesToBytes.length;if(A>0){b.cancelFrome=1;var B=r.curCommand_SaveImagesToBytes[0];g.sendData(B.objWS,B.json,false,B.binary)}if(v==0){b.needShowTwiceShowDialog=false;u({total:k,loaded:k});if(b.isFunction(q)){q(z)}}else{p+=j;setTimeout(function(){b.cancelFrome=1;f.UploadBase64(r,n,t,y,o,h,p,s,u,q,w)},100)}},w);return true}else{b.Errors.UploadError(r,true);return w()}},w)}else{b.needShowTwiceShowDialog=false;b.closeProgress(l);if(b.isFunction(q)){q("")}}return true},GetHttpHeadersAndClear:function(j){var h=j.__httpHeaderMap;j.__httpHeaderMap={};if(!h){h={}}return h}};d.__innnerHTTPUploadBinaryFull=function(k,j,v,p,z,l,h){var u=this,r=f.GetHttpHeadersAndClear(u),s="HTTPUpload",o=k,x=true,A=false,t=0,w,y,q;z=g.addImageFileExt(z,p);var n=0;r["dwt-md5"]=j;A=u.__SaveSelectedImagesToBytesByBlock(p,n,v,function(B,m){if(!B||B.size<=0){b.Errors.UploadFileCannotEmpty(u);return h()}if(b.dlgRef>0||u.__IfShowCancelDialogWhenImageTransfer==false){B.name=z;g.setBtnCancelVisibleForProgress(u,true);return g.httpPostUpload(u,o,B,x,t,r,true,function(C){var D=u.curCommand_SaveImagesToBytes.length;b.needShowTwiceShowDialog=false;b.closeProgress(s);if(b.isFunction(l)){l(C)}if(D>0){b.cancelFrome=1;b.needShowTwiceShowDialog=true;b.showProgress(u,s,false);var E=u.curCommand_SaveImagesToBytes[0];g.sendData(E.objWS,E.json,false,E.binary)}},h)}else{b.Errors.UploadError(u,true);return h()}},h);return A};d.__innnerHTTPUploadBase64Full=function(j,v,z,x,q,y){var s=this,k=f.GetHttpHeadersAndClear(s),l="HTTPUpload",o,n=j,r=true,u=false,t=0,p,w,h;o=g.addImageFileExt("RemoteFile",x);b.needShowTwiceShowDialog=true;b.showProgress(s,l,false);if(b.dlgRef>0||s.__IfShowCancelDialogWhenImageTransfer==false){if(k){k["dwt-md5"]=v}g.setBtnCancelVisibleForProgress(s,true);return g.httpPostUploadString(s,n,z,o,0,k,true,function(m){var A=s.curCommand_SaveImagesToBytes.length;b.needShowTwiceShowDialog=false;b.closeProgress(l);if(b.isFunction(q)){q(m)}if(A>0){b.cancelFrome=1;b.needShowTwiceShowDialog=true;b.showProgress(s,l,false);var B=s.curCommand_SaveImagesToBytes[0];g.sendData(B.objWS,B.json,false,B.binary)}},y)}else{b.Errors.UploadError(s,true);return y()}return u};d.ConvertToBase64=function(r,p,l,h){var n=this,j=parseInt(p),k="SaveSelectedImagesToBase64Binary",o;if(g.isServerInvalid(n)){if(b.isFunction(h)){h(n.ErrorCode,n.ErrorString)}return false}if(!n._checkIndices(r)){if(b.isFunction(h)){h(n.ErrorCode,n.ErrorString)}return false}if(j==EnumDWT_ImageType.IT_BMP||j==EnumDWT_ImageType.IT_JPG||j==EnumDWT_ImageType.IT_PNG){if(r.length>1){b.Errors.ConvertBase64IndexMoreThanOne(n);if(b.isFunction(h)){h(n.ErrorCode,n.ErrorString)}return false}}else{if(j==EnumDWT_ImageType.IT_TIF||j==EnumDWT_ImageType.IT_PDF){}else{b.Errors.InvalidImageType(n);if(b.isFunction(h)){h(n.ErrorCode,n.ErrorString)}return false}}o=g.__SetSelectedImages(n,n._UIManager.GetCurrentImageIndex(),r);if(!o){if(b.isFunction(h)){h(n.ErrorCode,n.ErrorString)}return false}b.showProgress(n,k,false);var q=function(){b.closeProgress(k);if(b.isFunction(h)){h(n.ErrorCode,n.ErrorString)}return false};o=n._innerSend(k,g.makeParams(j,0,0),true,function(v){var s,m=0,u="",t;if(n.ErrorCode!=0){q();return}if(v&&b.isArray(v)&&v.length==1){t=v[0].split(";");if(t.length==2){u=t[0];m=parseInt(t[1])}s=new b.html5.Base64Result(n,m,u);b.closeProgress(k);if(b.isFunction(l)){l(s)}}else{b.Errors.ConvertBase64Failed(n);q()}},q);return o};d.ClearAllHTTPFormField=function(){var h=this;h.httpFormFields={};return true};d.SetHTTPFormField=function(m,h,k){var l=this,j=m;if(!b.isString(j)){j=""+j}if(h instanceof Blob){h.name=k}l.httpFormFields[j]=h;return true};d.HTTPUploadAllThroughPostAsMultiPageTIFF=function(l,h,o,n,k){var j=-1,m=2;return this.HTTPUploadThroughPostEx(l,j,h,o,m,n,k)};d.HTTPUploadThroughPostAsMultiPageTIFF=function(l,h,p,n,k){var o=this,j=-2,m=2;return o.HTTPUploadThroughPostEx(l,j,h,p,m,n,k)};d.HTTPUploadAllThroughPostAsPDF=function(l,h,p,n,k){var o=this,j=-1,m=4;return this.HTTPUploadThroughPostEx(l,j,h,p,m,n,k)};d.HTTPUploadThroughPostAsMultiPagePDF=function(l,h,p,n,k){var o=this,j=-2,m=4;return o.HTTPUploadThroughPostEx(l,j,h,p,m,n,k)};d.HTTPDownloadThroughPost=function(t,h,k,s,m){var o=this,j=f.GetHttpHeadersAndClear(o),l=g.combineUrl(o,t,h),q,p;if(l===c){b.Errors.ParameterCannotEmpty(o);return c}if(g.isServerInvalid(o)){if(b.isFunction(m)){m(o.ErrorCode,o.ErrorString)}return c}if(!b.html5.Funs.checkProductKey(o,{Core:a})){if(b.isFunction(m)){m(o._errorCode,o._errorString)}return c}if(!b.html5.Funs.checkPDFProductKeyWhenNeeds(o,k)){if(b.isFunction(m)){m(o._errorCode,o._errorString)}return c}b.cancelFrome=2;b.showProgress(o,"HttpDownloadThroughPost",a);q="post";var r=function(u){var v=(u.total===0)?100:Math.round(u.loaded*100/u.total),w=[u.loaded," / ",u.total].join("");o._OnPercentDone([0,v,"","http"])},n=a;o._OnPercentDone([0,-1,"HTTP Downloading...","http"]);if(!b.isFunction(s)){n=c}p=g.loadHttpBlob(o,q,l,n,function(u){o._OnPercentDone([0,-1,"Loading..."]);var w="",v=k;if(v<-1||v>5){v=-1}o.__LoadImageFromBytes(u,v,w,n,s,m)},function(){b.closeProgress("HttpDownloadThroughPost");if(b.isFunction(m)){m(o.ErrorCode,o.ErrorString)}},r,j);return p};d.HTTPDownloadThroughGet=function(t,h,k,s,m){var o=this,j=f.GetHttpHeadersAndClear(o),l=g.combineUrl(o,t,h),q,p;if(l===c){b.Errors.ParameterCannotEmpty(o);return c}if(g.isServerInvalid(o)){if(b.isFunction(m)){m(o.ErrorCode,o.ErrorString)}return c}if(!b.html5.Funs.checkProductKey(o,{Core:a})){if(b.isFunction(m)){m(o._errorCode,o._errorString)}return c}if(!b.html5.Funs.checkPDFProductKeyWhenNeeds(o,k)){if(b.isFunction(m)){m(o._errorCode,o._errorString)}return c}b.cancelFrome=2;q="get";b.showProgress(o,"HTTPDownloadThroughGet",a);var r=function(u){var v=(u.total===0)?100:Math.round(u.loaded*100/u.total),w=[u.loaded," / ",u.total].join("");o._OnPercentDone([0,v,"","http"])},n=a;o._OnPercentDone([0,-1,"HTTP Downloading...","http"]);if(!b.isFunction(s)){n=c}p=g.loadHttpBlob(o,q,l,n,function(u){o._OnPercentDone([0,-1,"Loading..."]);var w="",v=k;if(v<-1||v>5){v=-1}o.__LoadImageFromBytes(u,v,w,n,s,m)},function(){b.closeProgress("HTTPDownloadThroughGet");if(b.isFunction(m)){m(o.ErrorCode,o.ErrorString)}},r,j);return p};d.HTTPUploadThroughPut=function(l,k,h,n,j){var m=g.getImageType(h);return this.HTTPUploadThroughPutEx(l,k,h,m,n,j)};d.HTTPUploadThroughPutEx=function(u,w,s,q,t,l){var o=this,h=f.GetHttpHeadersAndClear(o),j="HTTPUploadThroughPutEx",k=g.combineUrl(o,u,s),n=true,p=false;if(k===false){b.Errors.ParameterCannotEmpty(o);return false}if(!b.isFunction(t)){n=false}b.cancelFrome=1;var v=function(){var m=o.curCommand_SaveImagesToBytes.length;b.needShowTwiceShowDialog=false;b.closeProgress(j);if(b.isFunction(l)){l(o.ErrorCode,o.ErrorString,o.__HTTPPostResponseString)}if(m>0){b.cancelFrome=1;b.needShowTwiceShowDialog=true;b.showProgress(o,j,false);var x=o.curCommand_SaveImagesToBytes[0];g.sendData(x.objWS,x.json,false,x.binary)}return false},r;b.needShowTwiceShowDialog=true;b.showProgress(o,j,false);if(u===""){b.Errors.HttpServerCannotEmpty(o);return v()}if(w==-2){p=g.__SetSelectedImages(o,o._UIManager.GetCurrentImageIndex(),o._UIManager.GetSelectedIndexes());if(!p){return v()}}else{if(w==-1||w>=0){}else{b.Errors.IndexOutOfRange(o);return v()}}p=o.__GetSelectedImagesLength(q,w,n,function(x){var m=x.split(";");if(m.length==2){md5=m[0];iLen=parseInt(m[1])}if(iLen==0){b.Errors.UploadFileCannotEmpty(o);return v()}h["dwt-md5"]=md5;p=o.__SaveSelectedImagesToBytes(q,0,iLen,n,function(y){b.needShowTwiceShowDialog=false;if(y&&(b.dlgRef>0||o.__IfShowCancelDialogWhenImageTransfer==false||n==false)){r=function(z){var A=(z.total===0)?100:Math.round(z.loaded*100/z.total),B=[z.loaded," / ",z.total].join("");o._OnPercentDone([0,A,"","http"])};o._OnPercentDone([0,-1,"uploading...","http"]);g.setBtnCancelVisibleForProgress(o,true);return g.httpPutImage(o,k,y,n,function(z){var A=o.curCommand_SaveImagesToBytes.length;o.__HTTPPostResponseString=z;b.closeProgress(j);if(b.isFunction(t)){t(o.__HTTPPostResponseString)}if(A>0){b.cancelFrome=1;b.needShowTwiceShowDialog=true;b.showProgress(o,j,false);var B=o.curCommand_SaveImagesToBytes[0];g.sendData(B.objWS,B.json,false,B.binary)}return true},v,r)}else{b.closeProgress(j);return false}},v);return p},v);return p};d.HTTPUploadAllThroughPutAsMultiPageTIFF=function(l,h,n,k){var j=-1,m=2;return this.HTTPUploadThroughPutEx(l,j,h,m,n,k)};d.HTTPUploadThroughPutAsMultiPageTIFF=function(l,h,n,k){var o=this,j=-2,m=2;return o.HTTPUploadThroughPutEx(l,j,h,m,n,k)};d.HTTPUploadAllThroughPutAsPDF=function(l,h,n,k){var j=-1,m=4;return this.HTTPUploadThroughPutEx(l,j,h,m,n,k)};d.HTTPUploadThroughPutAsMultiPagePDF=function(l,h,n,k){var o=this,j=-2,m=4;return o.HTTPUploadThroughPutEx(l,j,h,m,n,k)};d.GetSelectedImagesSize=function(j){var k=this,h;h=g.__SetSelectedImages(k,k._UIManager.GetCurrentImageIndex(),k._UIManager.GetSelectedIndexes());if(h){return this._innerFun("GetSelectedImagesSize",g.makeParams(j))}return false};d.SetHTTPHeader=function(l,n){var o=this,h,k,j,m=l;if(!o.__httpHeaderMap){o.__httpHeaderMap={}}if(!m||!b.isString(m)){if(b.isUndefined(m)){b.Errors.HttpHeaderIsUndefined(o)}else{if(m===""){b.Errors.HttpHeaderIsEmpty(o)}else{if(m===null){b.Errors.HttpHeaderIsNull(o)}else{b.Errors.HttpHeaderIsInvalid(o)}}}return false}k=["if-modified-since","if-none-match","if-range","range","accept-charset","accept-encoding","access-control-request-headers","access-control-request-method","connection","content-length","cookie","cookie2","date","dnt","expect","host","keep-alive","origin","referer","te","trailer","transfer-encoding","upgrade","user-agent","via","dwt-md5"];m=m.toLowerCase();for(j=0;j<k.length;j++){if(k[j]==m){b.Errors.HttpHeaderNotAllowed(o);return false}}if(b.isUndefined(n)||n===null||n===""){if(l in o.__httpHeaderMap){delete o.__httpHeaderMap[l]}return true}if(b.isNumber(n)){n=""+n}o.__httpHeaderMap[l]=n;return true};d.__GetBase64ResultData=function(h,k,j){return this._innerFun("SaveSelectedImagesToBase64Binary",g.makeParams(h,k,j))};d.__GetBase64ResultDataAsync=function(h,l,k,j,m){return this._innerFunRaw("SaveSelectedImagesToBase64Binary",g.makeParams(h,l,k),true,false,false,j,m)};b.html5.Base64Result=function(h,k,j){var l=this;l._stwain=h;l._md5=j;l._length=k};b.html5.Base64Result.prototype.getLength=function(){return this._length};b.html5.Base64Result.prototype.getMD5=function(){return this._md5};b.html5.Base64Result.prototype.getData=function(l,j){var m=this,h=j,k=-1;if(l<0||j<=0){return""}if(l+h>m._length){h=m._length-l}return m._stwain.__GetBase64ResultData(k,l,h)};d.ConvertToBlob=function(u,s,n,h){var p=this,k=parseInt(s),l="ConvertToBlob",o=true,r=false,q="",j=0;if(!b.isFunction(n)){o=false}if(g.isServerInvalid(p)){if(b.isFunction(h)){h(p.ErrorCode,p.ErrorString)}return false}if(!p._checkIndices(u)){if(b.isFunction(h)){h(p.ErrorCode,p.ErrorString)}return false}if(k==EnumDWT_ImageType.IT_BMP||k==EnumDWT_ImageType.IT_JPG||k==EnumDWT_ImageType.IT_PNG){if(u.length>1){b.Errors.ConvertBinaryIndexMoreThanOne(p);if(b.isFunction(h)){h(p.ErrorCode,p.ErrorString)}return false}}else{if(k==EnumDWT_ImageType.IT_TIF||k==EnumDWT_ImageType.IT_PDF){}else{b.Errors.InvalidImageType(p);if(b.isFunction(h)){h(p.ErrorCode,p.ErrorString)}return false}}b.cancelFrome=0;b.showProgress(p,l,false);var t=function(){var m=p.curCommand_SaveImagesToBytes.length;b.needShowTwiceShowDialog=false;b.closeProgress(l);if(b.isFunction(h)){h(p.ErrorCode,p.ErrorString)}if(m>0){b.cancelFrome=0;b.needShowTwiceShowDialog=true;b.showProgress(p,l,false);var v=p.curCommand_SaveImagesToBytes[0];g.sendData(v.objWS,v.json,false,v.binary)}return false};r=g.__SetSelectedImages(p,p._UIManager.GetCurrentImageIndex(),u);if(!r){t();return false}r=p.__GetSelectedImagesLength(k,-2,o,function(v){var m=v.split(";");if(m.length==2){q=m[0];j=parseInt(m[1])}r=p.__SaveSelectedImagesToBytes(k,0,j,o,function(y){b.needShowTwiceShowDialog=false;b.closeProgress(l);if(b.isFunction(n)){if(y instanceof Blob){var x=g.getBlobTypeByImageType(k);n(y.slice(0,j,x))}else{n(y)}}var w=p.curCommand_SaveImagesToBytes.length;if(w>0){b.cancelFrome=0;b.needShowTwiceShowDialog=true;b.showProgress(p,l,false);var z=p.curCommand_SaveImagesToBytes[0];g.sendData(z.objWS,z.json,false,z.binary)}if(o){return true}else{var x=g.getBlobTypeByImageType(k);return y.slice(0,j,x)}},t);return r},t);return r};b._aryUploadCmd=[];b._asyUploadLoop=function(){if(b._aryUploadCmd.length==0){setTimeout(b._asyUploadLoop,500);return}var l=b._aryUploadCmd[0];b._aryUploadCmd.splice(0,1);var o=l._this,m=l.bOnlyUploadForm,k=l.url,n=l.asyncSuccessFunc,j=l.asyncFailureFunc;if(m){o._innerFormFieldHTTPUpload(k,function(){if(b.isFunction(n)){try{n(o.__HTTPPostResponseString)}catch(s){}}setTimeout(b._asyUploadLoop,0)},function(){if(b.isFunction(j)){try{j(o.ErrorCode,o.ErrorString,o.__HTTPPostResponseString)}catch(s){}}setTimeout(b._asyUploadLoop,0)})}else{var r=l.indices,p=l.enumImageType,q=l.dataFormat,h=l.filename;o._innerHTTPUpload(k,r,p,q,h,function(){if(b.isFunction(n)){try{n(o.__HTTPPostResponseString)}catch(s){}}setTimeout(b._asyUploadLoop,0)},function(){if(b.isFunction(j)){try{j(o.ErrorCode,o.ErrorString,o.__HTTPPostResponseString)}catch(s){}}setTimeout(b._asyUploadLoop,0)})}};setTimeout(b._asyUploadLoop,500)})(Dynamsoft.Lib);(function(a){if(!a.product.bChromeEdition){return}var c=Dynamsoft.Lib.html5.STwain,d=Dynamsoft.Lib.html5.Funs,b=c.prototype;b.RegisterEvent=function(e,g){var f;f=["__",e].join("");this[f]=g;return true};b.onEvent=function(e,f){this.RegisterEvent(e,f)};b.on=function(e,f){this.RegisterEvent(e,f)};b.OnRefreshUI=function(g,f,j,h){var k=this,e="On RefreshUI";if(j){k._UIManager.refresh(g,f,true,h)}if(Dynamsoft.Lib.isFunction(k.__OnRefreshUI)){k.__OnRefreshUI(k._UIManager.GetCurrentImageIndex(),f)}return true};b._OnBitmapChanged=function(p){var o=this,l=p[1].split(","),e=p[2],g=p[3],k=p[4],f=0,h="OnBitmapChanged:",n=1,j=2,q=3,r=4,s=5;if(p.length>5){f=p[5]}o.__cIndex=g;o._HowManyImagesInBuffer=k;Dynamsoft.Lib.log(h+p);if(e==n||e==j){Dynamsoft.Lib.each(l,function(t){var u=parseInt(t),m="item_"+u;if(isNaN(u)||u<0){return true}o._UIManager.add(u,k,f)});if(Dynamsoft.Lib.isFunction(o.__OnRefreshUI)){o.__OnRefreshUI(g,k)}}else{if(e==q){if(l.length==1&&l[0]==-1||k==0){o._UIManager.clear()}else{Dynamsoft.Lib.each(l,function(t,m){var u=parseInt(t);if(isNaN(u)||u<0){return true}o._UIManager.remove(u,g)});if(g>=0&&!o.__bLoadingImage&&o._UIManager.count()>0){o._UIManager.refreshEditor(g,k)}}if(Dynamsoft.Lib.isFunction(o.__OnRefreshUI)){o.__OnRefreshUI(g,k)}}else{if(e==r){Dynamsoft.Lib.each(l,function(t,m){var u=parseInt(t);if(isNaN(u)||u<0){return true}if(u>=0&&!o.__bLoadingImage){o.OnRefreshUI(u,k,true,f)}})}else{if(e==s){if(g>=0&&!o.__bLoadingImage){o.OnRefreshUI(g,k,true,f)}}}}}if(Dynamsoft.Lib.isFunction(o.__OnBitmapChanged)){o.__OnBitmapChanged(l,e,g,k)}};b._OnPostLoad=function(m,e){var k=this,j,o,l,g,n,h;if(e!==undefined&&e.exception!==undefined&&e.description!==undefined){k._errorCode=e.exception;k._errorString=e.description}Dynamsoft.Lib.log("OnPostLoad Results:");g=m[1].split(",");o=Dynamsoft.Lib.base64.decode(g[0]);n=Dynamsoft.Lib.base64.decode(g[1]);Dynamsoft.Lib.log(o);Dynamsoft.Lib.log(n);Dynamsoft.Lib.log(g[2]);d.autoDiscardBlankImage(k,"On PostLoad");h=k.__cIndex;if(h>=0){k.OnRefreshUI(h)}if(Dynamsoft.Lib.isFunction(k.__OnPostLoad)){k.__OnPostLoad(o,n,g[2])}};b._OnPostTransfer=function(e){var f=this;Dynamsoft.Lib.log("On PostTransfer Results:"+e);d.autoDiscardBlankImage(f,"On PostTransfer");if(Dynamsoft.Lib.isFunction(f.__OnPostTransfer)){f.__OnPostTransfer()}};b._OnPostAllTransfers=function(f){var k=this,e,h,g=k._UIManager.GetCurrentImageIndex(),j=k._UIManager.count();if(f.length>=2){k._errorCode=f[1];k._errorString=f[2]}Dynamsoft.Lib.log("On PostAllTransfers Results:"+f);k.__bLoadingImage=false;k._UIManager.refreshEditor(g,j);if(Dynamsoft.Lib.isFunction(k.__OnPostAllTransfers)){k.__OnPostAllTransfers()}};b._OnResult=function(e){var g=this,f=e[1];if(Dynamsoft.Lib.isFunction(g.__OnResult)){g.__OnResult(f)}};b._OnTransferCancelled=function(e){var h=this,f=h._UIManager.GetCurrentImageIndex(),g=h._UIManager.count();h.__bLoadingImage=false;h._UIManager.refreshEditor(f,g);if(Dynamsoft.Lib.isFunction(h.__OnTransferCancelled)){h.__OnTransferCancelled()}};b._OnTransferError=function(e){var f=this;if(Dynamsoft.Lib.isFunction(f.__OnTransferError)){f.__OnTransferError()}};b._OnSourceUIClose=function(e){var f=this;if(Dynamsoft.Lib.isFunction(f.__OnSourceUIClose)){f.__OnSourceUIClose()}};b._OnPreTransfer=function(e){var f=this;if(Dynamsoft.Lib.isFunction(f.__OnPreTransfer)){f.__OnPreTransfer()}};b._OnPreAllTransfers=function(e){var f=this;if(Dynamsoft.Lib.isFunction(f.__OnPreAllTransfers)){f.__OnPreAllTransfers()}};b._OnPercentDone=function(o){var j=this;var p=false;if((Dynamsoft.Lib.cancelFrome==0&&j.__IfShowProgressBar==true)||(Dynamsoft.Lib.cancelFrome!=0&&j.__IfShowCancelDialogWhenImageTransfer==true)){var n=Dynamsoft.Lib.one(".dynamsoft-progressBar"),h=Dynamsoft.Lib.one(".dynamsoft-status"),e=Dynamsoft.Lib.one(".dynamsoft-finalMessage"),k=0,l;if(Dynamsoft.Lib.cancelFrome==3||Dynamsoft.Lib.cancelFrome==4){var g=o[3];if(g==0){d.setBtnCancelVisibleForProgress(j,false)}else{if(g==1){d.setBtnCancelVisibleForProgress(j,true)}}}k=o[1];if(k<0){k=0;Dynamsoft.Lib.progressMessage=o[2];l=Dynamsoft.Lib.progressMessage}else{if(o[2]!=""){l=Dynamsoft.Lib.progressMessage+"("+o[2]+")"}else{l=Dynamsoft.Lib.progressMessage}if(Dynamsoft.Lib.cancelFrome==1||Dynamsoft.Lib.cancelFrome==2){if(o[3]=="http"){p=true}}if(Dynamsoft.Lib.cancelFrome==3||Dynamsoft.Lib.cancelFrome==4){if(o[4]=="ftp"){p=true}}}if(e){e.html(l)}if(k||k===0){h&&h.html(k+"%");if(n){if(Dynamsoft.Lib.env.bIE){if(n[0].objProgressBar){n[0].objProgressBar.setValue(k)}else{n[0].value=k}}else{n[0].value=k}}if(p==true){if(Dynamsoft.Lib.isFunction(j.__OnInternetTransferPercentage)){j.__OnInternetTransferPercentage(k,false)}if(Dynamsoft.Lib.isFunction(j.__OnInternetTransferPercentageEx)){j.__OnInternetTransferPercentageEx(k,false)}}}if(k&&(k>=100||Dynamsoft.Lib.dlgRef<=0)){if(Dynamsoft.Lib.dlgRef<=0){var f="OnPercentDone";Dynamsoft.Lib.closeProgress(f)}}}if(Dynamsoft.Lib.isFunction(j.__OnPercentDone)){j.__OnPercentDone()}};b._OnGetFilePath=function(g){var m=this,h,k,l,j,e;l=g[1].split(",");Dynamsoft.Lib.log("On GetFilePath Results:"+g);j=Dynamsoft.Lib.base64.decode(l[3]);e=Dynamsoft.Lib.base64.decode(l[4]);if(Dynamsoft.Lib.isFunction(m.__OnGetFilePath)){m.__OnGetFilePath(l[0],l[1],l[2],j,e)}};b.checkErrorString=function(){var g=this,f=g.ErrorCode;if(f===-2115){return true}if(f===-2003){var e=window.open("","ErrorMessage","height=500,width=750,top=0,left=0,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no");e.document.writeln(g.__HTTPPostResponseString)}return(f===0)}})(Dynamsoft.Lib);(function(b){if(!b.product.bChromeEdition){return}var f=b.html5.STwain,e=f.prototype,g=b.html5.Funs,d=Dynamsoft.WebTwainEnv,c=!1,a=!0;e.ShowImageEditor=function(){var h=this;if(g.isServerInvalid(h)){return c}return h.ShowImageEditorEx(-1,-1,-1,-1,0)};e.SetCookie=function(h){this._cookie=h;document.cookie=h;return a};e.LoadImageFromBase64Binary=function(l,q,r,k){var o=this,j=c,h="LoadImageFromBase64Binary",n=q,p;if(!b.html5.Funs.checkProductKey(o,{Core:a})){return c}if(n<-1||n>5){n=-1}if(!b.html5.Funs.checkPDFProductKeyWhenNeeds(o,n)){return c}if(b.isFunction(r)){j=a}if(j){if(g.isServerInvalid(o)){if(b.isFunction(k)){k(o.ErrorCode,o.ErrorString)}return c}b.cancelFrome=2;b.showProgress(o,h,a);o.__bLoadingImage=a;p=o._innerSend(h,g.makeParams(l,n),j,function(){Dynamsoft.Lib.closeProgress(h);o.__bLoadingImage=false;var m=o._UIManager.GetCurrentImageIndex();if(m>=0){o._UIManager.refreshEditor(m,o._UIManager.count());o.OnRefreshUI(m)}r&&r();return true},function(){Dynamsoft.Lib.closeProgress(h);o.__bLoadingImage=false;if(b.isFunction(k)){k(o.ErrorCode,o.ErrorString)}})}else{p=o._innerFun(h,g.makeParams(l,n));if(o.ErrorCode==0){o._HowManyImagesInBuffer=o._innerFun("HowManyImagesInBuffer");o.__cIndex=o._innerFun("CurrentImageIndexInBuffer")}}return p};e.SaveSelectedImagesToBytes=function(j,h){b.Errors.HTML5NotSupport(this);return c};e.LoadImageFromBytes=function(k,h,j){b.Errors.HTML5NotSupport(this);return c};e.UnregisterEvent=function(h,k){var j=["__",h].join("");this[j]=null;return a};e.first=function(){var j=this,h=j._UIManager.count();if(h>0){j._UIManager.Go(0);g.__innerRefreshFromUIView(j,j._UIManager.GetCurrentImageIndex())}return a};e.previous=function(){var j=this,h=j._UIManager.count();if(h>0){j._UIManager.__Previous();g.__innerRefreshFromUIView(j,j._UIManager.GetCurrentImageIndex())}return a};e.next=function(){var j=this,h=j._UIManager.count();if(h>0){j._UIManager.__Next();g.__innerRefreshFromUIView(j,j._UIManager.GetCurrentImageIndex())}return a};e.last=function(){var j=this,h=j._UIManager.count();if(h>0){j._UIManager.Go(h-1);g.__innerRefreshFromUIView(j,j._UIManager.GetCurrentImageIndex())}return a};e.SetCancel=function(j,h){return this._innerSend("SetCancel",null,a,j,h)};e.SetImageWidth=function(h,j){return this._innerFun("SetImageWidth",g.makeParams(h,j))};e.HTTPDownloadStreamThroughPost=function(j,h){b.Errors.HTML5NotSupport(this);return c};e.HTTPUploadStreamThroughPost=function(l,k,h,m,j){b.Errors.HTML5NotSupport(this);return c};e.HTTPUploadThroughPutDirectly=function(l,j,h,m,k){b.Errors.HTML5NotSupport(this);return false};e.SetCustomDSDataEx=function(h){return this._innerFun("SetCustomDSDataEx",g.makeParams(h))};e.SetCustomDSData=function(h){var j=g.replaceLocalFilename(h);return this._innerFun("SetCustomDSData",g.makeParams(j))};e.GetCustomDSDataEx=function(){return this._innerFun("GetCustomDSDataEx")};e.GetCustomDSData=function(h){var j=g.replaceLocalFilename(h);return this._innerFun("GetCustomDSData",g.makeParams(j))};e.ChangeBitDepth=function(j,h,k){return this._innerFun("ChangeBitDepth",g.makeParams(j,h,k))};e.ConvertToGrayScale=function(h){return this._innerFun("ConvertToGrayScale",g.makeParams(h))};e.ShowImageEditorEx=function(j,n,h,m,k){var l=this;return l._UIManager.ShowImageEditorEx(j,n,h,m,k)};e.ClearTiffCustomTag=function(){return this._innerFun("ClearTiffCustomTag")};e.SetTiffCustomTag=function(j,h,k){return this._innerFun("SetTiffCustomTag",g.makeParams(j,h,k))};e.IsBlankImage=function(h){return this._innerFun("IsBlankImage",g.makeParams(h,c))};e.IsBlankImageExpress=function(h){return this._innerFun("IsBlankImage",g.makeParams(h,a))};e.GetVersionInfoAsync=function(j,h){return this._innerSend("VersionInfo",null,a,j,h)};e.SetOpenSourceTimeout=function(h){return this._innerFun("SetOpenSourceTimeout",g.makeParams(h))};e.GetLicenseInfo=function(){var j=this,h;if(!j.__licenseInfo){if(g.isHttpServerInvalid(j)){return c}var h=j._innerFunRaw("GetLicenseInfo",null,c,c,a);if(h&&!h.exception){j.__licenseInfo=h}}return j.__licenseInfo};e.GetImageURL=function(o,j,h,s){var n=this,p=o,q=parseInt(j),m=parseInt(h),r,k,l;if(s){r="";k="dwt://"}else{r=n.httpUrl;k="dwt/"}l=[r,k,"dwt_",d.Trial?"trial_":"",b.replaceAll(d.ServerVersionInfo,",",""),"/img?id=",n.clientId];if(b.isUndefined(p)||p===null){b.Errors.IndexNullOrUndefined(n);return""}p=parseInt(p);if(isNaN(p)){b.Errors.InvalidIndex(n);return""}if(p<0||p>=n.HowManyImagesInBuffer){b.Errors.IndexOutOfRange(n);return""}l.push("&index=");l.push(p);if(q>0&&m>0){l.push("&width=");l.push(q);l.push("&height=");l.push(m)}l.push("&t=");l.push(new Date().getTime());return l.join("")};e.SetLanguage=function(h){return this._innerFun("SetLanguageForSecurity",g.makeParams(h))};e.GetImagePartURL=function(h,j,k){return this.GetImageURL(h,j,k,!0)}})(Dynamsoft.Lib);(function(a){if(!a.product.bChromeEdition){return}a.html5.___ii=0;var b=a.html5.Funs2={getImageUrl:function(l,o,k,n){var m=[l];if(o!==undefined&&o!==null){m.push("&index=");m.push(o)}m.push("&width=");m.push(k);m.push("&height=");m.push(n);m.push("&ticks=");m.push(a.html5.___ii++);return m.join("")},getUrlByAct:function(l,n,k){var m=[l];if(n!==undefined&&n!==null){m.push("&index=");m.push(n)}if(k){m.push("&act=");m.push(k)}m.push("&ticks=");m.push(a.html5.___ii++);return m.join("")},output:function(l,k){if(Dynamsoft.WebTwainEnv.Debug){a.log(k)}},print:function(u){var k,A=850,r=1120,z=0;var o=0,l=0,y="";if(a.product.bChromeEdition){if(a.env.bIE){r=1289}if(a.env.bFirefox){r=1169}}var n=r;for(z=0;z<u.length;z++){var t=u[z];var w=t.Width;var m=t.Height;var q=t.Url;var v=A/w,s=n/m;if(v<s){n=parseInt(m*v)}else{if(v>s){A=parseInt(w*s)}}o+=w;l+=m;y=y+'<div style="width:850px;height:'+r+'px"> <img id="D_img'+z+'" src="'+q+'" style="position:relative;left:0px;top:0px;width: '+A+"px;height: "+n+'px" /></div>'}var C,x=["alwaysRaised=yes,z-look=yes,top=0,left=0,toolbar=no,menubar=no,location=no,status=no,width=",o,",height=",l].join(""),k='<html><body id="D_img">'+y+"</body></html>";var B=window.open("about:blank","_blank",x);if(B){B.document.write(k);B.document.close();B.focus();C=B.document.getElementById("D_img");if(C){C.onload=function(){B.print();B.close();a.log("print image...ok")}}else{a.log("cannot find image")}}}};var g=a.DOM,e=Dynamsoft.WebTwainEnv,f={getServerImageUrlPrefix:function(n){var l=n.httpUrl,k=false,m=[l,"dwt/dwt_",e.Trial?"trial_":"",a.replaceAll(e.ServerVersionInfo,",",""),"/img?id=",n.clientId];return m.join("")},output:function(k){if(Dynamsoft.WebTwainEnv.Debug){a.log(k)}}};function j(k,l){var m=this;m._stwain=k;m.__SelectionImageBorderColor=8233678;m.__BackgroundColor=16777215;m.__BackgroundFillColor=16777215;m.__Ratio=0;l.aryModelImageControl=[];l.OnTopImageInTheViewChanged=function(n){if(Dynamsoft.Lib.isFunction(k.__OnTopImageInTheViewChanged)){k.__OnTopImageInTheViewChanged(n)}};l.OnGetImageInfo=function(p){var n=-1,o=-1;n=m.GetImageWidth(p);return{width:n,height:o}};if(k._bNoUI){m._UIView=new a.UI.FakeView(l)}else{if(a.UI.ImageUIView){m._UIView=new a.UI.ImageUIView(l)}else{k._bNoUI=true;m._UIView=new a.UI.FakeView(l)}}m._UIEditor=false}var d=j.prototype;d.getTwain=function(){var k=this;return k._stwain};d.getView=function(){var k=this;return k._UIView};d.OnReady=function(){var l=this,k=l.getView();k.BaseUrl=f.getServerImageUrlPrefix(l._stwain);return true};d.count=function(){var l=this,k=l.getView();return k.HowManyImagesInBuffer()};d.clear=function(){var l=this,k=l.getView();return k.RemoveAllImages()};d.GetCurrentImageIndex=function(){var l=this,k=l.getView();return k.GetCurrentImageIndex()};d.GetSelectedImageIndex=function(l){var k=this.GetSelectedIndexes();if(l>=0&&l<k.length){return k[l]}return -1};d.GetSelectedIndexes=function(){var l=this,k=l.getView();return k.GetSelectedIndexes()};d.add=function(m,n,l){var o=this,k=o.getView();return k.AddImage(m,n,l)};d.remove=function(m,l){var n=this,k=n.getView();return k.RemoveImage(m,l)};d.MoveImage=function(m,l){var n=this,k=n.getView();return k.MoveImage(m,l)};d.SwitchImage=function(m,l){var n=this,k=n.getView();return k.SwitchImage(m,l)};d.GetImageWidth=function(o){var r=this,p=o*1,l,m,q,n,k;m=r.getView();q=m.GetDataImageControlList();l=q.length;if(p<0||p>l){return 0}n=q[p];if(n&&n.rawWidth){k=n.rawWidth}else{k=r._stwain.GetImageWidth(p)}return k};d.get=function(m){var p=this,n=parseInt(m),k,l,o;l=p.getView();o=l.GetDataImageControlList();k=o.length;if(n<0||n>k){return false}return o[n]};d.refresh=function(l,m,k,q){var n=this;if(k){var o=l*1,p,t,r,s;t=n.getView();r=t.GetDataImageControlList();p=r.length;if(o<0||o>p){return false}if(n._UIEditor&&n._UIEditor._UIView){n._UIEditor.refresh(o)}t.SetDataImageControl(o,q)}return true};d.refreshEditor=function(k,l){var m=this;if(m._UIEditor){m._UIEditor.refresh(k)}return true};d.Go=function(l){var m=this,k=m.getView();return k.Go(l)};d.__Next=function(){var l=this,k=l.getView();return k.__Next()};d.__Previous=function(){var l=this,k=l.getView();return k.__Previous()};d.SetSelectedImageCount=function(l){var m=this,k=m.getView();return k.SetSelectedImageCount(l)};d.SetSelectedImageIndex=function(m,l){var n=this,k=n.getView();return k.SetSelectedImageIndex(m,l)};d.GetZoom=function(){var l=this,k=l.getView();return k.GetZoom()};d.SetZoom=function(l){var m=this,k=m.getView();return k.SetZoom(l)};d.PrintCurrent=function(){var p=this,l=p.getView();if(l.cCurrentIndex<0){return}var m=b.getImageUrl(l.BaseUrl,l.cCurrentIndex,-1,-1);var k=p.aryModelImageControl[l.cCurrentIndex];var o=[];var n=new a.UI.PrintUrl(m,k.imageWidth,k.imageHeight);o.push(n);b.print(o);return true};d.Print=function(){var p=this,l=p.getView();if(l.cCurrentIndex<0){return}var o=[];for(i=0;i<p.aryModelImageControl.length;i++){var m=b.getImageUrl(l.BaseUrl,i,-1,-1);var k=p.aryModelImageControl[i];var n=new a.UI.PrintUrl(m,k.imageWidth,k.imageHeight);o.push(n)}b.print(o);return true};d._isNoUI=function(){var k=this;if(k._stwain._bNoUI){f.output("warning: cannot find UI.")}return k._stwain._bNoUI};d.ChangeSize=function(l,m){var n=this,k=n.getView();return k.ChangeImageViewSize(l,m)};d.SetViewMode=function(m,l){var n=this,k;if(n._isNoUI()){return}k=n.getView();return k.SetViewMode(m,l)};d.ShowImageEditorEx=function(r,q,m,l,o){var p=this;if(p._isNoUI()){return}var n,u,t=document,k,s,v;v=p.getView();k=t.createElement("div");t.body.appendChild(k);s={Container:a.one(k),aryModelImageControl:v.GetDataImageControlList(),BaseUrl:v.BaseUrl,cIndex:v.cCurrentIndex,stwain:p.getTwain()};u=new Dynamsoft.Lib.UI.ImageUIEditor(p,s);p._UIEditor=u;u.bShow=false;u.bShow=true;return u.ShowImageEditorEx(r,q,m,l,0)};d.SetSelectionRectAspectRatio=function(m){var p=this,n=m,k,o,l;p.__Ratio=n;if(p._isNoUI()){return true}l=p.getView();return l.SetSelectionRectAspectRatio(n)};d.GetSelectionRectAspectRatio=function(){return this.__Ratio};d.GetSelectionImageBorderColor=function(){return this.__SelectionImageBorderColor};d.SetSelectionImageBorderColor=function(l){var n=this,m=l,k;if(n._isNoUI()){return true}k=n.getView();n.__SelectionImageBorderColor=m;if(Dynamsoft.Lib.isNumber(m)){m=Dynamsoft.Lib.getColor(m)}return k.SetSelectionImageBorderColor(m)};d.GetBackgroundColor=function(){return this.__BackgroundColor};d.SetBackgroundColor=function(m){var p=this,n=m,k,o,l;p.__BackgroundColor=n;if(p._isNoUI()){return true}l=p.getView();if(Dynamsoft.Lib.isNumber(n)){n=Dynamsoft.Lib.getColor(n)}k=a.one("#"+p._stwain._strDWTControlContainerID);if(k){o=k.one(".dynamsoft-dwt-container-box");if(o){o.style("background-color",n)}}return l.SetBackgroundColor(n)};d.GetAllowMultiSelect=function(){var l=this,k=l.getView();if(l._isNoUI()){return false}return k.GetAllowMultiSelect()};d.SetAllowMultiSelect=function(l){var m=this,k=m.getView();if(m._isNoUI()){return true}return k.SetAllowMultiSelect(l)};d.GetFitWindowType=function(){var l=this,k=l.getView();if(l._isNoUI()){return 0}return k.GetFitWindowType()};d.SetFitWindowType=function(l){var m=this,k=m.getView();if(m._isNoUI()){return true}return k.SetFitWindowType(l)};d.GetIfFitWindow=function(){var l=this,k=l.getView();if(l._isNoUI()){return true}return k.GetIfFitWindow()};d.SetIfFitWindow=function(l){var m=this,k=m.getView();if(m._isNoUI()){return true}return k.SetIfFitWindow(l)};d.GetImageMargin=function(){var l=this,k=l.getView();if(l._isNoUI()){return 0}return k.GetImageMargin()};d.SetImageMargin=function(l){var m=this,k=m.getView();if(m._isNoUI()){return true}return k.SetImageMargin(l)};d.GetMouseShape=function(){var l=this,k=l.getView();if(l._isNoUI()){return 0}return k.GetMouseShape()};d.SetMouseShape=function(l){var m=this,k=m.getView();if(m._isNoUI()){return true}return k.SetMouseShape(l)};d.GetShowPageNumber=function(){var l=this,k=l.getView();if(l._isNoUI()){return false}return k.GetShowPageNumber()};d.SetShowPageNumber=function(l){var m=this,k=m.getView();if(m._isNoUI()){return true}return k.SetShowPageNumber(l)};d.GetIfAutoScroll=function(){var l=this,k=l.getView();if(l._isNoUI()){return false}return k.GetIfAutoScroll()};d.SetIfAutoScroll=function(l){var m=this,k=m.getView();if(m._isNoUI()){return true}return k.SetIfAutoScroll(l)};d.OverlayRectangle=function(s,l,o,q,k,m,p){var n=this,r=n.getView();if(n._isNoUI()){return true}return r.OverlayRectangle(s,l,o,q,k,m,p)};d.SetSelectedImageArea=function(n,p,o,m,l){var q=this,k=q.getView();if(q._isNoUI()){return true}return k.SetSelectedImageArea(index,p,o,m,l)};function c(){var k=this;k.bIsDirty=false;k.imageToShow;k.imageWidth=0;k.imageHeight=0;k.rawWidth=0;k.bOriginalImage=false;k.imageUrl;k.iImageControlWidth;k.iImageControlHeight;k.imageIndex=-1;k.aryOverlayRectangleData=[]}c.prototype.Clear=function(){var k=this;if(k.imageToShow){k.imageToShow.onload=undefined;k.imageToShow.src="data:,"}k.imageToShow=false;k.imageUrl="";k.aryOverlayRectangleData=[]};function h(l,k,m){var n=this;n.Url=l;n.Width=k;n.Height=m}a.UI=a.UI||{};a.UI.ImageUIManager=j;a.UI.ModelImageControl=c;a.UI.PrintUrl=h})(Dynamsoft.Lib);(function(a){if(!a.product.bChromeEdition){return}var b=Dynamsoft.WebTwainEnv;a.env.WSVersion="12.0.0";a.env.WSSession=new Date().getTime();a.getHttpUrl=function(c){if(c.ssl){return["https://",c.ip,":",c.port,"/"].join("")}else{return["http://",c.ip,":",c.port,"/"].join("")}};a.getWSUrl=function(e,d,c){if(c){return["wss://",e,":",d].join("")}else{return["ws://",e,":",d].join("")}};a.getWS=function(h,d,c){var j=this,f,g=a.getWSUrl(h,d,c),e=a.product.wsProtocol;if(j.detect.OnCreatWS){j.detect.OnCreatWS(g,e)}if(typeof MozWebSocket!="undefined"){if(e){f=new MozWebSocket(g,e)}else{f=new MozWebSocket(g)}}else{if(e){f=new WebSocket(g,e)}else{f=new WebSocket(g)}}return f};a._init=function(l){var k=Dynamsoft.Lib,f=false,g=k.LS.item("DWT_port"),d=k.LS.item("DWT_ssl"),c=null;k.detect.urls.splice(0);k.detect.cUrlIndex=0;if(l&&a.isLocalIP(l.ip)){f=l.ip}if(f&&g&&d){c={port:g,ssl:(d=="true")}}var h=function(m){if(!c){return true}if(m){if(m.port!=c.port||m.ssl!=c.ssl){return true}}return false};var e;if(k.detect.detectType===1){if(c!==null&&c.ssl){k.detect.urls.push(c)}for(var j in k.detect.ports){e=k.detect.ports[j];if(e.ssl){if(h(e)){k.detect.urls.push(e)}}}}else{if(k.detect.detectType===0){if(c!==null&&!c.ssl){k.detect.urls.push(c)}for(var j in k.detect.ports){e=k.detect.ports[j];if(e.ssl===false){if(h(e)){k.detect.urls.push(e)}}}}else{if(c!==undefined&&c!==null){k.detect.urls.push(c)}for(var j in k.detect.ports){e=k.detect.ports[j];if(h(e)){k.detect.urls.push(e)}}}}e=null};a._reconnect=function(){var j=Dynamsoft.Lib,h,e,d,g;if(j.detect.aryReconnectSTwains.length>0){g=j.detect.aryReconnectSTwains[0]}if(!g||g.__bConnecting){return}g.__bConnecting=true;h=g._ip;d=g._ssl;if(d){e=g._portSSL}else{e=g._port}try{var c=j.getWS(h,e,bSSl);c.onopen=function(){if(c.readyState==1){g._objWS=c;if(!g.bReady){g._OnReady(true)}g.__bConnecting=false;a.detect.hideMask();j.detect.bOK=true}else{if(c.readyState==0){setTimeout(c.onopen,100)}else{g.__bConnecting=false}}};c.onclose=function(){c.onopen=null;g.__bConnecting=false;if(!g.bReady){g.__wsRetry++;if(g.__wsRetry<5){setTimeout(a._reconnect,1000)}else{a.closeProgress("Reconnect");a.Errors.Server_Restarted(g)}}else{a.closeProgress("Reconnect");a.detect.hideMask()}}}catch(f){a.log(f);g.__bConnecting=false;if(!g.bReady){g.__wsRetry++;if(g.__wsRetry<5){setTimeout(a._reconnect,1000)}}else{a.detect.hideMask()}}};a.startWS=function(){var g=a.detect,j;if(!a.product.bChromeEdition){a.appendMessage("This browser is currently not supported. Please try Chrome or Firefox!");return}if(!g.bNoControlEvent){g.showMask()}if(g.OnDetectNext){g.OnDetectNext()}if(g.tryTimes==0&&g.cUrlIndex>0&&g.arySTwains.length>0){if(!g.bNoControlEvent){g.hideMask();if(a.isFunction(g.onNoControl)){var h,c,f;h=g.arySTwains[0];c=h._width;f=h._height;if(c<=0){c=270}if(f<=0){f=350}g.onNoControl(h._strDWTControlContainerID,c,f,h)}g.bNoControlEvent=true}}if(g.cUrlIndex>=g.urls.length){g.cUrlIndex=0;g.tryTimes++}if(g.arySTwains.length>0){j=g.arySTwains[0]}else{g.hideMask();g.bOK=true;return}if(j.bReady){g.arySTwains.splice(0,1);if(g.arySTwains.length<=0){g.hideMask();g.bOK=true}else{setTimeout(a.startWS,100)}return}if(j.__bConnecting){return}j.__bConnecting=true;try{var k=g.urls[g.cUrlIndex],d=a.getWS(a.product.ip,k.port,k.ssl);a.log(["connecting ... [port:",k.port,"]"].join(""));d.onopen=function(){j.__bConnecting=false;if(d.readyState==1){j._objWS=d;if(!j.bReady){j._port=k.port;j._portSSL=k.port;j._ssl=k.ssl;j._OnReady()}g.arySTwains.splice(0,1);if(g.arySTwains.length<=0){g.hideMask();g.bOK=true}else{setTimeout(a.startWS,100)}}else{if(d.readyState==0){setTimeout(d.onopen,100)}else{}}};d.onclose=function(){d.onopen=null;j.__bConnecting=false;if(!j.bReady){g.cUrlIndex++;setTimeout(a.startWS,100)}else{g.hideMask()}}}catch(e){a.log(e);j.__bConnecting=false;if(!j.bReady){g.cUrlIndex++;setTimeout(a.startWS,100)}else{g.hideMask()}}};a.startWSByIP=function(){var h=a.detect,j;if(!a.product.bChromeEdition){a.appendMessage("This browser is currently not supported. Please try Chrome or Firefox!");return}if(!h.bNoControlEvent){h.showMask()}if(h.arySTwainsByIP.length>0){j=h.arySTwainsByIP[0]}else{h.hideMask();h.bOK=true;return}if(j.bReady){h.arySTwainsByIP.splice(0,1);if(h.arySTwainsByIP.length<=0){h.hideMask();h.bOK=true}else{setTimeout(a.startWSByIP,100)}return}if(j.__bConnecting){return}if(j.__wsRetry>0){if(!h.bNoControlEvent){h.hideMask();if(a.isFunction(h.onNoControl)){var c,g;c=j._width;g=j._height;if(c<=0){c=270}if(g<=0){g=350}h.onNoControl(j._strDWTControlContainerID,c,g,j)}h.bNoControlEvent=true}}j.__bConnecting=true;try{var e,d;e=j._ssl?j._portSSL:j._port;d=a.getWS(j._ip,e,j._ssl);a.log(["connecting ... [port:",e,"]"].join(""));d.onopen=function(){j.__bConnecting=false;if(d.readyState==1){j._objWS=d;if(!j.bReady){j._OnReady()}h.arySTwainsByIP.splice(0,1);if(h.arySTwainsByIP.length<=0){h.hideMask();h.bOK=true}else{setTimeout(a.startWSByIP,100)}}else{if(d.readyState==0){setTimeout(d.onopen,100)}else{}}};d.onclose=function(){d.onopen=null;j.__bConnecting=false;if(!j.bReady){j.__wsRetry++;setTimeout(a.startWSByIP,100)}else{h.hideMask()}}}catch(f){a.log(f);j.__bConnecting=false;if(!j.bReady){j.__wsRetry++;setTimeout(a.startWSByIP,100)}else{h.hideMask()}}};a.html5.closeAll=function(){var h,f,k,g,e,d,c;a.dlgProgress=false;a.detect.bOK=false;a.detect.bFirst=true;for(h=a.detect.arySTwains.length-1;h>=0;h--){k=a.detect.arySTwains[h];if(!k){continue}g=k._strDWTControlContainerID;c=false;for(f=0;f<Dynamsoft.WebTwainEnv.Containers.length;f++){e=Dynamsoft.WebTwainEnv.Containers[f];if(!e){continue}d=e.ContainerId;if(g==d){c=true;break}}if(c){k.__unload();a.detect.arySTwains.splice(h,1)}}};a.bio=false;a.progressMessage="";a.dialogShowStatus=false;a.needShowTwiceShowDialog=false;a.dlgProgress=false;a.cancelFrome=0;a.dlgRef=0;a.showProgress=function(l,g,e){var k=l;a.log("showProgress:"+g+",bCancel:"+e);if((a.cancelFrome==0&&k.__IfShowProgressBar==true)||(a.cancelFrome!=0&&k.__IfShowCancelDialogWhenImageTransfer==true)){var j=a.one(".dynamsoft-btnCancel"),c=j&&j[0];if(c){if(e==false){c.style.display="none"}else{c.style.display=""}}if(a.dialogShowStatus==false){if(a.dlgProgress){a.dlgProgress.showModal()}a.dialogShowStatus=true;var d=a.one(".dynamsoft-finalMessage");var n=a.one(".dynamsoft-progressBar"),f=n&&n[0];var h=a.one(".dynamsoft-status");d&&(d.html(""));h&&(h.html("0%"));if(f){if(a.env.bIE){if(f.objProgressBar){f.objProgressBar.setValue(0)}else{f.value=0}}else{f.value=0}}}a.dlgRef++}};a.closeProgress=function(c){a.log("closeProgress:"+c);var d=a.one(".dynamsoft-btnCancel");if(a.needShowTwiceShowDialog==true&&a.cancelFrome==1){if(d){d[0].innerHTML="Cancel"}}else{if(d){d[0].innerHTML="Cancel"}if(a.dialogShowStatus==true){if(a.dlgProgress){a.dlgProgress.close()}a.dialogShowStatus=false}a.needShowTwiceShowDialog=false;a.cancelFrome=0}a.dlgRef--;if(a.dlgRef<=0){a.dlgRef=0}};a.html5.DynamicWebTwain=function(c){var f,d,e;for(d=0;d<a.detect.arySTwains.length;d++){e=a.detect.arySTwains[d];if(e._strDWTControlContainerID==c.containerID){return false}}f=new a.html5.STwain(c);a.detect.arySTwains.push(f);if(a.detect.bFirst){a._init(c)}a.detect.bFirst=false;return f};a.html5.CreateDWTObject=function(c,j,f,k){var g,l,d,e,h;if(!f){d=a.get(c);if(!d){return false}}for(e=0;e<a.detect.arySTwains.length;e++){h=a.detect.arySTwains[e];if(h._strDWTControlContainerID==c){return false}}g={containerID:c,width:300,height:300,onWSReady:k,bNoUI:f};if(!f){if(d.style.width){g.width=d.style.width}if(d.style.height){g.height=d.style.height}}if(j){g.customIP=true;g.ip=j.ip;g.port=j.port;g.portSSL=j.portSSL}l=new a.html5.STwain(g);if(j){a.detect.arySTwainsByIP.push(l);return l}a.detect.arySTwains.push(l);if(a.detect.bFirst){a._init(g)}a.detect.bFirst=false;return l};b.RemoveAllAuthorizations=function(){var e=a.LS.item("DWT_port"),g=a.LS.item("DWT_ssl"),c="http://",d=a.product.ip,f;if(g=="true"){c="https://"}f=[c,d,":",e,"/dwt/dwt_",b.Trial?"trial_":"",a.replaceAll(b.ServerVersionInfo,",",""),"/RemoveAllAuthorizations?t=",a.now()].join("");new a.ajax({method:"GET",url:f,async:true});return true}})(Dynamsoft.Lib);(function(b){if(!b.product.bChromeEdition){return}var a=true,d=false,e={output:function(f){}};function c(f){var g=this;g._maxPosition=0;g._currentPosition=0;g._PagePositionSize=1;g._track=1;g.Horizontal=d;g.Width=16;g.Height=-1;g.Left=0;g.Top=0;g.Right=0+g.Width;g.Bottom=0+g.Height;g.bgColor="#D4D0C8";g.boxOuterBorderLightColor="#D4D0C8";g.boxOuterBorderDarkColor="#404040";g.boxInnerBorderLightColor="#FFFFFF";g.boxInnerBorderDarkColor="#808080";g.arrowColor="#D4D0C8";g.arrowHoverColor="#BBBBBB";g.slideColor="#D4D0C8";g.draggingColor="#BBBBBB";g.hoverColor="#D4D0C8";g.arrowSize=g.Width;g.scrollSize=-1;g.scrollZeroPos=g.arrowSize;g.slideSize=-1;g.minslideSize=18;g.dragging=d;g.mousePos_StartDrag={x:-1,y:-1};g.mousePos_Dragging={x:-1,y:-1};g.mousePos={x:-1,y:-1};g.bFocus=d;g.borderWidth=1;g.borderStyle=0;g.canvas=d;g.bCanvas=d;if(b.product.bChromeEdition){g.bCanvas=a}g.divSlide=d;g.divArrow1=d;g.divArrow2=d;g.bFloatValue=a;g.__init(f)}c.prototype.__changeSizeForData=function(g,f){var h=this;h.Width=g;h.Height=f;if(h.Horizontal){h.scrollSize=h.Width-2*h.Height;h.arrowSize=h.Height}else{h.scrollSize=h.Height-2*h.Width;h.arrowSize=h.Width}h.scrollZeroPos=h.arrowSize;if(h.canvas){h.canvas.width=g;h.canvas.height=f}};c.prototype.__init=function(f){var h=this,g=window.document;if(f.MaxValue){h._maxPosition=f.MaxValue}if(f.Value){h.SetPosition(f.Value)}h.Horizontal=f.Horizontal;h.__changeSizeForData(f.Width,f.Height);if(h.bCanvas){h.canvas=document.createElement("canvas");h.canvas.width=h.Width;h.canvas.height=h.Height}else{h.canvas=document.createElement("div");h.canvas.style.width=h.Width+"px";h.canvas.style.height=h.Height+"px";h.canvas.style.border="1px solid #CCC";h.canvas.style.position="relative";h.divSlide=document.createElement("div");h.divSlide.style.position="absolute";h.divSlide.style.top="0";h.divSlide.style.left="0";h.divArrow1=document.createElement("div");h.divArrow1.style.position="absolute";h.divArrow1.style.top="0";h.divArrow1.style.left="0";h.divArrow2=document.createElement("div");h.divArrow2.style.position="absolute";h.divArrow2.style.top="0";h.divArrow2.style.left="0";h.canvas.appendChild(h.divArrow1);h.canvas.appendChild(h.divSlide);h.canvas.appendChild(h.divArrow2);h.arrowColor="#777";h.arrowSize=12}h.canvas.onselectstart=function(){return d};Dynamsoft.Lib.addEventListener(h.canvas,"mousedown",function(i){h.onMouseDown(i);b.stopPropagation(i)});Dynamsoft.Lib.addEventListener(h.canvas,"mouseenter",function(i){h.bFocus=a});Dynamsoft.Lib.addEventListener(h.canvas,"mouseleave",function(i){h.bFocus=d});h.onValueChanged=f.onValueChanged};c.prototype.InitScroll=function(f,g){var i=this,h=0;if(f>=g&&g>=0){i._PagePositionSize=g;h=(f-g);i.SetMaxPosition(h);return a}return d};c.prototype.GetPagePositionSize=function(){var f=this;return f._PagePositionSize};c.prototype.SetPagePositionSize=function(f){var g=this;g._PagePositionSize=f;return a};c.prototype.__getCurrentPage=function(){var f=this;return f._currentPosition/f._PagePositionSize};c.prototype.GetMaxPage=function(){var f=this;return f._maxPosition/f._PagePositionSize-1};c.prototype.GetCurrentPosition=function(){var f=this;return f._currentPosition};c.prototype.SetPosition=function(f){var h=this,g=f;if(b.isUndefined(f)||b.isNaN(f)){f=0}if(g<0){g=0}else{if(g>h._maxPosition){g=h._maxPosition}}h._currentPosition=g};c.prototype.GetEL=function(){return this.canvas};c.prototype.Refresh=function(){this.__drawScroll();return a};c.prototype.ChangeControlSize=function(g,f){var h=this;h.__changeSizeForData(g,f);h.__drawFrame();h.__drawScroll()};c.prototype.GetControlHeight=function(){return this.Height};c.prototype.GetControlWidth=function(){return this.Width};c.prototype.onMouseDown=function(r){var l=this,n=r.target,i=d,h,p,j,q,k,m,o;if(n==l.canvas||n==l.divArrow1||n==l.divArrow2){if(n==l.canvas){h=b.DOM.getOffset(r);e.output("mouse down"+h.x+" "+h.y);if(l.Horizontal){m=h.x}else{m=h.y}}else{if(n==l.divArrow1){m=0}else{if(n==l.divArrow2){m=l.scrollSize+l.arrowSize}}}if(m<=l.arrowSize){o=l._currentPosition;l.__click_previous();if(o!=l._currentPosition){l.__fireEvent("onValueChanged",{Value:l._currentPosition,EventName:"onPrevious"})}}else{if(m>=l.scrollSize+l.arrowSize){o=l._currentPosition;l.__click_next();if(o!=l._currentPosition){l.__fireEvent("onValueChanged",{Value:l._currentPosition,EventName:"onNext"})}}else{o=l._currentPosition;p=l.__getPosDirection(h.x,h.y);if(p<0){l.PageUp();if(o!=l._currentPosition){l.__fireEvent("onValueChanged",{Value:l._currentPosition,EventName:"onPageUp"})}}else{if(p>0){l.PageDown();if(o!=l._currentPosition){l.__fireEvent("onValueChanged",{Value:l._currentPosition,EventName:"onPageDown"})}}else{i=a}}}}}else{if(n==l.divSlide){h=b.DOM.getOffset(r);p=0;i=a;e.output("mouse down"+h.x+" "+h.y)}}if(i){l.dragging=a;l.canvas.style.cursor="default";l.mousePos_StartDrag.x=h.x;l.mousePos_StartDrag.y=h.y;l.mousePos_Dragging.x=h.x;l.mousePos_Dragging.y=h.y;var g,f,s=r||event;disX=s.clientX;disY=s.clientY;if(l.canvas.setCapture){g=l.canvas;l.canvas.setCapture()}else{g=document}onMouseMove=function(v){var u=v||event,w={x:0,y:0};w.x=l.mousePos_StartDrag.x+u.clientX-disX;w.y=l.mousePos_StartDrag.y+u.clientY-disY;e.output("onMouseMove: "+w.x+" "+w.y);if(l.dragging){var t=l.__caculateDraggingNewPosition(w.x,w.y);if(t!=l._currentPosition){l.SetPosition(t);l.__fireEvent("onValueChanged",{Value:l._currentPosition,EventName:"onMouseMoving"})}l.__drawScroll("mousemove")}};onMouseUp=function(v){var u=v||event,w={x:0,y:0};w.x=l.mousePos_StartDrag.x+u.clientX-disX;w.y=l.mousePos_StartDrag.y+u.clientY-disY;e.output("onMouseUp: "+w.x+" "+w.y);if(l.canvas.releaseCapture){l.canvas.releaseCapture()}Dynamsoft.Lib.removeEventListener(g,"mouseup",onMouseUp);Dynamsoft.Lib.removeEventListener(g,"mousemove",onMouseMove);if(l.dragging){var t=l.__caculateDraggingNewPosition(w.x,w.y);if(t!=l._currentPosition){l.SetPosition(t);l.__drawScroll();l.__fireEvent("onValueChanged",{Value:l._currentPosition,EventName:"onMouseUp"})}l.dragging=d;l.mousePos_StartDrag.x=-1;l.mousePos_StartDrag.y=-1}};Dynamsoft.Lib.addEventListener(g,"mouseup",onMouseUp);Dynamsoft.Lib.addEventListener(g,"mousemove",onMouseMove);l.__drawScroll("mousedown")}};c.prototype.GetScrollDelta=function(g){var i=this,f,h;f=i.__caculateSlideSize();h=g*f;return h};c.prototype.ManualMoving=function(h){var g=this,f;e.output("ManualMoving: "+[g._currentPosition,h].join(","));if(b.isUndefined(h)||b.isNaN(h)||b.isUndefined(g._currentPosition)||b.isNaN(g._currentPosition)){return}f=g._currentPosition;g.SetPosition(g._currentPosition+h);if(f!=g._currentPosition){g.__fireEvent("onValueChanged",{Value:g._currentPosition,EventName:"onMouseMoving"})}g.__drawScroll("mousemove")};c.prototype.ManualMovingScroll=function(j){var i=this,h=0,f,g;g=i._currentPosition;f=i.__caculateSlideSize();h=i._currentPosition+(i._PagePositionSize*j/f);e.output("ManualMovingScroll: "+[j,f,j/f,i._currentPosition,h].join(","));i.SetPosition(h);if(g!=i._currentPosition){i.__fireEvent("onValueChanged",{Value:i._currentPosition,EventName:"onMouseMoving"})}i.__drawScroll("mousemove")};c.prototype.handlerKeyDown=function(g){var i=this,f=a,h;if(!i.bFocus){return f}h=i._currentPosition;switch(g.keyCode){case 37:if(i.Horizontal){f=d;i.Previous();if(h!=i._currentPosition){i.__fireEvent("onValueChanged",{Value:i._currentPosition,EventName:"onPrevious"})}}break;case 39:if(i.Horizontal){f=d;i.Next();if(h!=i._currentPosition){i.__fireEvent("onValueChanged",{Value:i._currentPosition,EventName:"onNext"})}}break;case 38:if(!i.Horizontal){f=d;i.Previous();if(h!=i._currentPosition){i.__fireEvent("onValueChanged",{Value:i._currentPosition,EventName:"onPrevious"})}}break;case 40:if(!i.Horizontal){f=d;i.Next();if(h!=i._currentPosition){i.__fireEvent("onValueChanged",{Value:i._currentPosition,EventName:"onNext"})}}break;case 33:f=d;i.PageUp();if(h!=i._currentPosition){i.__fireEvent("onValueChanged",{Value:i._currentPosition,EventName:"onPageUp"})}break;case 34:f=d;i.PageDown();if(h!=i._currentPosition){i.__fireEvent("onValueChanged",{Value:i._currentPosition,EventName:"onPageDown"})}break;case 35:f=d;i.GoPosition(i._maxPosition);if(h!=i._currentPosition){i.__fireEvent("onValueChanged",{Value:i._currentPosition,EventName:"onEnd"})}break;case 36:f=d;i.GoPosition(0);if(h!=i._currentPosition){i.__fireEvent("onValueChanged",{Value:0,EventName:"onBegin"})}break;default:break}return f};c.prototype.__click_previous=function(){var g=this,f;e.output("__click_previous from mouse click arrow");g.GoPosition(g._currentPosition-g._track,200);if(g.canvas&&g.bCanvas){f=g.canvas.getContext("2d");g.__redrawUpOrLeftArrow(f,a)}};c.prototype.__click_next=function(){var g=this,f;e.output("__click_next from mouse click arrow");g.GoPosition(g._currentPosition+g._track,200);if(g.canvas&&g.bCanvas){f=g.canvas.getContext("2d");g.__redrawDownOrRightArrow(f,a)}};c.prototype.Previous=function(){var f=this;e.output("previous");f.GoPosition(f._currentPosition-f._track)};c.prototype.Next=function(){var f=this;e.output("next");f.GoPosition(f._currentPosition+f._track)};c.prototype.PageUp=function(){var f=this;e.output("pageUp");f.GoPosition(f._currentPosition-f._PagePositionSize)};c.prototype.PageDown=function(){var f=this;e.output("pageDown");f.GoPosition(f._currentPosition+f._PagePositionSize)};c.prototype.GetMaxPosition=function(){return this._maxPosition};c.prototype.SetMaxPosition=function(f){var g=this;if(b.isUndefined(f)||b.isNaN(f)){g._maxPosition=0;g._currentPosition=0;return}g._maxPosition=f;if(g._maxPosition<0){g._maxPosition=0}if(g._currentPosition<0){g._currentPosition=0}else{if(g._currentPosition>g._maxPosition){g._currentPosition=g._maxPosition}}};c.prototype.GoPage=function(g){var h=this,f;e.output("go page: "+g);f=g*h._PagePositionSize;return h.GoPosition(f)};c.prototype.GoPosition=function(f,h){var i=this,g;e.output("go position: "+f);i.SetPosition(f);if(h&&h>0){setTimeout(function(){i.__drawScroll()},h)}else{i.__drawScroll()}};c.prototype.__drawBoxBorder=function(r,f,l,q,m,o,u){var t=this,k,j,v,n,B,h,z,w,s,g,C;w=Math.floor(f);s=Math.floor(l);if(q<=0||m<=0){return}try{g=Math.floor(q);C=Math.floor(m)}catch(A){return}B=r.getImageData(w,s,g,C);n=B.data;h=t.__getHexColor(o);z=t.__getHexColor(u);v=0;for(k=0;k<g;k++){n[v]=h[0];n[v+1]=h[1];n[v+2]=h[2];v+=4}k=0;for(j=0;j<C;j++){v=(j*g+k)*4;n[v]=h[0];n[v+1]=h[1];n[v+2]=h[2]}for(j=0;j<C;j++){k=g-1;v=(j*g+k)*4;n[v]=z[0];n[v+1]=z[1];n[v+2]=z[2]}v=(C-1)*g*4;for(k=0;k<g;k++){n[v]=z[0];n[v+1]=z[1];n[v+2]=z[2];v+=4}r.putImageData(B,w,s)};c.prototype.__drawUpTriangle=function(z,j,s){var o=this,t,r,m,g,f,q,u=9,n=4,A,v,k,l;A=Math.floor(j);v=Math.floor(s);k=Math.floor(u);l=Math.floor(n);f=z.getImageData(A,v,k,l);g=f.data;for(r=0;r<4;r++){t=4-r;q=t+1+2*r;m=(r*u+t)*4;while(t<q){g[m]=g[m+1]=g[m+2]=0;t++;m+=4}}z.putImageData(f,j,s)};c.prototype.__drawDownTriangle=function(z,j,s){var o=this,t,r,m,g,f,q,u=9,n=4,A,v,k,l;A=Math.floor(j);v=Math.floor(s);k=Math.floor(u);l=Math.floor(n);f=z.getImageData(A,v,k,l);g=f.data;for(r=0;r<4;r++){t=r;q=t+7-2*r;m=(r*u+t)*4;while(t<q){g[m]=g[m+1]=g[m+2]=0;t++;m+=4}}z.putImageData(f,j,s)};c.prototype.__drawLeftTriangle=function(z,j,s){var o=this,t,r,m,g,f,q,u=4,n=7,A,v,k,l;A=Math.floor(j);v=Math.floor(s);k=Math.floor(u);l=Math.floor(n);f=z.getImageData(A,v,k,l);g=f.data;for(r=0;r<n;r++){if(r>3){t=r-3}else{t=3-r}m=(r*u+t)*4;while(t<u){g[m]=g[m+1]=g[m+2]=0;t++;m+=4}}z.putImageData(f,j,s)};c.prototype.__drawRightTriangle=function(v,j,r){var o=this,s,q,m,g,f,t=4,n=7,z,u,k,l;z=Math.floor(j);u=Math.floor(r);k=Math.floor(t);l=Math.floor(n);f=v.getImageData(z,u,k,l);g=f.data;for(q=0;q<n;q++){s=0;if(q>3){max=7-q}else{max=q+1}m=(q*t+s)*4;while(s<max){g[m]=g[m+1]=g[m+2]=0;s++;m+=4}}v.putImageData(f,j,r)};c.prototype.__drawBox=function(t,i,p,f,s,q,o,h,l,r){var m=this,g=0,j,k;if(f<=0||s<=0){return}try{j=Math.floor(f);k=Math.floor(s)}catch(n){return}if(t){t.fillStyle=q;t.fillRect(i,p,j,k);t.lineWidth=m.borderWidth;b.drawBoxBorder(t,i+g,p+g,j-g,k-g,o,h);i+=m.borderWidth;p+=m.borderWidth;j-=2*m.borderWidth;k-=2*m.borderWidth;b.drawBoxBorder(t,i+g,p+g,j-g,k-g,l,r)}else{if(m.divSlide){m.divSlide.style.backgroundColor=q;m.divSlide.style.left=i+"px";m.divSlide.style.top=p+"px";m.divSlide.style.width=j+"px";m.divSlide.style.height=k+"px"}}};c.prototype.__drawBackground=function(t,r,m){var n=this,q,o,l,g,f,u,s,j,k;t.fillStyle=n.bgColor;if(n.Width>0&&n.Height>0){t.fillRect(n.borderWidth,n.borderWidth,n.Width-2*n.borderWidth,n.Height-2*n.borderWidth);u=0;s=0;j=Math.floor(r);k=Math.floor(m);f=t.getImageData(u,s,j,k);g=f.data;for(o=0;o<m;o++){q=(o%2);l=(o*r+q)*4;while(q<r){g[l]=g[l+1]=g[l+2]=255;q+=2;l+=8}}t.putImageData(f,0,0)}};c.prototype.__drawUpButton=function(f,g){var i=this,h;if(g){h=i.arrowHoverColor}else{h=i.arrowColor}if(f){i.__drawBox(f,0,0,i.arrowSize,i.arrowSize,h,i.boxOuterBorderLightColor,i.boxOuterBorderDarkColor,i.boxInnerBorderLightColor,i.boxInnerBorderDarkColor);i.__drawUpTriangle(f,3,6,i.arrowColor)}else{if(i.divArrow1){i.divArrow1.style.top=-i.arrowSize/4+"px";i.divArrow1.style.left=(i.Width-i.arrowSize)/2+"px";i.divArrow1.style.borderStyle="dotted dotted solid";i.divArrow1.style.borderWidth=i.arrowSize/2+"px";i.divArrow1.style.borderColor="transparent transparent "+i.arrowColor;i.divArrow1.style.overflow="hidden"}}};c.prototype.__drawDownButton=function(f,g){var i=this,h;if(g){h=i.arrowHoverColor}else{h=i.arrowColor}if(f){i.__drawBox(f,0,i.Height-i.arrowSize,i.arrowSize,i.arrowSize,h,i.boxOuterBorderLightColor,i.boxOuterBorderDarkColor,i.boxInnerBorderLightColor,i.boxInnerBorderDarkColor);i.__drawDownTriangle(f,4,i.Height-10,i.arrowColor)}else{if(i.divArrow2){i.divArrow2.style.top=i.Height-i.arrowSize*3/4+"px";i.divArrow2.style.left=(i.Width-i.arrowSize)/2+"px";i.divArrow2.style.borderStyle="dotted dotted solid";i.divArrow2.style.borderWidth=i.arrowSize/2+"px";i.divArrow2.style.borderColor=i.arrowColor+" transparent transparent";i.divArrow2.style.overflow="hidden"}}};c.prototype.__drawLeftButton=function(f,g){var i=this,h;if(g){h=i.arrowHoverColor}else{h=i.arrowColor}if(f){i.__drawBox(f,0,0,i.arrowSize,i.arrowSize,h,i.boxOuterBorderLightColor,i.boxOuterBorderDarkColor,i.boxInnerBorderLightColor,i.boxInnerBorderDarkColor);i.__drawLeftTriangle(f,5,4,i.arrowColor)}else{if(i.divArrow1){i.divArrow1.style.top=(i.Height-i.arrowSize)/2+"px";i.divArrow1.style.left=-i.arrowSize/4+"px";i.divArrow1.style.borderStyle="dotted solid dotted dotted";i.divArrow1.style.borderWidth=i.arrowSize/2+"px";i.divArrow1.style.borderColor="transparent "+i.arrowColor+" transparent transparent";i.divArrow1.style.overflow="hidden"}}};c.prototype.__drawRightButton=function(f,g){var i=this,h;if(g){h=i.arrowHoverColor}else{h=i.arrowColor}if(f){i.__drawBox(f,i.Width-i.arrowSize,0,i.arrowSize,i.arrowSize,h,i.boxOuterBorderLightColor,i.boxOuterBorderDarkColor,i.boxInnerBorderLightColor,i.boxInnerBorderDarkColor);i.__drawRightTriangle(f,i.Width-10,4,i.arrowColor)}else{if(i.divArrow2){i.divArrow2.style.top=(i.Height-i.arrowSize)/2+"px";i.divArrow2.style.left=i.Width-i.arrowSize*3/4+"px";i.divArrow2.style.borderStyle="dotted dotted solid dotted";i.divArrow2.style.borderWidth=i.arrowSize/2+"px";i.divArrow2.style.borderColor="transparent transparent transparent "+i.arrowColor;i.divArrow2.style.overflow="hidden"}}};c.prototype.__drawFrame=function(){var h=this,f=d,g=d;if(h.canvas&&h.bCanvas){f=h.canvas.getContext("2d");if(h.Width>0&&h.Height>0){f.clearRect(0,0,h.Width,h.Height)}h.__drawBackground(f,h.Width,h.Height)}h.__redrawUpOrLeftArrow(f,g);h.__redrawDownOrRightArrow(f,g)};c.prototype.__redrawUpOrLeftArrow=function(f,g){var h=this;if(h.Horizontal){h.__drawLeftButton(f,g)}else{h.__drawUpButton(f,g)}};c.prototype.__redrawDownOrRightArrow=function(f,g){var h=this;if(h.Horizontal){h.__drawRightButton(f,g)}else{h.__drawDownButton(f,g)}};c.prototype.__drawScroll=function(l){var m=this,g=0,f,j,k=l||"",h=d,i;if(m._maxPosition>0&&m.canvas){m.canvas.style.display="";j=m.__caculateSlideSize();f=Math.ceil(m.scrollZeroPos+m._currentPosition*j/m._PagePositionSize);e.output("__drawScroll: "+[f,m.__getCurrentPage(),j].join(","));if(m.canvas&&m.bCanvas){h=m.canvas.getContext("2d")}m.__drawFrame();if(k=="mousedown"||k=="mousemove"){i=m.bgColor}else{i=m.bgColor}if(m.Horizontal){m.__drawBox(h,f,0,m.slideSize,m.Height,i,m.boxOuterBorderLightColor,m.boxOuterBorderDarkColor,m.boxInnerBorderLightColor,m.boxInnerBorderDarkColor)}else{m.__drawBox(h,0,f,m.Width,m.slideSize,i,m.boxOuterBorderLightColor,m.boxOuterBorderDarkColor,m.boxInnerBorderLightColor,m.boxInnerBorderDarkColor)}}else{if(m.canvas){m.canvas.style.display="none"}}};c.prototype.__caculateDraggingNewPosition=function(f,l){var k=this,g,i=0,j=0,h;g=k.__caculateSlideSize();slidePos=k.__caculateSlidePos();if(k.Horizontal){startPos=f-k.arrowSize;j=f-k.mousePos_Dragging.x;h=f}else{startPos=l-k.arrowSize;j=l-k.mousePos_Dragging.y;h=l}e.output("__caculateDraggingNewPosition: "+[k._currentPosition,k._PagePositionSize,j,g].join(","));i=k._currentPosition+(k._PagePositionSize*j/g);if(i<0){i=0}if(i>k._maxPosition){i=k._maxPosition}k.mousePos_Dragging.x=f;k.mousePos_Dragging.y=l;return i};c.prototype.__getPosDirection=function(g,j){var i=this,f,h;f=i.__caculateSlidePos();if(i.Horizontal){h=g}else{h=j}if(h<f.start){return -1}else{if(h<=f.end){return 0}else{return 1}}};c.prototype.__caculateSlidePos=function(){var i=this,h={start:0,end:0},g,f;g=i.__caculateSlideSize();f=i.scrollSize+i.arrowSize;h.start=i.__getCurrentPage()*g+i.arrowSize;h.end=h.start+i.slideSize;if(h.end>=f){h.end=f;h.start=f-i.slideSize}return h};c.prototype.__caculateSlideSize=function(){var h=this,f=0,g=0;g=h.scrollSize;if(h._maxPosition>0&&g>0){h.slideSize=g*(h._PagePositionSize/(h._maxPosition+h._PagePositionSize));if(h.slideSize<h.minslideSize){h.slideSize=h.minslideSize;f=(g-h.slideSize)*h._PagePositionSize/(h._maxPosition)}else{f=h.slideSize}}return f};c.prototype.__fireEvent=function(f,g){var h=this;if(b.isFunction(h[f])){return h[f](g)}return a};c.prototype.SetVisible=function(f){var g=this;if(g.canvas){if(f){g.canvas.style.display="";g.__drawFrame();g.__drawScroll()}else{g._maxPosition=0;g._currentPosition=0;g.canvas.style.display="none"}}};c.prototype.GetVisible=function(){var f=this;if(f.canvas){if(f.canvas.style.display=="none"){return d}else{return a}}return d};c.prototype.Destroy=function(){var g=this,f;if(g.canvas&&g.bCanvas&&g.Width>0&&g.Height>0){f=g.canvas.getContext("2d");f.clearRect(0,0,g.Width,g.Height)}g._maxPosition=0;g._currentPosition=0};c.prototype.SetLocation=function(f,h){var g=this;g.Left=f;g.Top=h;g.Right=f+g.Width;g.Bottom=f+g.Height;if(g.canvas){if(g.canvas.parentNode){g.canvas.parentNode.style.position="relative"}g.canvas.style.position="absolute";g.canvas.style.left=f+"px";g.canvas.style.top=h+"px"}};Dynamsoft.Lib.UI=Dynamsoft.Lib.UI||{};Dynamsoft.Lib.UI.ScrollBar=c})(Dynamsoft.Lib);(function(b){if(!b.product.bChromeEdition){return}var a=true,c=false,d={output:function(f){}};function e(f){var g=this;g.__controlWidth=0;g.__controlHeight=0;g.drawWidth=0;g.drawHeight=0;g.Left=0;g.Top=0;g.Right=0;g.Bottom=0;g.imageControl=f;g.__mousedownStatus=0;g.mouse_zero_x=-1;g.mouse_zero_y=-1;g.mouse_x=0;g.mouse_y=0;g.selectedCanvasArea={left:0,top:0,right:0,bottom:0};g.canvas=c;g.lastClick=c;g.bCanvas=c;if(b.product.bChromeEdition){g.bCanvas=a}}e.prototype.GetEL=function(){var f=this;if(!f.canvas){f.canvas=document.createElement("canvas");f.canvas.style.position="absolute";f.canvas.style.left="0";f.canvas.style.top="0"}return f.canvas};e.prototype.ChangeControlSize=function(g,f){var i=this,h;i.__controlWidth=g;i.__controlHeight=f;if(i.canvas){if(i.bCanvas){i.canvas.width=i.__controlWidth;i.canvas.height=i.__controlHeight}else{i.canvas.style.width=i.__controlWidth;i.canvas.style.height=i.__controlHeight}}};e.prototype.SetDrawImageLocationAndSize=function(i,h,g,f){var j=this;d.output("SetLocationAndSize: "+[i,h,g,f].join(","));j.drawWidth=g;j.drawHeight=f;j.Left=i;j.Top=h;j.Right=j.Left+j.drawWidth;j.Bottom=j.Top+j.drawHeight};e.prototype.__fireEvent=function(f,g){var h=this;if(b.isFunction(h[f])){return h[f](g)}return true};e.prototype.__MouseShapeIsHand=function(){var f=this;return f.imageControl.iMouseShape==EnumDWT_MouseShape.Hand};e.prototype.__MouseShapeIsZoom=function(){var f=this;return f.imageControl.iMouseShape==EnumDWT_MouseShape.Zoom};e.prototype.__GetSelectionRectAspectRatio=function(){var f=this;return f.imageControl.__fSelectionRectAspectRatio};e.prototype.__restoreCanvas=function(g,f,i){var j=this;if(g){g.canvas.width=f;g.canvas.height=i}};e.prototype.__draw_dashRect=function(g,l,f,m){var j=this,o=j.canvas.getContext("2d"),k=j.drawWidth,q=j.drawHeight,p=g,n=l,h=f,i=m;if(!j.canvas){return}d.output("__select_rect: "+[g,l,f,m].join(","));if(h<0){}if(h>k){h=k}if(i<0){}if(i>q){i=q}if(p<0){p=0}else{if(p+h>k){h=k-p}}if(n<0){n=0}else{if(n+i>q){i=q-n}}o=j.canvas.getContext("2d");j.__restoreCanvas(o,o.canvas.width,o.canvas.height);if(h>0&&i>0){o.__dashedLineRect(p+j.Left,n+j.Top,h,i)}};e.prototype.SetSelectedArea=function(h,p,q,g,j){var n=this,s=n.canvas.getContext("2d"),u,r,f,m,i,k,o=n.drawWidth,t=n.drawHeight,l=false;d.output("SetSelectedArea: "+[h,p,q,g].join(","));if(!n.canvas){return false}if(h<q){u=h;f=q}else{u=q;f=h}if(p<g){r=p;m=g}else{r=g;m=p}if(u<0){u=0}if(r<0){r=0}i=f-u;k=m-r;if(i>o){i=o;f=u+i}if(k>t){k=t;m=r+k}if(h>o||p>t){l=true}else{if(Math.abs(i)+Math.abs(k)<=5){l=true}}if(l){u=n.selectedCanvasArea.left;r=n.selectedCanvasArea.top;f=n.selectedCanvasArea.right;m=n.selectedCanvasArea.bottom;if(u==0&&r==0&&f==0&&m==0){}else{n.selectedCanvasArea.left=0;n.selectedCanvasArea.top=0;n.selectedCanvasArea.right=0;n.selectedCanvasArea.bottom=0;n.__restoreCanvas(s,s.canvas.width,s.canvas.height);if(j){n.__fireEvent("onImageAreaDeSelected")}}}else{n.selectedCanvasArea.left=u;n.selectedCanvasArea.top=r;n.selectedCanvasArea.right=f;n.selectedCanvasArea.bottom=m;n.__draw_dashRect(u,r,i,k);if(j&&(n.__mousedownStatus==0)){n.__fireEvent("onImageAreaSelected",{left:u,top:r,right:f,bottom:m,fromScroll:false})}}return true};e.prototype.ReFireSelectedEventWhenImageMoved=function(){var j=this,g,h,i,f;g=j.selectedCanvasArea.left;h=j.selectedCanvasArea.top;i=j.selectedCanvasArea.right;f=j.selectedCanvasArea.bottom;if(g!=0&&h!=0&&i!=0&&f!=0){j.__fireEvent("onImageAreaSelected",{left:g,top:h,right:i,bottom:f,fromScroll:true})}};e.prototype.SetMouseShape=function(j){var l=this,f,h,i,k,g;if(l.canvas){f=l.canvas.getContext("2d");if(j==EnumDWT_MouseShape.Hand){l.canvas.style.cursor="pointer";h=l.selectedCanvasArea.left;i=l.selectedCanvasArea.top;k=l.selectedCanvasArea.right;g=l.selectedCanvasArea.bottom;if(h==0&&i==0&&k==0&&g==0){}else{l.SetSelectedArea(0,0,0,0,true)}}else{if(j==EnumDWT_MouseShape.Crosshair){l.canvas.style.cursor="crosshair"}else{if(j==EnumDWT_MouseShape.Zoom){if(b.env.bIE){l.canvas.style.cursor=""}else{l.canvas.style.cursor="zoom-in"}}else{l.canvas.style.cursor=""}}}}};e.prototype.Destroy=function(){var j=this,i;d.output("Destroy:");if(j.canvas){var f=j.canvas.getContext("2d");if(j.__controlWidth>0&&j.__controlHeight>0){f.clearRect(0,0,j.__controlWidth,j.__controlHeight)}i=j.canvas.parentNode;if(i){i.removeChild(j.canvas)}}var h=Dynamsoft.Lib.UI.ImageAreaSelectorEvt,g=h.indexOf(j);if(g>=0){h.splice(g,1)}};e.prototype.__movingRect=function(){};e.prototype.__funReSelectArea=function(n){var k=this,p,o,f,j,m,g=true;p=k.mouse_zero_x;o=k.mouse_zero_y;f=k.mouse_x;j=k.mouse_y;m=k.__GetSelectionRectAspectRatio();if(m>0){var i,h,l=1;if(m<1){h=j-o;i=h*m;if(f>p&&j>o||f<p&&j<o){f=p+i;l=-1}else{if(f>p&&j<o||f<p&&j>o){f=p-i}}if(f>k.drawWidth||f<0){if(f>k.drawWidth){f=k.drawWidth}else{if(f<0){f=0}}i=l*(p-f);h=i/m;j=o+h}}else{i=f-p;h=i/m;if(f>p&&j>o||f<p&&j<o){j=o+h;l=-1}else{if(f>p&&j<o||f<p&&j>o){j=o-h}}if(j>k.drawHeight||j<0){if(j>k.drawHeight){j=k.drawHeight}else{if(j<0){j=0}}h=l*(o-j);i=h*m;f=p+i}}}k.SetSelectedArea(p,o,f,j,true)};e.prototype.BindEvents=function(){var g=this,f;f=g.canvas.getContext("2d");Dynamsoft.Lib.UI.ImageAreaSelectorEvt.push(g);Dynamsoft.Lib.addEventListener(g.canvas,"mousemove",function(i){var h;h=b.DOM.getOffset(i,g);if(h.x<0){h.x=0}else{if(h.x>g.drawWidth){h.x=g.drawWidth}}if(h.y<0){h.y=0}else{if(h.y>g.drawHeight){h.y=g.drawHeight}}if(g.__mousedownStatus){if(h.x==g.mouse_zero_x&&h.y==g.mouse_zero_y){return}}g.mouse_x=h.x;g.mouse_y=h.y;g.__fireEvent("onMouseMove",{e:i,dragging:(g.__mousedownStatus!=0),x:h.x,y:h.y,origX:g.mouse_zero_x,origY:g.mouse_zero_y});if(!g.__MouseShapeIsHand()){if(g.__mousedownStatus){g.__funReSelectArea()}}});Dynamsoft.Lib.addEventListener(g.canvas,"mousedown",function(k){var j,i=new Date(),h;g.__mousedownStatus=1;if(g.lastClick){h=i.getTime()-g.lastClick.getTime()}g.lastClick=i;j=b.DOM.getOffset(k,g);if(j.x<0){j.x=0}else{if(j.x>g.drawWidth){j.x=g.drawWidth}}if(j.y<0){j.y=0}else{if(j.y>g.drawHeight){j.y=g.drawHeight}}d.output("click on selector canvase: "+[j.x,j.y].join(","));g.SetSelectedArea(0,0,0,0,true);g.mouse_zero_x=parseInt(j.x);g.mouse_zero_y=parseInt(j.y);if(h<500){g.__fireEvent("onMouseDoubleClick",{e:k,x:j.x,y:j.y});g.lastClick=false}else{if(k.which?k.which==3:k.button==2){g.__fireEvent("onMouseRightClick",{e:k,x:j.x,y:j.y})}else{g.__fireEvent("onMouseClick",{e:k,x:j.x,y:j.y})}}b.stopPropagation(k)});Dynamsoft.Lib.addEventListener(g.canvas,"mouseup",function(k){var i;if(g.mouse_zero_x<0&&g.mouse_zero_y<0){g.__mousedownStatus=0;g.mouse_zero_x=-1;g.mouse_zero_y=-1;return}i=b.DOM.getOffset(k,g);if(i.x<0){i.x=0}else{if(i.x>g.drawWidth){i.x=g.drawWidth}}if(i.y<0){i.y=0}else{if(i.y>g.drawHeight){i.y=g.drawHeight}}g.mouse_x=i.x;g.mouse_y=i.y;g.__mousedownStatus=0;if(g.__MouseShapeIsHand()){g.__restoreCanvas(f,f.canvas.width,f.canvas.height)}else{if(g.__MouseShapeIsZoom()){if(Math.abs(j)<3&&Math.abs(h)<3){g.__fireEvent("onZoom",{e:k,x:i.x,y:i.y,out:false})}else{var m,l;m=(i.x+g.mouse_zero_x)/2;l=(i.y+g.mouse_zero_y)/2;g.__fireEvent("onZoom",{e:k,x:m,y:l,out:false});g.__funReSelectArea()}}else{var j=i.x-g.mouse_zero_x,h=i.y-g.mouse_zero_y;if(Math.abs(j)<3&&Math.abs(h)<3){}else{g.__funReSelectArea();g.__fireEvent("onMouseUp",{e:k,x:i.x,y:i.y,out:false})}}}g.mouse_zero_x=-1;g.mouse_zero_y=-1;b.stopPropagation(k)})};e.prototype.__InvokeMouseUpOutside=function(i){var j=this;var g;if(j.mouse_zero_x<0&&j.mouse_zero_y<0){j.__mousedownStatus=0;j.mouse_zero_x=-1;j.mouse_zero_y=-1;return}g=b.DOM.getOffset(i,j);if(g.x<0){g.x=0}else{if(g.x>j.drawWidth){g.x=j.drawWidth}}if(g.y<0){g.y=0}else{if(g.y>j.drawHeight){g.y=j.drawHeight}}if(j.__mousedownStatus){j.__mousedownStatus=0;if(!j.__MouseShapeIsHand()){var h=g.x-j.mouse_zero_x,f=g.y-j.mouse_zero_y;if(Math.abs(h)<3&&Math.abs(f)<3){}else{j.__funReSelectArea(true)}}}j.mouse_zero_x=-1;j.mouse_zero_y=-1;j.__fireEvent("onMouseUp",{e:i,x:-1,y:-1,out:true})};e.prototype.__isInSelectedArea=function(k){var j=this,g,h,i,f;g=j.selectedCanvasArea.left;h=j.selectedCanvasArea.top;i=j.selectedCanvasArea.right;f=j.selectedCanvasArea.bottom;d.output("__deselectWhenMouseClick: "+[k.x,k.y,j.selectedCanvasArea.left,j.selectedCanvasArea.top,j.selectedCanvasArea.right,j.selectedCanvasArea.bottom].join(","));if(g==0&&h==0&&i==0&&f==0){return false}if((k.x>=g&&k.x<=i)&&(k.y>=h&&k.y<=f)){return true}return false};Dynamsoft.Lib.UI=Dynamsoft.Lib.UI||{};Dynamsoft.Lib.UI.ImageAreaSelector=e;Dynamsoft.Lib.UI.ImageAreaSelectorEvt=[];Dynamsoft.Lib.addEventListener(window,"mouseup",function(f){var g=Dynamsoft.Lib.UI.ImageAreaSelectorEvt;for(var h=0;h<g.length;h++){g[h].__InvokeMouseUpOutside(f)}})})(Dynamsoft.Lib);(function(a){if(!a.product.bChromeEdition){return}CanvasRenderingContext2D.prototype.__dashedLineRect=function(n,j,c,o,f){if(typeof f==="undefined"){f=3}var l=[n,n,n+c,n];var k=[j,j,j,j+o];var m=[n+c,n,n+c,n+c];var h=[j,j+o,j+o,j+o];for(var d=0;d<4;d++){var s=(m[d]-l[d]);var q=(h[d]-k[d]);var b=Math.floor(Math.sqrt(s*s+q*q));var g=(f<=0)?b:(b/f);var p=(q/b)*f;var r=(s/b)*f;this.beginPath();for(var e=0;e<g;e++){if(e%2){this.lineTo(l[d]+e*r,k[d]+e*p)}else{this.moveTo(l[d]+e*r,k[d]+e*p)}}this.stroke()}}})(Dynamsoft.Lib);(function(a){if(!a.product.bChromeEdition){return}var c={output:function(d){}};function b(d){var e=this;e.MaxWidth=-1;e.MaxHeight=-1;e.fZoomValue=-1;e.ctx=false;e.left=-1;e.top=-1;if(d){e.MaxWidth=d.MaxWidth;e.MaxHeight=d.MaxHeight;e.fZoomValue=d.fZoomValue;e.ctx=d.ctx;e.left=d.left;e.top=d.top}e.aryOverlayInfo=[]}b.prototype.SetContext=function(d){this.ctx=d};b.prototype.SetLocation=function(d,f){var e=this;e.left=d;e.top=f};b.prototype.SetImageSize=function(d,e){var f=this;f.MaxWidth=d;f.MaxHeight=e};b.prototype.SetZoom=function(d){var e=this;e.fZoomValue=d};b.prototype.Add=function(i,h,l,f,e,g,d){var j=this,k;k={l:i,t:h,r:l,b:f,c:e,o:g};j.aryOverlayInfo.push(k);if(d){j.__drawOne(k)}return true};b.prototype.Clear=function(){var d=this;d.aryOverlayInfo.splice(0)};b.prototype.Destroy=function(){var d=this;d.ctx=false;d.Clear()};b.prototype.Draw=function(){var g=this,f,d,e;if(g.ctx){f=g.aryOverlayInfo.length;for(d=0;d<f;d++){e=g.aryOverlayInfo[d];g.__drawOne(e)}}};b.prototype.__drawOne=function(m){var l=this,j,h,n,f,e,d,g,k,i;if(!l.ctx){return}j=m.l;h=m.t;n=m.r;f=m.b;g=m.c;k=m.o;if(j<0){j=0}if(h<0){h=0}if(n>l.MaxWidth){n=l.MaxWidth}if(f>l.MaxHeight){f=l.MaxHeight}j*=l.fZoomValue;h*=l.fZoomValue;n*=l.fZoomValue;f*=l.fZoomValue;e=n-j;d=f-h;if(Dynamsoft.Lib.isNumber(g)){g=Dynamsoft.Lib.getColor(g)}i=l.ctx.globalAlpha;l.ctx.fillStyle=g;l.ctx.globalAlpha=parseFloat(k);l.ctx.fillRect(l.left+j,l.top+h,e,d);l.ctx.globalAlpha=i};Dynamsoft.Lib.UI=Dynamsoft.Lib.UI||{};Dynamsoft.Lib.UI.ImageOverlay=b})(Dynamsoft.Lib);(function(c){if(!c.product.bChromeEdition){return}var b=true,d=false,e={isNaNOrUndefined:function(f){return c.isUndefined(f)||c.isNaN(f)},getAdjustedImageSize:function(n,i,o,j){var l={w:n,h:i,zoom:1},f=Math.floor(o+0.5),m=Math.floor(j+0.5);e.output(["image info:",n,",",i,"; max is ",f,",",m].join(""));if(f<=n||m<=i){if(f<=n&&m<=i){var g=f/n,k=m/i;if(g<k){l.w=Math.floor(n*g+0.5);l.h=Math.floor(i*g+0.5);l.zoom=g}else{l.w=Math.floor(n*k+0.5);l.h=Math.floor(i*k+0.5);l.zoom=k}}else{if(f<=n){l.zoom=f/n;l.w=Math.floor(f+0.5);l.h=Math.floor(i*l.zoom+0.5)}else{if(m<=i){l.zoom=m/i;l.w=Math.floor(n*l.zoom+0.5);l.h=Math.floor(m+0.5)}}}}e.output(["change result:",l.w,",",l.h].join(""));return l},getHex:function(g){var f;f=Number(g).toString(16).toUpperCase();if(f.length==1){f=["0",f].join("")}return f},getColor:function(i){var h,f,k,j;f=i>>16;k=(i&65280)>>8;j=i&255;h=["#",e.getHex(j),e.getHex(k),e.getHex(f)].join("");return h},SetPageNumber:function(k,g){var j=g*1,f,h;k.innerHTML=(j+1);if(j>=99&&j<999){f=32;h=24}else{if(j>=999&&j<9999){f=40;h=30}else{if(j>=9999&&j<99999){f=46;h=34}else{if(j>=99999){f=55;h=36}else{f=24;h=20}}}}k.style.width=f+"px";k.style.height=h+"px";if(c.env.bFirefox){}else{k.style.lineHeight=h+"px"}},output:function(f){if(Dynamsoft.WebTwainEnv.Debug){c.log(f)}}};function a(f){var g=this;g._width=0;g._height=0;g.canvasWidth=0;g.canvasHeight=0;g.Left=0;g.Top=0;g.Right=0;g.Bottom=0;g.borderWidth=1;g.borderColor="#EEEEEE";g.selectionBorderColor="#7DA2CE";g.backgroundColor="#DDDDDD";g.bIfFitWindow=true;g.fitWindowType=0;g.imageAreaSelector=false;g.bSelect=false;g.scrollH=false;g.scrollV=false;g.scrollArrowSize=16;g.cIndex=-1;g.objImage=false;g.iMouseShape=EnumDWT_MouseShape.Default;g.fUserSetZoom=1;g.fZoomValue=1;g.fZoomInStep=1.2;g.fZoomOutStep=0.8;g.mousePosition={x:-1,y:-1};g.mousePreviosPositionWhenMoving={x:-1,y:-1};g.drawArea={width:g.canvasWidth,height:g.canvasHeight,x:0,y:0};g.selectedImageArea={left:0,top:0,right:0,bottom:0};g.MoveStep=10;g.__fSelectionRectAspectRatio=0;g.bFocus=d;g.__overlay=d;g.bShowPageNumber=d;g.bVisible=b;g.divOut=d;g.divInner=d;g.divTag=d;g.canvas=d;g.bOrigMode=b;g.bHasOverlay=d;g._origImageWidth=-1;g._origImageHeight=-1;g.__init(f)}a.prototype.ChangeControlSize=function(g,f){var h=this;h._width=g;h._height=f;h.canvasWidth=g;h.canvasHeight=f;h.Right=h.Left+h._width;h.Bottom=h.Top+h._height;h.divInner.style.height=h.canvasHeight+"px";h.__recaculateDrawArea();h.imageAreaSelector.ChangeControlSize(h.canvasWidth,h.canvasHeight);h.Show();return true};a.prototype.SetVisible=function(f){var g=this;g.bVisible=f;if(f){g.divOut.style.display="";g.Show()}else{g.divOut.style.display="none"}return true};a.prototype.SetOrigMode=function(g){var f=this;if(f.bOrigMode&&g==false&&f.objImage){f.objImage.onload=undefined;f.objImage.src="data:,";f.objImage=d}this.bOrigMode=g};a.prototype.__init=function(f){var h=this,g=window.document;if(f.Width){h.canvasWidth=f.Width}if(f.Height){h.canvasHeight=f.Height}if(f.index){h.cIndex=f.index}h.divOut=g.createElement("div");h.divOut.style.position="absolute";h.divOut.onselectstart=function(){return false};h.divInner=g.createElement("div");h.divInner.style.position="relative";h.divInner.style.height=h.canvasHeight+"px";h.divTag=g.createElement("div");h.divTag.className="dynamsoft-dwt-imgTag";h.divTag.style.position="absolute";h.divTag.style.height="20px";h.canvas=g.createElement("canvas");h.canvas.width=h.canvasWidth;h.canvas.height=h.canvasHeight;h.divOut.appendChild(h.divInner);h.divInner.appendChild(h.divTag);h.divInner.appendChild(h.canvas);h.__createSelector(f);if(c.isFunction(f.onMouseRightClick)){h.onMouseRightClick=f.onMouseRightClick}if(c.isFunction(f.onMouseClick)){h.onMouseClick=f.onMouseClick}if(c.isFunction(f.onZoomChanged)){h.onZoomChanged=f.onZoomChanged}h.__overlay=new Dynamsoft.Lib.UI.ImageOverlay()};a.prototype.bindEvents=function(){var g=this,f;f=g.divOut.parentNode;if(f){g.imageAreaSelector.ChangeControlSize(g.canvasWidth,g.canvasHeight);g.imageAreaSelector.BindEvents();g.imageAreaSelector.SetMouseShape(g.iMouseShape)}return true};a.prototype.__getRealZoomValue=function(){var g=this,f;if(g.bOrigMode){f=g.fZoomValue}else{if(g._origImageWidth<=0){g.__getImageOrignalSize()}if(g._origImageWidth>0){if(g.objImage!=null&&g.objImage.width!=null){f=g.fZoomValue*g.objImage.width/g._origImageWidth}}else{e.output("cannot get image width.");f=-1}}return f};a.prototype.__getOrigImageWidth=function(){var f=this;if(f.bOrigMode&&f.objImage){return f.objImage.width}else{return f._origImageWidth}};a.prototype.__getOrigImageHeight=function(){var f=this;if(f.bOrigMode&&f.objImage){return f.objImage.height}else{return f._origImageHeight}};a.prototype.__checkNewZoomValue=function(f){var h=this,g=Math.floor(f*100);if(0<g&&g<2500){return true}return false};a.prototype.__checkZoomValue=function(f){var h=this,g=15000;if(h._origImageWidth<=0||h._origImageHeight<=0){return false}if(c.isUndefined(f)){if(parseInt(h._origImageWidth*h.fZoomValue)>g||parseInt(h._origImageHeight*h.fZoomValue)>g){return false}}else{if(parseInt(h._origImageWidth*f)>g||parseInt(h._origImageHeight*f)>g){return false}}return true};a.prototype.__createSelector=function(f){var h=this;if(!h.imageAreaSelector){h.imageAreaSelector=new Dynamsoft.Lib.UI.ImageAreaSelector(h);var g=h.imageAreaSelector.GetEL();h.divInner.appendChild(g);h.imageAreaSelector.onMouseUp=function(i){h.mousePreviosPositionWhenMoving.x=-1;h.mousePreviosPositionWhenMoving.y=-1};h.imageAreaSelector.onZoom=function(n){var m,l,j,p,r=n.ddx,q=n.ddy,i;j=h.__getOrigImagePos();if(e.isNaNOrUndefined(j.x)||e.isNaNOrUndefined(j.y)){return}p=h.__getRealZoomValue();if(p<0){return}m=(n.x+j.x)/p;l=(n.y+j.y)/p;var k=false;if(h.__checkZoomValue()){i=h.fZoomInStep*h.fZoomValue;if(!h.__checkNewZoomValue(i)){i=25;k=true}if(h.fZoomValue!=i){h.__zoomInAt(i,m,l,n.x,n.y)}else{k=true}h.__fireEvent("onZoomChanged",{zoom:h.fZoomValue,isMax:k,index:h.cIndex})}else{h.__fireEvent("onZoomChanged",{zoom:h.fZoomValue,isMax:true,index:h.cIndex})}h.mousePreviosPositionWhenMoving.x=-1;h.mousePreviosPositionWhenMoving.y=-1};h.imageAreaSelector.onMouseMove=function(p){var m,l,w,v,k,j=p.dragging,t;k=h.__getOrigImagePos();if(e.isNaNOrUndefined(k.x)||e.isNaNOrUndefined(k.y)){return}t=h.__getRealZoomValue();if(t<0){return}m=(p.x+k.x)/t;l=(p.y+k.y)/t;h.__fireEvent("onMouseMove",{e:p.e,x:m,y:l,index:h.cIndex});if((h.iMouseShape==EnumDWT_MouseShape.Hand)&&j){var s,r,q,n,i=h.__isShowScrollV(),u=h.__isShowScrollH();s=h.mousePreviosPositionWhenMoving.x;r=h.mousePreviosPositionWhenMoving.y;q=(s-p.x);n=(r-p.y);h.mousePreviosPositionWhenMoving.x=p.x;h.mousePreviosPositionWhenMoving.y=p.y;if(u&&h.scrollH){h.scrollH.ManualMoving(q)}if(i&&h.scrollV){h.scrollV.ManualMoving(n)}}};h.imageAreaSelector.onMouseClick=function(l){var m,k,j,i;j=h.__getOrigImagePos();if(e.isNaNOrUndefined(j.x)||e.isNaNOrUndefined(j.y)){return}i=h.__getRealZoomValue();if(i<0){return}m=(l.x+j.x)/i;k=(l.y+j.y)/i;h.mousePreviosPositionWhenMoving.x=l.x;h.mousePreviosPositionWhenMoving.y=l.y;h.__fireEvent("onMouseClick",{e:l.e,x:m,y:k,index:h.cIndex})};h.imageAreaSelector.onMouseDoubleClick=function(l){var m,k,j,i;j=h.__getOrigImagePos();if(e.isNaNOrUndefined(j.x)||e.isNaNOrUndefined(j.y)){return}i=h.__getRealZoomValue();if(i<0){return}m=(l.x+j.x)/i;k=(l.y+j.y)/i;h.mousePreviosPositionWhenMoving.x=l.x;h.mousePreviosPositionWhenMoving.y=l.y;h.__fireEvent("onMouseDoubleClick",{e:l.e,x:m,y:k,index:h.cIndex})};h.imageAreaSelector.onMouseRightClick=function(l){var m,k,j,i;j=h.__getOrigImagePos();if(e.isNaNOrUndefined(j.x)||e.isNaNOrUndefined(j.y)){return}i=h.__getRealZoomValue();if(i<0){return}m=(l.x+j.x)/i;k=(l.y+j.y)/i;h.__fireEvent("onMouseRightClick",{e:l.e,x:m,y:k,index:h.cIndex})};h.imageAreaSelector.onImageAreaSelected=function(p){var l=p.left,n=p.top,q=p.right,k=p.bottom,i=p.fromScroll,m,j;e.output("selected Area in Selector: "+[l,n,q,k].join(","));if(h.fZoomValue>0){m=h.__getOrigImagePos();if(e.isNaNOrUndefined(m.x)||e.isNaNOrUndefined(m.y)){return}l=(l+m.x);n=(n+m.y);q=(q+m.x);k=(k+m.y);e.output("selected zoomed Image Area: "+[l,n,q,k].join(","));j=h.__getRealZoomValue();if(j<0){return}l=l/j;n=n/j;q=q/j;k=k/j;e.output("selected orig Image Area: "+[l,n,q,k].join(","));if(l<0){l=0}if(n<0){n=0}if(q>h.__getOrigImageWidth()){q=h.__getOrigImageWidth()}if(k>h.__getOrigImageHeight()){k=h.__getOrigImageHeight()}h.__fireEvent("onImageAreaSelected",{index:h.cIndex,left:l,top:n,right:q,bottom:k,fromScroll:i})}};h.imageAreaSelector.onImageAreaDeSelected=function(){h.__fireEvent("onImageAreaDeSelected",h.cIndex)};if(c.isFunction(f.onMouseMove)){h.onMouseMove=f.onMouseMove}if(c.isFunction(f.onMouseClick)){h.onMouseClick=f.onMouseClick}if(c.isFunction(f.onMouseRightClick)){h.onMouseRightClick=f.onMouseRightClick}if(c.isFunction(f.onMouseDoubleClick)){h.onMouseDoubleClick=f.onMouseDoubleClick}if(c.isFunction(f.onImageAreaSelected)){h.onImageAreaSelected=f.onImageAreaSelected}if(c.isFunction(f.onImageAreaDeSelected)){h.onImageAreaDeSelected=f.onImageAreaDeSelected}if(c.isFunction(f.OnGetImageInfo)){h.OnGetImageInfo=f.OnGetImageInfo}}};a.prototype.__isShowScrollH=function(g){var h=this,f=g;if(!h.objImage){return false}if(c.isUndefined(f)){f=h.canvasHeight}return(f<h._height)};a.prototype.__isShowScrollV=function(g){var h=this,f=g;if(!h.objImage){return false}if(c.isUndefined(f)){f=h.canvasWidth}return(f<h._width)};a.prototype.ImageMoveLeft=function(){var h=this,f=h.__isShowScrollH(),g;if(f&&h.scrollH){g=-0.2*h.scrollH.GetPagePositionSize();h.scrollH.ManualMoving(g)}return true};a.prototype.ImageMoveRight=function(){var h=this,f=h.__isShowScrollH(),g;if(f&&h.scrollH){g=0.2*h.scrollH.GetPagePositionSize();h.scrollH.ManualMoving(g)}return true};a.prototype.ImageMoveUp=function(){var h=this,f=h.__isShowScrollV(),g;if(f&&h.scrollV){g=-0.2*h.scrollV.GetPagePositionSize();h.scrollV.ManualMoving(g)}return true};a.prototype.ImageMoveDown=function(){var h=this,f=h.__isShowScrollV(),g;if(f&&h.scrollV){g=0.2*h.scrollV.GetPagePositionSize();h.scrollV.ManualMoving(g)}return true};a.prototype.ImageMovePageUp=function(){var h=this,f=h.__isShowScrollV(),g;if(f&&h.scrollV){g=-1*h.scrollV.GetPagePositionSize();h.scrollV.ManualMoving(g)}return true};a.prototype.ImageMovePageDown=function(){var h=this,f=h.__isShowScrollV(),g;if(f&&h.scrollV){g=h.scrollV.GetPagePositionSize();h.scrollV.ManualMoving(g)}return true};a.prototype.ImageMoveHome=function(){var j=this,g=j.__isShowScrollV(),h=j.__isShowScrollH(),i,f;if(g&&j.scrollV){f=j.scrollV.GetMaxPosition();j.scrollV.ManualMoving(-f)}if(h&&j.scrollH){f=j.scrollH.GetMaxPosition();j.scrollH.ManualMoving(-f)}return true};a.prototype.ImageMoveEnd=function(){var j=this,g=j.__isShowScrollV(),h=j.__isShowScrollH(),i,f;if(g&&j.scrollV){f=j.scrollV.GetMaxPosition();j.scrollV.ManualMoving(f)}if(h&&j.scrollH){f=j.scrollH.GetMaxPosition();j.scrollH.ManualMoving(f)}return true};a.prototype.SetLocation=function(f,h){var g=this;g.Left=f;g.Top=h;g.Right=f+g.canvasWidth;g.Bottom=h+g.canvasHeight;e.output("SetLocation:"+f+", "+h);if(g.divOut){if(g.divOut.parentNode){g.divOut.parentNode.style.position="relative"}g.divOut.style.left=f+"px";g.divOut.style.top=h+"px";g.__refreshImageAreaSelectorLocationAndSize();g.__refreshImageOverlayInfo()}return true};a.prototype.SetMouseShape=function(g){var h=this,f=h.iMouseShape;h.iMouseShape=g;e.output("SetMouseShape: "+[f,h.iMouseShape].join("->"));if(h.imageAreaSelector){h.imageAreaSelector.SetMouseShape(h.iMouseShape)}return true};a.prototype.SetBackgroundColor=function(f){var g=this;e.output("SetBackgroundColor:"+f);g.backgroundColor=f;if(g.drawArea.width<g.canvasWidth||g.drawArea.height<g.canvasHeight){g.Show()}return true};a.prototype.SetSelectionImageBorderColor=function(f){var g=this;e.output("SetSelectionImageBorderColor:"+f);g.selectionBorderColor=f;g.__refreshBorder();return true};a.prototype.GetEL=function(){e.output("GetEL:");return this.divOut};a.prototype.__getOrigImagePos=function(){var j=this,h=j.drawArea.x,i=j.drawArea.y,f=j.drawArea.width,g=j.drawArea.height;if(f<=j.canvasWidth){h=h+(j.canvasWidth-f)*0.5}if(g<=j.canvasHeight){i=i+(j.canvasHeight-g)*0.5}return{x:h,y:i}};a.prototype.__getImageDrawLocationAndSize=function(j,i){var l=this,h=j,k=i,f,g;if(e.isNaNOrUndefined(h)){h=0}if(e.isNaNOrUndefined(k)){k=0}f=l.drawArea.width;g=l.drawArea.height;if(f<=l.canvasWidth){h=(l.canvasWidth-f)*0.5;f=l.drawArea.width}else{h=h-l.drawArea.x;h=h<0?0:h;f=l.canvasWidth}if(g<=l.canvasHeight){k=(l.canvasHeight-g)*0.5;g=l.drawArea.height}else{k=k-l.drawArea.y;k=k<0?0:k;g=l.canvasHeight}h+=l.borderWidth;k+=l.borderWidth;return{left:h,top:k,width:f,height:g}};a.prototype.__refreshImageOverlayInfo=function(){var h=this,f,g=1;f=h.__getImageDrawLocationAndSize();g=h.__getRealZoomValue();if(g<0){return}h.__overlay.SetLocation(f.left,f.top);h.__overlay.SetImageSize(h._origImageWidth,h._origImageHeight);h.__overlay.SetZoom(g);if(h.canvas){h.__overlay.SetContext(h.canvas.getContext("2d"))}else{h.__overlay.SetContext(false)}};a.prototype.__refreshImageAreaSelectorLocationAndSize=function(){var g=this,f;if(g.imageAreaSelector){f=g.__getImageDrawLocationAndSize();g.imageAreaSelector.SetDrawImageLocationAndSize(f.left,f.top,f.width,f.height);g.imageAreaSelector.ChangeControlSize(g.canvasWidth,g.canvasHeight)}return true};a.prototype.SetBindIndex=function(f){this._bindIndex=f;return true};a.prototype.GetBindIndex=function(){return this._bindIndex};a.prototype.SetCurrentIndex=function(f){var g=this;g.cIndex=f;return true};a.prototype.GetCurrentIndex=function(){var f=this;return f.cIndex};a.prototype.ClearImage=function(){var g=this,f;if(g.bOrigMode){g.objImage.onload=undefined;g.objImage.src="data:,"}g.objImage=d;g.bHasOverlay=d;g.__overlay.Clear();g._origImageWidth=-1;g._origImageHeight=-1;return true};a.prototype.__getImageOrignalSize=function(){var g=this;if(g.bOrigMode){g._origImageWidth=g.objImage.width;g._origImageHeight=g.objImage.height}else{if(g.cIndex>=0){var f=g.__fireEvent("OnGetImageInfo",g.cIndex);g._origImageWidth=f.width;if(g.objImage!=null&&g.objImage.height!=null&&g.objImage.width!=null){g._origImageHeight=g._origImageWidth*g.objImage.height/g.objImage.width}}else{g._origImageWidth=-1;g._origImageHeight=-1}}};a.prototype.AttachImage=function(s,t,q,g,f,j){var n=this;e.output("AttachImage: objImage,"+[t,q,g,j].join(","));if(n.bOrigMode){n.objImage.onload=undefined;n.objImage.src="data:,"}n.objImage=s;n.bOrigMode=j;n.__resetTag();if(f){var l,h,m=f.length;n.__overlay.Clear();if(m){n.bHasOverlay=b}for(l=0;l<m;l++){h=f[l];n.__overlay.Add(h.Left,h.Top,h.Right,h.Bottom,h.ColorRGB,h.Opacity)}}n.__getImageOrignalSize();var p=false;if(n.bIfFitWindow&&(n.fitWindowType==0||n.fitWindowType==1||n.fitWindowType==2||n.fitWindowType==4)){p=false}else{p=j&&(n.fUserSetZoom!=1)}if(p){n.SetZoom(n.fUserSetZoom)}else{if(j&&!n.bIfFitWindow){var k={},r;k.x=n.drawArea.x;k.y=n.drawArea.y;k.fOldZoom=1;k.fNewZoom=1;k.oldIfFitWindow=true;k.oldFitWindowType=0;k.oldCanvasWidth=n.canvasWidth;k.oldCanvasHeight=n.canvasHeight;n.fitWindowType=3;n.__recaculateDrawArea();r=n.__getScrollInfoWithNewZoom(k);n.__setDrawArea(r.x,r.y,n.drawArea.width,n.drawArea.height);n.__resetScroll()}else{n.__recaculateDrawArea()}}return true};a.prototype.Show=function(j){var i=this,f,h;if(i.bVisible){i.divOut.style.display=""}else{i.divOut.style.display="none";return}e.output("Show:"+[i.canvasWidth,i.canvasHeight].join(","));f=i.canvas.getContext("2d");i.__restoreCanvas(f,i.canvasWidth,i.canvasHeight);if(i.drawArea.width<=0||i.drawArea.height<=0||i.canvasWidth<=0||i.canvasHeight<=0){return false}if(!j){i.__resetScroll()}i.__resetTag();f.clearRect(0,0,i.canvasWidth,i.canvasHeight);if(!i.objImage||i.objImage.src=="data:,"||i.objImage.width==0||i.objImage.height==0||i.objImage.src==""){f.fillStyle=i.backgroundColor;f.fillRect(0,0,f.canvas.width,f.canvas.height);if(i._width>53){f.font="12px Times New Roman";f.textAlign="center";f.strokeText("Loading ...",f.canvas.width*0.5,f.canvas.height*0.5)}return false}if(i.cIndex==-1){return}e.output("draw info: "+[i.objImage.width,i.objImage.height,i.drawArea.x,i.drawArea.y,i.drawArea.width,i.drawArea.height].join(","));if(i.drawArea.width<i.canvasWidth||i.drawArea.height<i.canvasHeight){f.fillStyle=i.backgroundColor;f.fillRect(0,0,i.canvasWidth,i.canvasHeight)}var g=function(){try{if(i.objImage){f.drawImage(i.objImage,Math.floor(-i.drawArea.x),Math.floor(-i.drawArea.y),Math.floor(i.drawArea.width),Math.floor(i.drawArea.height))}i.__overlay.Draw()}catch(k){}};if(c.env.bIE){setTimeout(g,10)}else{g()}return true};a.prototype.SetSelect=function(f){var g=this;e.output("SetSelect:"+f);g.bSelect=f;g.__resetTag();g.__refreshBorder();return true};a.prototype.GetIndex=function(){return this.cIndex};a.prototype.SetSelectedImageArea=function(k,h,p,g){var m=this,s=k,r=h,f=0,l=0,i=1;e.output("SetSelectedImageArea:"+[k,h,p,g].join(", "));if(p<k&&g<h){s=parseInt(p);r=parseInt(g);f=parseInt(k);l=parseInt(h)}else{f=parseInt(p);l=parseInt(g);s=parseInt(k);r=parseInt(h)}m.selectedImageArea.left=s;m.selectedImageArea.top=r;m.selectedImageArea.right=f;m.selectedImageArea.bottom=l;if(m.imageAreaSelector){if(m._origImageWidth<=0){m.__getImageOrignalSize()}if(m._origImageWidth>0){i=m.__getRealZoomValue();if(i<0){return false}}else{return false}var j=s*i,n=r*i,q=f*i,o=l*i;m.imageAreaSelector.SetSelectedArea(j,n,q,o);return true}return false};a.prototype.OverlayRectangle=function(l,k,n,h,f,j){var m=this;e.output("OverlayRectangle:"+[l,k,n,h,f,j].join(", "));m.bHasOverlay=b;if(m._origImageWidth<=0){m.__getImageOrignalSize()}m.__refreshImageOverlayInfo();m.__overlay.Add(l,k,n,h,f,j,true);m.drawArea.x=0;m.drawArea.y=0;if(m.drawArea.width<=m.canvasWidth){m.drawArea.x=(m.drawArea.width-m.canvasWidth)*0.5}else{var i=Math.floor((l*m.fZoomValue+n*m.fZoomValue-m.canvasWidth)/2-m.drawArea.x);m.drawArea.x=i>0?i:0}if(m.drawArea.height<=m.canvasHeight){m.drawArea.y=(m.drawArea.height-m.canvasHeight)*0.5}else{var g=Math.floor((k*m.fZoomValue+h*m.fZoomValue-m.canvasHeight)/2-m.drawArea.y);m.drawArea.y=g>0?g:0}m.__setDrawArea(m.drawArea.x,m.drawArea.y,m.drawArea.width,m.drawArea.height);m.__resetScroll();m.Show();return true};a.prototype.GetMousePosition=function(){e.output("GetMousePosition:");return this.mousePosition};a.prototype.__setDrawArea=function(g,j,h,f){var i=this;i.drawArea.x=g;i.drawArea.y=j;i.drawArea.width=h;i.drawArea.height=f;if(i.drawArea.width>i.canvasWidth&&i.drawArea.x>i.drawArea.width-i.canvasWidth){i.drawArea.x=i.drawArea.width-i.canvasWidth}if(i.drawArea.height>i.canvasHeight&&i.drawArea.y>i.drawArea.height-i.canvasHeight){i.drawArea.y=i.drawArea.height-i.canvasHeight}i.__refreshImageAreaSelectorLocationAndSize();i.__refreshImageOverlayInfo()};a.prototype.GetZoom=function(){var f=this;return f.fZoomValue};a.prototype.SetZoom=function(r,l,k,h,g){var m=this,i,j={},p,f,q;e.output("SetZoom:"+[i,r].join("->"));m.fUserSetZoom=r;j.x=m.drawArea.x;j.y=m.drawArea.y;j.fOldZoom=m.fZoomValue;j.fNewZoom=r;j.oldIfFitWindow=m.bIfFitWindow;j.oldFitWindowType=m.fitWindowType;j.oldCanvasWidth=m.canvasWidth;j.oldCanvasHeight=m.canvasHeight;j.bMoveCenter=false;if(!c.isUndefined(l)&&!c.isUndefined(k)){j.bMoveCenter=true;var o=(l/m.fZoomValue);var n=(k/m.fZoomValue);j.newRealCenterX=l;j.newRealCenterY=k;j.newClickX=h;j.newClickY=g}m.bIfFitWindow=false;m.fitWindowType=3;m.fZoomValue=r;if(!m.objImage){return}m.__recaculateDrawArea();p=m.__getScrollInfoWithNewZoom(j);m.__setDrawArea(p.x,p.y,m.drawArea.width,m.drawArea.height);m.__resetScroll();m.Show();return true};a.prototype.SetSelectionRectAspectRatio=function(f){var g=this;e.output("SetSelectionRectAspectRatio:"+f);if(f<0){f=0}g.__fSelectionRectAspectRatio=f;return true};a.prototype.SetIfFitWindow=function(g,f){var h=this;e.output("SetIfFitWindow:"+[g,f].join(","));h.bIfFitWindow=g;if(g){h.fitWindowType=f}else{h.fitWindowType=3}h.__recaculateDrawArea();h.Show();return true};a.prototype.Stretch=function(){var f=this;e.output("Stretch");f.canvasWidth=f._width;f.canvasHeight=f._height;f.__setDrawArea(0,0,f.canvasWidth,f.canvasHeight);f.__refreshImageAreaSelectorLocationAndSize();f.__refreshImageOverlayInfo();return true};a.prototype.Destroy=function(){var g=this;e.output("Destroy:");g.SetBindIndex(-1);if(g.canvas){var f=g.canvas.getContext("2d");if(g.canvasWidth>0&&g.canvasHeight>0){f.clearRect(0,0,g.canvasWidth,g.canvasHeight)}}g.ClearImage();if(g.imageAreaSelector){g.imageAreaSelector.Destroy();g.imageAreaSelector=false}if(g.__overlay){g.__overlay.Destroy()}return true};a.prototype.SetShowPageNumber=function(f){var g=this;g.bShowPageNumber=f;g.__resetTag();return true};a.prototype.__getScrollInfoWithNewZoom=function(C){var y=this,E={x:0,y:0},h,g,t,s,m,k,n=false,p,B,o,v,w,i,f,q,x,F;p=y.fZoomValue;if(p<=0||!y.objImage){return E}h=C.x;g=C.y;B=C.oldIfFitWindow;o=C.oldFitWindowType;if(B){if(o==0){n=true}else{if(o==1){n=true}else{if(o==2){n=true}else{if(o==4){n=true}}}}}w=C.oldCanvasWidth;i=C.oldCanvasHeight;v=C.fOldZoom;if(!C.bMoveCenter){if(n){h=t=y.objImage.width*0.5;g=s=y.objImage.height*0.5;m=t*p;k=s*p}else{h=h+w*0.5;g=g+i*0.5;t=h/v;s=g/v;m=t*p;k=s*p}}else{m=C.newRealCenterX*p;k=C.newRealCenterY*p}bOldShowScrollV=y.__isShowScrollV(w),bOldShowScrollH=y.__isShowScrollH(i);x=y.__isShowScrollV(),F=y.__isShowScrollH();f=y.canvasWidth;q=y.canvasHeight;if(C.bMoveCenter){var A=(y.drawArea.width-f)*0.5,l=C.x,j=C.newRealCenterX*p,u=C.newRealCenterX*v,D=A-j-l+u;E.x=A-D;var r=(y.drawArea.height-q)*0.5,z=C.y,j=C.newRealCenterY*p,u=C.newRealCenterY*v,D=r-j-z+u;E.y=r-D;return E}if(F){E.x=m-f*0.5;if(E.x<0){E.x=0}}else{E.x=(y.drawArea.width-f)*0.5}if(x){E.y=k-q*0.5;if(E.y<0){E.y=0}}else{E.y=(y.drawArea.height-q)*0.5}return E};a.prototype.__recaculateDrawArea=function(){var k=this,g=false,j=false,f,h=false,i=false;k.canvasWidth=k._width;k.canvasHeight=k._height;if(k.objImage){if(k.bIfFitWindow){if(k.fitWindowType==0){f=e.getAdjustedImageSize(k.objImage.width,k.objImage.height,k.canvasWidth,k.canvasHeight);k.fZoomValue=f.zoom}else{if(k.fitWindowType==1){f=e.getAdjustedImageSize(k.objImage.width,k.objImage.height,k.objImage.width,k.canvasHeight);if(f.w>k._width){h=true;k.canvasHeight=k._height-k.scrollArrowSize;f=e.getAdjustedImageSize(k.objImage.width,k.objImage.height,k.objImage.width,k.canvasHeight)}k.fZoomValue=f.zoom}else{if(k.fitWindowType==2){f=e.getAdjustedImageSize(k.objImage.width,k.objImage.height,k.canvasWidth,k.objImage.height);if(f.h>k._height){h=true;k.canvasWidth=k._width-k.scrollArrowSize;f=e.getAdjustedImageSize(k.objImage.width,k.objImage.height,k.canvasWidth,k.objImage.height)}k.fZoomValue=f.zoom}else{if(k.fitWindowType==4){g=true}else{f={w:k.objImage.width,h:k.objImage.height};j=true;k.fZoomValue=k.fUserSetZoom}}}}}else{f={w:k.objImage.width*k.fZoomValue,h:k.objImage.height*k.fZoomValue};j=true}}else{g=true}if(g){k.Stretch()}else{if(j){if(f.h>k._height){h=true;k.canvasWidth=k._width-k.scrollArrowSize}if(f.w>k._width){h=true;k.canvasHeight=k._height-k.scrollArrowSize}}k.drawArea.width=f.w;k.drawArea.height=f.h;if(k.drawArea.width<k.canvasWidth){k.drawArea.x=(k.drawArea.width-k.canvasWidth)*0.5}else{k.drawArea.x=0}if(k.drawArea.height<k.canvasHeight){k.drawArea.y=(k.drawArea.height-k.canvasHeight)*0.5}else{k.drawArea.y=0}e.output("draw Area: "+[k.drawArea.x,k.drawArea.y,k.drawArea.width,k.drawArea.height].join(","));k.__refreshImageAreaSelectorLocationAndSize();k.__refreshImageOverlayInfo()}};a.prototype.__resetScroll=function(){var h=this,j,g,f=h.__isShowScrollV(),k=h.__isShowScrollH(),o,i,n,l,m;if(h.canvas){n=h.canvas.parentNode}if(!n){return}h.__overlay.left=-h.drawArea.x;h.__overlay.top=-h.drawArea.y;if(f){cPosition=h.drawArea.y;if(!h.scrollV){j={Width:h.scrollArrowSize,Height:h.canvasHeight,Horizontal:false};j.onValueChanged=function(p){h.drawArea.y=p.Value;if(h.drawArea.height>h.canvasHeight&&h.drawArea.y>h.drawArea.height-h.canvasHeight){h.drawArea.y=h.drawArea.height-h.canvasHeight}h.__overlay.top=-h.drawArea.y;h.__reselectArea();h.Show(true)};h.scrollV=new Dynamsoft.Lib.UI.ScrollBar(j);h.scrollV.InitScroll(h.drawArea.height,h.canvasHeight);h.scrollV.SetLocation(1,1);g=h.scrollV.GetEL();g.style.position="absolute";n.appendChild(g)}else{g=h.scrollV.GetEL();if(h.scrollV.GetControlHeight()!=h.canvasHeight){h.scrollV.ChangeControlSize(h.scrollArrowSize,h.canvasHeight)}g.style.display="";h.scrollV.InitScroll(h.drawArea.height,h.canvasHeight);h.scrollV.SetPosition(cPosition)}g.style.top=h.borderWidth+"px";g.style.left=h.borderWidth+h._width-h.scrollArrowSize+"px";h.scrollV.Refresh()}else{if(h.scrollV){g=h.scrollV.GetEL();g.style.display="none"}}if(k){cPosition=h.drawArea.x;if(!h.scrollH){j={Width:h.canvasWidth,Height:h.scrollArrowSize,Horizontal:true};j.onValueChanged=function(p){h.drawArea.x=p.Value;if(h.drawArea.width>h.canvasWidth&&h.drawArea.x>h.drawArea.width-h.canvasWidth){h.drawArea.x=h.drawArea.width-h.canvasWidth}h.__overlay.left=-h.drawArea.x;h.__reselectArea();h.Show(true)};h.scrollH=new Dynamsoft.Lib.UI.ScrollBar(j);h.scrollH.InitScroll(h.drawArea.width,h.canvasWidth);h.scrollH.SetLocation(1,1);g=h.scrollH.GetEL();g.style.position="absolute";n.appendChild(g)}else{g=h.scrollH.GetEL();if(h.scrollH.GetControlWidth()!=h.canvasWidth){h.scrollH.ChangeControlSize(h.canvasWidth,h.scrollArrowSize)}g.style.display="";h.scrollH.InitScroll(h.drawArea.width,h.canvasWidth);h.scrollH.SetPosition(cPosition)}g.style.top=h.borderWidth+h._height-h.scrollArrowSize+"px";g.style.left=h.borderWidth+"px";h.scrollH.Refresh()}else{if(h.scrollH){g=h.scrollH.GetEL();g.style.display="none"}}};a.prototype.__restoreCanvas=function(g,f,i){var j=this;g.canvas.width=f;g.canvas.height=i};a.prototype.__reselectArea=function(){var f=this;if(f.imageAreaSelector){f.imageAreaSelector.ReFireSelectedEventWhenImageMoved()}};a.prototype.__zoomIn=function(){var f=this;f.SetZoom(1.1*f.fZoomValue)};a.prototype.__zoomInAt=function(g,f,k,i,h){var j=this;if(j.fitWindowType==4){j.SetIfFitWindow(true,0);j.__zoomIn()}else{j.SetZoom(g,f,k,i,h)}};a.prototype.__zoomOut=function(){var f=this;f.SetZoom(0.9*f.fZoomValue)};a.prototype.__refreshBorder=function(){var f=this;if(f.bSelect){f.divOut.style.border=f.borderWidth+"px solid "+f.selectionBorderColor}else{f.divOut.style.border=f.borderWidth+"px solid "+f.borderColor}};a.prototype.__resetTag=function(){var f=this;if(f.bShowPageNumber){e.SetPageNumber(f.divTag,f.cIndex);if(f.bSelect){f.divTag.className="dynamsoft-dwt-imgTag dynamsoft-dwt-imgTag_Selected"}else{f.divTag.className="dynamsoft-dwt-imgTag dynamsoft-dwt-imgTag_Normal"}f.divTag.style.display="block"}else{f.divTag.innerHTML="";f.divTag.style.display="none"}};a.prototype.ClearControl=function(){var f=this;f.ClearImage();f.bShowPageNumber=d;f.Show();return true};a.prototype.__fireEvent=function(f,g){var h=this;if(c.isFunction(h[f])){return h[f](g)}return true};c.UI=c.UI||{};c.UI.ImageControl=a})(Dynamsoft.Lib);(function(c){if(!c.product.bChromeEdition){return}var g=document,d=[],f=c.html5.Funs2;function h(k,j,q,r,m,i,s,p,l,o){var n=this;n.iControlIndex=k;n.iImageIndex=j;n.View=q;n.imgControl=r;n.modelImageControl=m;n.iWidth=i;n.iHeight=s;n.AttachImagesForControl=p;n.bOnlyFromServer=l;n.BaseUrl=o}function b(n,m,l,j,i,k){var o=this;o.Left=n;o.Top=m;o.Right=l;o.Bottom=j;o.ColorRGB=i;o.Opacity=k}function e(i){var j=this;if(!Dynamsoft.WebTwainEnv.ScanDirectly){j.bFocus=false;j.borderWidth=c.isUndefined(i.borderWidth)?1:i.borderWidth;j.canvas=document.createElement("div");if(j.canvas){j.canvas.style.width=i.Width+"px";j.canvas.style.height=i.Height+"px";if(j.borderWidth>0){j.canvas.style.border=j.borderWidth+"px solid #CCCCCC"}j.canvas.style.display="block"}j.BaseUrl=false;i.Container.append(j.canvas);c.addEventListener(j.canvas,"mouseenter",function(k){j.bFocus=true});c.addEventListener(j.canvas,"mouseleave",function(k){j.bFocus=false});c.addEventListener(j.canvas,"mousewheel",function(k){if(!j.bFocus){return true}var l=c.getWheelDelta(k);if(l<0){j.__MousewheelValue--}else{if(l>0){j.__MousewheelValue++}}c.stopPropagation(k);setTimeout(function(){j.__MousewheelChanged(j)},200);return false});j.imageViewWidth=i.Width;j.imageViewHeight=i.Height;j.imagesPerRow=1;j.imagesPerColumn=1;j.MAX_ROWS=128;j.MAX_COLUMNS=128;j.bSingleMode=false;j.bVerticalMode=true;j.iMouseShape=EnumDWT_MouseShape.Default;j.bIfFitWindow=true;j.enumDWTFitWindowType=0;j.fZoom=1;j.zoomInStep=1.2;j.zoomOutStep=0.8;j.MIN_ZOOM=0.02;j.MAX_ZOOM=65;j.ImageMargin=0;j.iControlWidth;j.iControlHeight;j.iCurrentRow=-1;j.iOldFirstVisibleRow=0;j.iCurrentColumn=-1;j.iOldFirstVisibleColum=0;j.AllowMultiSelect=true;j.SelectionImageBorderColor="#7DA2CE";j.BackgroundColor="#FFFFFF";j.cCurrentIndex=-1;j.sHowManyImages=0;j.bScrollBar=true;j.__InitiHorizontalScrollBar(i);j.__InitiVerticalScrollBar(i)}j.aryCurrentSelectedImageIndicesInBuffer=[];j.aryModelImageControl=i.aryModelImageControl;j.aryImageControls=[];j.bShowPageNumber=false;j.ratio=0;j.__IfAutoScroll=true;j.__bAddingImage=false;j.__InitEvents(i);d.push(j);if(!Dynamsoft.WebTwainEnv.ScanDirectly){if(j.canvas){j.canvas.style.backgroundColor=j.BackgroundColor}j.__MousewheelValue=0}}e.prototype.__InitEvents=function(i){var j=this;if(c.isFunction(i.OnTopImageInTheViewChanged)){j.OnTopImageInTheViewChanged=i.OnTopImageInTheViewChanged}if(c.isFunction(i.OnGetImageInfo)){j.OnGetImageInfo=i.OnGetImageInfo}if(c.isFunction(i.onZoomChanged)){j.onZoomChanged=i.onZoomChanged}if(c.isFunction(i.onMouseMove)){j.onMouseMove=i.onMouseMove}if(c.isFunction(i.onMouseClick)){j.onMouseClick=i.onMouseClick}if(c.isFunction(i.onMouseRightClick)){j.onMouseRightClick=i.onMouseRightClick}if(c.isFunction(i.onMouseDoubleClick)){j.onMouseDoubleClick=i.onMouseDoubleClick}if(c.isFunction(i.onImageAreaDeSelected)){j.onImageAreaDeSelected=i.onImageAreaDeSelected}if(c.isFunction(i.onImageAreaSelected)){j.onImageAreaSelected=i.onImageAreaSelected}if(c.isFunction(i.onSelected)){j.onSelected=i.onSelected}if(c.isFunction(i.onRefreshUI)){j.onRefreshUI=i.onRefreshUI}if(c.isFunction(i.onResetCurrentIndex)){j.onResetCurrentIndex=i.onResetCurrentIndex}};e.prototype.__InitiHorizontalScrollBar=function(j){var k=this;var i={Width:j.Width,Height:16,Value:0,MaxValue:0,Horizontal:true};i.onValueChanged=function(l){k.__UpdateImageByScrollBar(l.Value)};k.horizontalScrollBar=new c.UI.ScrollBar(i);if(k.canvas&&k.horizontalScrollBar){k.canvas.appendChild(k.horizontalScrollBar.GetEL())}k.__SetHLocation(0,j.Height-k.__GetScrollWidth())};e.prototype.__InitiVerticalScrollBar=function(i){var k=this;var j={Width:16,Height:i.Height,Value:0,MaxValue:0,Horizontal:false};j.onValueChanged=function(l){k.__UpdateImageByScrollBar(l.Value)};k.verticalScrollBar=new c.UI.ScrollBar(j);if(k.canvas&&k.verticalScrollBar){k.canvas.appendChild(k.verticalScrollBar.GetEL())}k.__SetVLocation(i.Width-k.__GetScrollWidth(),0)};e.prototype.__UpdateImageByScrollBar=function(l){var o=this,i=-1,m=-1,k=-1,j,n;if(o.aryImageControls&&o.aryImageControls.length>0){n=o.aryImageControls[0];if(n){m=n.GetCurrentIndex();i=o.__GetRow(m)}}if(o.bVerticalMode==true){k=parseInt(o.__GetVisibleRow(l)*o.imagesPerColumn);j=o.__GetRow(k);if(i==j){return}}else{k=parseInt(o.__GetVisibleRow(l));if(k==m){return}}f.output(o,"__UpdateImageByScrollBar(value, newIndex): "+[l,k].join(","));o.__GoInner(k,false,true)};e.prototype.UpdateImage=function(k,m,j,i,q,o){var n=this;var r=n.aryModelImageControl[k];r.imageToShow=m;r.imageWidth=j;r.imageHeight=i;r.iImageControlWidth=j;r.iImageControlHeight=i;r.aryOverlayRectangleData=q;r.imageUrl=o;var p=n.GetImageControl(k);if(null!=p){p.SetCurrentIndex(k);if(m!=null&&(m.src=="data:,"||m.width==0||m.height==0||m.src=="")){var l=n.__GetImageControlIndex(k);if(l>=0){n.__SetArrayControlLoadImage(l,k,p,r,j,i,n.AttachImagesForControl,false)}}else{if(m==null){var l=n.__GetImageControlIndex(k);if(l>=0){var j=parseInt(n.imageViewWidth/2);var i=parseInt(n.imageViewHeight/2);if(n.imagesPerRow==1&&n.imagesPerColumn==1){if(n.bSingleMode==true){j=-1;i=-1;r.bOriginalImage=true}else{j=n.imageViewWidth;i=n.imageViewHeight;r.bOriginalImage=false}}else{if(j<300){j=300}if(i<300){i=300}r.bOriginalImage=false}n.__SetArrayControlLoadImage(l,k,p,r,j,i,n.AttachImagesForControl,true)}}n.AttachImagesForControl(p,r,k)}}n.iCurrentRow=-1;n.iCurrentColumn=-1;return true};e.prototype.__AddImage=function(j,k){var l=this;l.__AddControl();var i=l.GetImageControl(j);i.SetCurrentIndex(j);l.AttachImagesForControl(i,k,j)};e.prototype.UpdateAllImage=function(m,i,k,j){var l=this;return l.UpdateAllImageInner(m,i,false,k,j)};e.prototype.UpdateAllImageInner=function(q,j,n,m,l){var p=this;p.aryModelImageControl=q;p.__OnlySetCurrentIndex(j);p.sHowManyImages=p.aryModelImageControl.length;var o=(p.imagesPerRow*p.imagesPerColumn)>p.sHowManyImages?p.sHowManyImages:p.imagesPerRow*p.imagesPerColumn;var k=0;for(k=p.aryImageControls.length-1;k>=o;k--){p.__RemoveControl(k)}for(k=p.aryImageControls.length;k<o;k++){p.__AddControl()}if(!Dynamsoft.WebTwainEnv.ScanDirectly){p.__ConfirmScrollMaxValue();p.__ConfirmScrollVisibity();p.iCurrentRow=-1;p.iCurrentColumn=-1;p.__SetCurrentIndex(p.cCurrentIndex);p.__ReInitChildrenPosition();p.__AttachImages(n,m,l)}return true};e.prototype.__AddControl=function(){var k=this,i={};if(!Dynamsoft.WebTwainEnv.ScanDirectly){if(c.isFunction(k.onImageAreaDeSelected)){i.onImageAreaDeSelected=k.onImageAreaDeSelected}if(c.isFunction(k.onImageAreaSelected)){i.onImageAreaSelected=k.onImageAreaSelected}i.onZoomChanged=function(l){k.fZoom=l.zoom;k.__fireEvent("onZoomChanged",l)};i.onMouseClick=function(l){k.__OnMouseClick(l);k.__fireEvent("onMouseClick",l)};i.onMouseRightClick=function(l){k.__fireEvent("onMouseRightClick",l)};i.onMouseMove=function(l){k.__fireEvent("onMouseMove",l)};i.onMouseDoubleClick=function(l){k.__fireEvent("onMouseDoubleClick",l)};i.OnGetImageInfo=function(l){return k.__fireEvent("OnGetImageInfo",l)}}var j=new c.UI.ImageControl(i);k.aryImageControls.push(j);c.imageControlCount++;k.__InitImageControl(j);if(!Dynamsoft.WebTwainEnv.ScanDirectly){if(k.canvas){k.canvas.appendChild(j.GetEL())}j.bindEvents()}};e.prototype.__InitImageControl=function(i){var j=this;if(j.imagesPerRow==1&&j.imagesPerColumn==1){i.SetMouseShape(j.iMouseShape);i.SetShowPageNumber(false)}else{i.SetMouseShape(EnumDWT_MouseShape.Hand);i.SetShowPageNumber(j.bShowPageNumber)}i.SetSelectionRectAspectRatio(j.ratio);i.SetBackgroundColor(j.BackgroundColor);i.SetSelectionImageBorderColor(j.SelectionImageBorderColor);if(j.bSingleMode){if(j.bIfFitWindow){i.SetIfFitWindow(true,j.enumDWTFitWindowType)}else{i.SetZoom(j.fZoom)}}else{i.SetIfFitWindow(true,0)}};e.prototype.__OnMouseClick=function(k){var n=this;var o=k.index;var r=n.aryCurrentSelectedImageIndicesInBuffer.indexOf(o),j=k.e.ctrlKey,p=k.e.shiftKey,q=k.e.metaKey;if(r==-1){if(j||p||q||n.aryCurrentSelectedImageIndicesInBuffer.length<1){n.aryCurrentSelectedImageIndicesInBuffer.push(o)}else{if(n.aryCurrentSelectedImageIndicesInBuffer.length==1){if(n.aryCurrentSelectedImageIndicesInBuffer[0]==o){return}n.aryCurrentSelectedImageIndicesInBuffer[0]=o}else{n.aryCurrentSelectedImageIndicesInBuffer=[];n.aryCurrentSelectedImageIndicesInBuffer.push(o)}}}else{if((j||q)&&n.aryCurrentSelectedImageIndicesInBuffer.length>1){n.aryCurrentSelectedImageIndicesInBuffer.splice(r,1)}else{if(p){n.aryCurrentSelectedImageIndicesInBuffer.push(o)}else{if(n.aryCurrentSelectedImageIndicesInBuffer.length==1&&n.cCurrentIndex==o){return}n.aryCurrentSelectedImageIndicesInBuffer=[];n.aryCurrentSelectedImageIndicesInBuffer.push(o)}}}if(p){var u=n.aryCurrentSelectedImageIndicesInBuffer[0],m=n.aryCurrentSelectedImageIndicesInBuffer[n.aryCurrentSelectedImageIndicesInBuffer.length-1];n.aryCurrentSelectedImageIndicesInBuffer=[];if(m==u){n.aryCurrentSelectedImageIndicesInBuffer.push(parseInt(u))}else{if(m>u){var s=m-u+1;for(var l=0;l<s;l++){n.aryCurrentSelectedImageIndicesInBuffer.push(parseInt(u+l))}}else{var s=u-m+1;n.aryCurrentSelectedImageIndicesInBuffer.push(parseInt(u));for(var l=0;l<s-1;l++){n.aryCurrentSelectedImageIndicesInBuffer.push(parseInt(m+l))}}}}if(n.aryCurrentSelectedImageIndicesInBuffer.length==1){n.__OnlySetCurrentIndex(n.aryCurrentSelectedImageIndicesInBuffer[0]);n.__SetCurrentIndexWithoutSetScroll(n.cCurrentIndex)}n.__SortCurrentSelectedImageIndicesInBuffer();n.__SetUnselectAll();var l=0;for(l=0;l<n.aryCurrentSelectedImageIndicesInBuffer.length;l++){var t=n.GetImageControl(n.aryCurrentSelectedImageIndicesInBuffer[l]);if(null!=t){t.SetSelect(true)}}n.__fireEvent("onSelected",n.aryCurrentSelectedImageIndicesInBuffer)};e.prototype.__SortCurrentSelectedImageIndicesInBuffer=function(){var p=this;var o=p.aryCurrentSelectedImageIndicesInBuffer.length;if(o>1){var n,m,k;var l=false;for(m=0;m<o-1;m++){l=false;for(k=1;k<o;k++){if(p.aryCurrentSelectedImageIndicesInBuffer[k]<p.aryCurrentSelectedImageIndicesInBuffer[k-1]){l=true;n=p.aryCurrentSelectedImageIndicesInBuffer[k-1];p.aryCurrentSelectedImageIndicesInBuffer[k-1]=p.aryCurrentSelectedImageIndicesInBuffer[k];p.aryCurrentSelectedImageIndicesInBuffer[k]=n}}if(!l){return}}}};e.prototype.__RemoveControl=function(i){var k=this;if(i<k.aryImageControls.length&&i>=0){var j=k.aryImageControls[i];j.Destroy();k.aryImageControls.splice(i,1);if(!Dynamsoft.WebTwainEnv.ScanDirectly){if(k.canvas){k.canvas.removeChild(j.GetEL())}}c.imageControlCount--;if(c.imageControlCount<0){c.imageControlCount=0}}};e.prototype.__ConfirmScrollMaxValue=function(){var j=this;if(!j.bSingleMode){if(j.bVerticalMode==true){var i=j.__GetHowManyRows();j.__SetVScrollMaxValue(i,j.imagesPerRow)}else{j.__SetHScrollMaxValue(j.sHowManyImages,j.imagesPerColumn)}}};e.prototype.__GetHowManyRows=function(){var i=this;return parseInt((i.sHowManyImages+i.imagesPerColumn-1)/i.imagesPerColumn)};e.prototype.__ConfirmScrollVisibity=function(){var i=this;if(i.bSingleMode){i.__SetIfHScroll(false);i.__SetIfVScroll(false)}else{if(i.bVerticalMode==false){if(i.bScrollBar&&i.sHowManyImages>i.imagesPerRow*i.imagesPerColumn){i.__SetIfHScroll(true)}else{i.__SetIfHScroll(false)}i.__SetIfVScroll(false)}else{if(i.bScrollBar&&i.sHowManyImages>i.imagesPerRow*i.imagesPerColumn){i.__SetIfVScroll(true)}else{i.__SetIfVScroll(false)}i.__SetIfHScroll(false)}}};e.prototype.__SetCurrentIndex=function(i){var j=this;if(i>=0){j.__SetCurrentIndexInnerInner(i,true,false)}};e.prototype.__SetCurrentIndexInner=function(j,k,i){var l=this;if(!i){l.__SetCurrentIndexInnerInner(j,k,i)}else{l.__SetCurrentIndexInnerInner(j,k,true)}};e.prototype.__SetCurrentIndexWithoutSetScroll=function(i){var j=this;j.__SetCurrentIndexInnerInner(i,true,false,true)};e.prototype.__SetCurrentIndexWithoutRefreshUI=function(i){var j=this;j.__SetCurrentIndexInnerInner(i,true,false)};e.prototype.__SetCurrentIndexInnerInner=function(q,s,v,p){var o=this,k=true;if(q<0||q>=o.aryModelImageControl.length){return}if(o.__bAddingImage&&!o.__IfAutoScroll){k=false}if(k){if(o.bVerticalMode==true){var t=o.iCurrentRow;o.iCurrentRow=o.__GetRow(q);if(o.iCurrentRow!=t&&(o.iCurrentRow<=o.iOldFirstVisibleRow||((o.iCurrentRow-o.iOldFirstVisibleRow)>=o.imagesPerRow))){if((o.iCurrentRow-o.iOldFirstVisibleRow)==o.imagesPerRow){if(v==false){o.iCurrentRow=o.iOldFirstVisibleRow+1}}if(o.bSingleMode==false){if(!p||p==false){var n=o.iCurrentRow;o.__SetVScrollPotion(n)}}var l=o.__GetFirstVisibleRow();if(o.iOldFirstVisibleRow!=l){o.iOldFirstVisibleRow=l;var r=l*o.imagesPerColumn;o.__fireEvent("OnTopImageInTheViewChanged",r);o.__AttachImages(false)}}}else{var m=o.iCurrentColumn;o.iCurrentColumn=q;if(o.iCurrentColumn!=m&&(o.iCurrentColumn<o.iOldFirstVisibleColum||((o.iCurrentColumn-o.iOldFirstVisibleColum)>=o.imagesPerColumn))){if((o.iCurrentColumn-o.iOldFirstVisibleColum)==o.imagesPerColumn){o.iCurrentColumn=o.iOldFirstVisibleColum+1}if(o.bSingleMode==false){if(!p||p==false){var j=o.iCurrentColumn;o.__SetHScrollPotion(j)}}var i=o.__GetFirstVisibleColumn();if(o.iOldFirstVisibleColum!=i){o.iOldFirstVisibleColum=i;var r=i;o.__fireEvent("OnTopImageInTheViewChanged",r);o.__AttachImages(false)}}}}if(s){o.__SetUnselectAll();o.__OnlySetCurrentIndex(q);var u=o.GetImageControl(o.cCurrentIndex);if(null!=u){u.SetSelect(true)}}};e.prototype.__SetScrollByIndex=function(o){var n=this;if(n.bVerticalMode==true){var q=n.iCurrentRow;n.iCurrentRow=n.__GetRow(o);if(n.iCurrentRow!=q&&(n.iCurrentRow<=n.iOldFirstVisibleRow||((n.iCurrentRow-n.iOldFirstVisibleRow)>=n.imagesPerRow))){if((n.iCurrentRow-n.iOldFirstVisibleRow)==n.imagesPerRow){}if(n.bSingleMode==false){var l=n.iCurrentRow;n.__SetVScrollPotion(l)}var k=n.__GetFirstVisibleRow();if(n.iOldFirstVisibleRow!=k){n.iOldFirstVisibleRow=k;var p=k*n.imagesPerColumn;n.__fireEvent("OnTopImageInTheViewChanged",p);n.__AttachImages(false)}}}else{var m=n.iCurrentColumn;n.iCurrentColumn=o;if(n.iCurrentColumn!=m&&(n.iCurrentColumn<n.iOldFirstVisibleColum||((n.iCurrentColumn-n.iOldFirstVisibleColum)>=n.imagesPerColumn))){if((n.iCurrentColumn-n.iOldFirstVisibleColum)==n.imagesPerColumn){n.iCurrentColumn=n.iOldFirstVisibleColum+1}if(n.bSingleMode==false){var j=n.iCurrentColumn;n.__SetHScrollPotion(j)}var i=n.__GetFirstVisibleColumn();if(n.iOldFirstVisibleColum!=i){n.iOldFirstVisibleColum=i;var p=i;n.__fireEvent("OnTopImageInTheViewChanged",p);n.__AttachImages(false)}}}};e.prototype.__GetRow=function(i){var j=this;return parseInt(i/j.imagesPerColumn)};e.prototype.__GetFirstVisibleColumn=function(){var i=this;return parseInt(i.__GetVisibleRow(i.__GetHScrollPosionValue()))};e.prototype.__GetFirstVisibleRow=function(){var i=this;return parseInt(i.__GetVisibleRow(i.__GetVScrollPosionValue()))};e.prototype.__GetVisibleRow=function(k){var j=this;if(j.__GetHowManyRows()==0){return 0}var i=k;if(j.bSingleMode){return j.cCurrentIndex}else{if(j.bVerticalMode==true){if(j.__GetHowManyRows()-i<j.imagesPerRow){i=i-(j.imagesPerRow-(j.__GetHowManyRows()-i))}}else{if(j.sHowManyImages-i<j.imagesPerColumn){i=i-(j.imagesPerColumn-(j.sHowManyImages-i))}}}if(i<0){i=0}return i};e.prototype.__AttachImages=function(k,j,i){var l=this;l.__AttachImagesInner(k,true,j,i)};e.prototype.__AttachImagesInner=function(p,q,j,l){var o=this;if(o.aryImageControls&&o.aryImageControls.length>0){var r=0;if(o.bVerticalMode==true){r=o.__GetFirstVisibleRow()*o.imagesPerColumn}else{r=o.__GetFirstVisibleColumn()}if(r<0){r=0}var m=0;var k=r;var u=r+o.aryImageControls.length-1;if(j&&j>0){k=j}if(l&&l>0){u=l}for(m=0;m<o.aryImageControls.length;m++){var s=o.aryImageControls[m];if(s){var n=r+m;f.output(o,"__AttachImagesInner(baseIndex, index): "+[r,n].join(","));if(n<o.sHowManyImages){if(p){o.__InitImageControl(s)}if(q){var t=o.aryModelImageControl[n];if(n>=k&&n<=u||t.bIsDirty==true||s.GetCurrentIndex()!=n){f.output(o,"__AttachImagesInner() attach Image index -> control index:"+[n,m].join("->"));o.__GetImageAndAttach(s,t,n,false)}}s.SetVisible(true);f.output(o,"__AttachImagesInner() set control index Visible:"+[m].join());if(o.__IfContains(o.aryCurrentSelectedImageIndicesInBuffer,n)){f.output(o,"__AttachImagesInner() set control index selected:"+[m].join());s.SetSelect(true)}else{s.SetSelect(false)}}else{f.output(o,"__AttachImagesInner() set control index InVisible:"+[m].join());s.SetVisible(false)}}}}};e.prototype.__IfContains=function(l,k){var j=0;if(l){for(j=0;j<l.length;j++){if(l[j]==k){return true}}}return false};e.prototype.__ReInitChildrenPosition=function(){var n=this,k=0,m=0,l;n.__InitControlsSize();if(!n.bSingleMode){k=n.ImageMargin;m=n.ImageMargin}for(l=0;l<n.aryImageControls.length;l++){var j=n.aryImageControls[l];j.ChangeControlSize(n.iControlWidth,n.iControlHeight);if(n.bSingleMode){j.SetLocation(0,0)}else{j.SetLocation(k,m);k=j.Right+n.ImageMargin;if(n.bVerticalMode==true){if((l+1)%n.imagesPerColumn==0){k=n.ImageMargin;m=j.Bottom+n.ImageMargin;if(n.bScrollBar==false){if((m+iControlHeight)>n.imageViewHeight){m=n.ImageMargin}}}}}}};e.prototype.__InitControlsSize=function(){var o=this;if(o.bSingleMode==false){var j=o.__GetScrollWidth();if(o.bVerticalMode==true){if(o.__GetHowManyRows()<=o.imagesPerRow||o.bScrollBar==false){j=0}if(o.ImageMargin<=0||(o.ImageMargin>(o.imageViewWidth-j-3*o.imagesPerColumn))||(o.ImageMargin>(o.imageViewHeight-3*o.imagesPerRow))){var m=parseInt(o.imageViewHeight/(o.imagesPerRow*10));var n=parseInt((o.imageViewWidth-j)/(o.imagesPerColumn*10));var l=m<n?m:n;if(o.ImageMargin<=0){o.ImageMargin=parseInt(l)}else{o.ImageMargin=parseInt(o.ImageMargin<l?o.ImageMargin:l)}}}else{if(o.sHowManyImages<=o.imagesPerColumn||o.bScrollBar==false){j=0}if(o.ImageMargin<=0||(o.ImageMargin>(o.imageViewWidth-3*o.imagesPerColumn))||(o.ImageMargin>(o.imageViewHeight-j-3*o.imagesPerRow))){var m=parseInt(o.imageViewHeight-j)/(o.imagesPerRow*10);var n=parseInt((o.imageViewWidth)/(o.imagesPerColumn*10));var l=m<n?m:n;if(o.ImageMargin<=0){o.ImageMargin=parseInt(l)}else{o.ImageMargin=parseInt(o.ImageMargin<l?o.ImageMargin:l)}}}if(o.imagesPerColumn==o.imagesPerRow&&o.imagesPerRow==1){o.ImageMargin=0}var i=0;var k=0;if(o.bVerticalMode==true){i=o.imageViewHeight-o.ImageMargin-2*o.borderWidth;k=o.imageViewWidth-j-o.ImageMargin-2*o.borderWidth}else{i=o.imageViewHeight-j-o.ImageMargin-2*o.borderWidth;k=o.imageViewWidth-o.ImageMargin-2*o.borderWidth}o.iControlWidth=parseInt(k/o.imagesPerColumn-o.ImageMargin);o.iControlHeight=parseInt(i/o.imagesPerRow-o.ImageMargin)}else{o.ImageMargin=0;o.iControlWidth=o.imageViewWidth-2*o.borderWidth;o.iControlHeight=o.imageViewHeight-2*o.borderWidth}};e.prototype.GetDataImageControlList=function(){var i=this;return i.aryModelImageControl};e.prototype.SetDataImageControl=function(j,l){var m=this;if(j>m.aryModelImageControl.length||m.aryModelImageControl.length<=0){return}var k;if(j==m.aryModelImageControl.length){k=new c.UI.ModelImageControl();k.imageIndex=j;k.rawWidth=l;m.aryModelImageControl.push(k)}else{k=m.aryModelImageControl[j];k.rawWidth=l}if(k!=null){k.bIsDirty=true}var i=m.GetImageControl(j);if(null!=i){m.__GetImageAndAttach(i,k,j,true)}return true};e.prototype.AttachImagesForControl=function(i,k,j){if(i.GetBindIndex()==j){i.AttachImage(k.imageToShow,k.imageWidth,k.imageHeight,k.imageIndex,k.aryOverlayRectangleData,k.bOriginalImage);i.Show()}return true};e.prototype.__SetSelectionWinBorderColor=function(i){var j=this};e.prototype.__SetUnselectAll=function(){var l=this;var k=0;for(k=0;k<l.aryImageControls.length;k++){var j=l.aryImageControls[k];j.SetSelect(false)}};e.prototype.GetImageControl=function(k){var l=this;var j=l.__GetImageControlIndex(k);if(j>=0&&j<l.aryImageControls.length){var i=l.aryImageControls[j];return i}else{return null}};e.prototype.__GetImageControlIndex=function(j){var k=this;var i=-1;if(k.bSingleMode==true){i=0}else{if(k.bVerticalMode==true){i=j-k.__GetFirstVisibleRow()*k.imagesPerColumn}else{i=j-k.__GetFirstVisibleColumn()}}if(i>=0&&i<k.aryImageControls.length){return i}else{return -1}};e.prototype.__SetIfHScroll=function(i){var j=this;f.output(j,"__SetIfHScroll"+i);if(j.horizontalScrollBar){j.horizontalScrollBar.SetVisible(i)}};e.prototype.__GetIfHScroll=function(){var i=this;if(i.horizontalScrollBar){return i.horizontalScrollBar.GetVisible()==true?true:false}else{return true}};e.prototype.__SetIfVScroll=function(i){var j=this;f.output(j,"__SetIfVScroll"+i);if(j.verticalScrollBar){j.verticalScrollBar.SetVisible(i)}};e.prototype.__GetIfVScroll=function(){var i=this;if(i.verticalScrollBar){return i.verticalScrollBar.GetVisible()==true?true:false}else{return true}};e.prototype.__GetHScrollPosionValue=function(){var j=this;var i=0;if(j.horizontalScrollBar){i=j.horizontalScrollBar.GetCurrentPosition()}if(i&&i>=0){return i}else{return 0}};e.prototype.__GetVScrollPosionValue=function(){var j=this;var i=0;if(j.verticalScrollBar){i=j.verticalScrollBar.GetCurrentPosition()}if(i&&i>=0){return i}else{return 0}};e.prototype.__SetHScrollMaxValue=function(j,i){var k=this;f.output(k,"__SetHScrollMaxValue(totalSize,pageSize):"+j+","+i);if(k.horizontalScrollBar){k.horizontalScrollBar.InitScroll(j,i)}};e.prototype.__SetVScrollMaxValue=function(j,i){var k=this;f.output(k,"__SetVScrollMaxValue(totalSize,pageSize):"+j+","+i);if(k.verticalScrollBar){k.verticalScrollBar.InitScroll(j,i)}};e.prototype.__SetHScrollPotion=function(i){var j=this;if(j.horizontalScrollBar){j.horizontalScrollBar.GoPosition(i)}};e.prototype.__SetVScrollPotion=function(i){var j=this;if(j.verticalScrollBar){j.verticalScrollBar.GoPosition(i)}};e.prototype.__SetHLocation=function(i,k){var j=this;if(j.horizontalScrollBar){j.horizontalScrollBar.SetLocation(i,k)}};e.prototype.__SetVLocation=function(i,k){var j=this;if(j.verticalScrollBar){j.verticalScrollBar.SetLocation(i,k)}};e.prototype.__ChangeHControlSize=function(i,j){var k=this;if(k.horizontalScrollBar){k.horizontalScrollBar.ChangeControlSize(i,j)}};e.prototype.__ChangeVControlSize=function(i,j){var k=this;if(k.verticalScrollBar){k.verticalScrollBar.ChangeControlSize(i,j)}};e.prototype.__GetScrollWidth=function(){return 16};e.prototype.SetSelectedImageArea=function(k,n,m,l,j){var o=this;var i=o.GetImageControl(k);if(null!=i){if(o.imagesPerRow==1&&o.imagesPerColumn==1){return i.SetSelectedImageArea(n,m,l,j)}else{return false}}return false};e.prototype.OverlayRectangle=function(r,n,m,q,k,j,l){var o=this;var p=o.GetImageControl(r);if(null!=p){p.OverlayRectangle(n,m,q,k,j,l)}var s=o.aryModelImageControl[r];var i=new b(n,m,q,k,j,l);return s.aryOverlayRectangleData.push(i)};e.prototype.GetMousePosition=function(){var j=this;var i=j.GetImageControl(j.cCurrentIndex);if(null!=i){return i.GetMousePosition()}else{return null}};e.prototype.ChangeImageViewSize=function(i,j){var k=this;if(i>=0){k.imageViewWidth=i;k.__ChangeHControlSize(i,16);k.__SetVLocation(i-k.__GetScrollWidth(),0)}if(j>=0){k.imageViewHeight=j;k.__ChangeVControlSize(16,j);k.__SetHLocation(0,j-k.__GetScrollWidth())}if(k.canvas){k.canvas.style.width=i+"px";k.canvas.style.height=j+"px"}k.UpdateAllImage(k.aryModelImageControl,k.cCurrentIndex);return true};e.prototype.SetViewMode=function(r,k){var n=this;var l=n.imagesPerColumn;var o=n.imagesPerRow;var s=n.bSingleMode;var j=n.bVerticalMode;if(r>0){n.imagesPerColumn=r}if(k>0){n.imagesPerRow=k}if(r==-1&&k==-1){n.imagesPerRow=1;n.imagesPerColumn=1;n.bSingleMode=true}else{n.bSingleMode=false;if(k==-1){n.imagesPerRow=1;n.bVerticalMode=false}else{n.bVerticalMode=true}}n.iOldFirstVisibleRow=0;n.iOldFirstVisibleColum=0;if(n.bSingleMode==false){var m=0;for(m=0;m<n.aryImageControls.length;m++){var p=n.aryImageControls[m];if(p!=null){p.SetOrigMode(false)}}}if((l!=n.imagesPerColumn||o!=n.imagesPerRow)||(s!=n.bSingleMode)||(j!=n.bVerticalMode)){if(n.imagesPerRow==1&&n.imagesPerColumn==1){var m=0;for(m=0;m<n.aryImageControls.length;m++){var p=n.aryImageControls[m];if(p!=null){p.ClearControl()}}}if(n.aryCurrentSelectedImageIndicesInBuffer.length>0){var q=n.aryCurrentSelectedImageIndicesInBuffer[0];if(q>=0&&q<n.aryModelImageControl.length){n.cCurrentIndex=q}}n.UpdateAllImageInner(n.aryModelImageControl,n.cCurrentIndex,true)}n.__SetUnselectAll();n.__SetSelectedImageIndicesInBuffer();return true};e.prototype.RemoveAllImages=function(){return this.Clear()};e.prototype.Clear=function(){var m=this;var k=m.aryImageControls.length;for(j=k-1;j>=0;j--){m.__RemoveControl(j)}var j=0;for(j=0;j<m.aryModelImageControl.length;j++){m.aryModelImageControl[j].Clear()}m.aryModelImageControl=[];if(!Dynamsoft.WebTwainEnv.ScanDirectly){m.__SetVScrollMaxValue(0,0);m.__SetHScrollMaxValue(0,0);m.__SetIfHScroll(false);m.__SetIfVScroll(false)}for(j=c.aryControlLoadImage.length-1;j>=0;j--){var l=c.aryControlLoadImage[j];if(l.imgControl&&l.View==m){l.imgControl.SetBindIndex(-1);l.imgControl.Destroy();c.aryControlLoadImage.splice(j,1)}}m.cCurrentIndex=-1;return true};e.prototype.ShowImage=function(j,k){var l=this;l.__OnlySetCurrentIndex(j);if(l.bSingleMode==true){var i=l.GetImageControl(l.cCurrentIndex);if(null!=i){l.__GetImageAndAttach(i,k,j,false)}}return true};e.prototype.__GetImageAndAttach=function(q,n,k,m){var o=this;var j=parseInt(o.imageViewWidth/2);var i=parseInt(o.imageViewHeight/2);if(o.imagesPerRow==1&&o.imagesPerColumn==1){if(o.bSingleMode==true){j=-1;i=-1;n.bOriginalImage=true}else{j=o.imageViewWidth;i=o.imageViewHeight;n.bOriginalImage=false}}else{if(j<300){j=300}if(i<300){i=300}n.bOriginalImage=false}var p=false;if(m){p=true}else{if(n.bIsDirty==true||n.iImageControlWidth<j||n.iImageControlHeight<i||(n.iImageControlWidth>0&&j==-1)||(n.iImageControlHeight>0&&i==-1)){p=true}else{p=false}}q.ClearImage();q.SetCurrentIndex(k);var l=o.__GetImageControlIndex(k);if(l>=0){o.__SetArrayControlLoadImage(l,k,q,n,j,i,o.AttachImagesForControl,p)}};e.prototype.__SetArrayControlLoadImage=function(m,l,s,p,k,j,r,n){var q=this;var o=0;for(o=0;o<c.aryControlLoadImage.length;o++){var t=c.aryControlLoadImage[o];if(t.iControlIndex==m&&t.View==q){t.iImageIndex=l;t.imgControl=s;t.modelImageControl=p;t.iWidth=k;t.iHeight=j;t.AttachImagesForControl=r;t.bOnlyFromServer=n;return}}c.aryControlLoadImage.push(new h(m,l,q,s,p,k,j,r,n,q.BaseUrl))};e.prototype.SetIfFitWindowAndType=function(j){var k=this;if(k.bSingleMode==true){k.bIfFitWindow=true;k.enumDWTFitWindowType=j;var i=k.GetImageControl(k.cCurrentIndex);if(null!=i){i.SetIfFitWindow(true,j);k.fZoom=i.GetZoom();i.Show()}}else{k.bIfFitWindow=true}return true};e.prototype.GetAllowMultiSelect=function(){var i=this;return i.AllowMultiSelect};e.prototype.SetAllowMultiSelect=function(i){var j=this;j.AllowMultiSelect=i;return true};e.prototype.GetFitWindowType=function(){var i=this;return i.enumDWTFitWindowType};e.prototype.SetSelectionRectAspectRatio=function(i){var j=this;j.ratio=i;j.__AttachImagesInner(true,false);return true};e.prototype.SetFitWindowType=function(i){var j=this;j.enumDWTFitWindowType=i;if(j.bSingleMode){j.__AttachImagesInner(true,false)}else{j.bIfFitWindow=true;j.enumDWTFitWindowType=0}return true};e.prototype.GetIfFitWindow=function(){var i=this;return i.bIfFitWindow};e.prototype.SetIfFitWindow=function(i){var j=this;j.bIfFitWindow=i;if(j.bSingleMode){j.__AttachImagesInner(true,false)}else{j.bIfFitWindow=true;j.enumDWTFitWindowType=0}return true};e.prototype.GetImageMargin=function(){var i=this;return i.ImageMargin};e.prototype.SetImageMargin=function(i){var j=this;j.ImageMargin=i;j.__ReInitChildrenPosition();j.__AttachImagesInner(false,false);return true};e.prototype.GetSelectionImageBorderColor=function(){var i=this;return i.SelectionImageBorderColor};e.prototype.SetSelectionImageBorderColor=function(i){var j=this;j.SelectionImageBorderColor=i;j.__AttachImagesInner(true,false);return true};e.prototype.GetZoom=function(){var j=this;if(j.bIfFitWindow){var i=j.GetImageControl(j.cCurrentIndex);if(null!=i){return i.GetZoom()}}return j.fZoom};e.prototype.SetZoom=function(k){var j=this;if(k<j.MIN_ZOOM){k=j.MIN_ZOOM}if(k>j.MAX_ZOOM){k=j.MAX_ZOOM}j.fZoom=k;if(j.bSingleMode==true){j.bIfFitWindow=false;j.enumDWTFitWindowType=0;var i=j.GetImageControl(j.cCurrentIndex);if(null!=i){i.SetZoom(j.fZoom)}}else{j.bIfFitWindow=true}return true};e.prototype.ZoomIn=function(){var m=this;if(m.bSingleMode==true){var l=15000;var j=m.aryModelImageControl[m.cCurrentIndex];var k=m.fZoom;if(m.bIfFitWindow){var i=m.GetImageControl(m.cCurrentIndex);if(null!=i){k=i.GetZoom()}}tempZoom=(Math.floor(k*100*m.zoomInStep)+1);if(1<tempZoom&&tempZoom<2501){if(parseInt(j.imageWidth*m.fZoom)>l||parseInt(j.imageHeight*m.fZoom)>l){f.output(m,"You have reached the limit for zooming in");return false}else{m.SetZoom(tempZoom/100)}}else{f.output(m,"You have reached the limit for zooming in");alert("You have reached the limit for zooming in");return false}}return true};e.prototype.ZoomOut=function(){var l=this;if(l.bSingleMode==true){var j=l.fZoom;if(l.bIfFitWindow){var i=l.GetImageControl(l.cCurrentIndex);if(null!=i){j=i.GetZoom()}}var k=(Math.floor(j*100*l.zoomOutStep)-1);if(1<k&&k<6501){l.SetZoom(k/100)}else{f.output(l,"You have reached the limit for zooming out");return false}}return true};e.prototype.GetMouseShape=function(){var i=this;return i.iMouseShape};e.prototype.SetMouseShape=function(i){var j=this;j.iMouseShape=i;j.__AttachImagesInner(true,false);return true};e.prototype.SetMouseShapeByIndex=function(j,k){var l=this;l.__OnlySetCurrentIndex(j);l.iMouseShape=k;var i=l.GetImageControl(j);if(null!=i){i.SetMouseShape(l.iMouseShape);i.Show();return true}return false};e.prototype.GetShowPageNumber=function(){var i=this;return i.bShowPageNumber};e.prototype.SetShowPageNumber=function(i){var j=this;j.bShowPageNumber=i;j.__AttachImagesInner(true,false);return true};e.prototype.SetBackgroundColor=function(i){var j=this;j.BackgroundColor=i;if(j.canvas){j.canvas.style.backgroundColor=i}j.__AttachImagesInner(true,false);return true};e.prototype.Go=function(i){var j=this;j.__GoInner(i,true,false);return true};e.prototype.SetCurrentIndexOnly=function(i){var j=this;return j.__GoInner(i,true,false)};e.prototype.__GoInner=function(n,q,r){var l=this,p=l.cCurrentIndex;if(n<l.aryModelImageControl.length&&n>=0){if(r==false){l.__OnlySetCurrentIndex(n)}if(q==true){if(r==true){l.__SetCurrentIndex(l.cCurrentIndex)}else{l.__SetCurrentIndexWithoutRefreshUI(l.cCurrentIndex)}}if(r==true){l.__AttachImages(false)}l.iCurrentRow=-1;l.iCurrentColumn=-1;if(q==false){if(l.bVerticalMode==true){var o=l.iCurrentRow;l.iCurrentRow=l.__GetRow(n);if(l.iCurrentRow!=o&&(l.iCurrentRow<=l.iOldFirstVisibleRow||(l.iCurrentRow>l.iOldFirstVisibleRow))){var j=l.__GetFirstVisibleRow();if(l.iOldFirstVisibleRow!=j){l.iOldFirstVisibleRow=j;var m=j*l.imagesPerColumn;l.__fireEvent("OnTopImageInTheViewChanged",m)}}}else{var k=l.iCurrentColumn;l.iCurrentColumn=n;if(l.iCurrentColumn!=k&&(l.iCurrentColumn<l.iOldFirstVisibleColum||(l.iCurrentColumn>l.iOldFirstVisibleColum))){var i=l.__GetFirstVisibleColumn();if(l.iOldFirstVisibleColum!=i){l.iOldFirstVisibleColum=i;var m=i;l.__fireEvent("OnTopImageInTheViewChanged",m)}}}}}return true};e.prototype.SetSelectedImageCount=function(i){var j=this;j.aryCurrentSelectedImageIndicesInBuffer.splice(i);j.__SetUnselectAll();j.__SetSelectedImageIndicesInBuffer();return true};e.prototype.SetSelectedImageIndex=function(n,m){var p=this;p.aryCurrentSelectedImageIndicesInBuffer[n]=m;p.__SetUnselectAll();p.__SetSelectedImageIndicesInBuffer();var k=-1,j=p.aryCurrentSelectedImageIndicesInBuffer.length,o;for(var l=0;l<j;l++){var o=p.aryCurrentSelectedImageIndicesInBuffer[l];if(k==-1){k=o}else{if(o<k){k=o}}}if(k>=0&&k<p.aryModelImageControl.length&&p.cCurrentIndex!=k){p.cCurrentIndex=k;p.__fireEvent("onResetCurrentIndex",p.cCurrentIndex)}return true};e.prototype.__SetSelectedImageIndicesInBuffer=function(){var m=this;if(m.aryCurrentSelectedImageIndicesInBuffer.length==0){if(m.cCurrentIndex>=0){m.aryCurrentSelectedImageIndicesInBuffer.push(m.cCurrentIndex)}}var k=0;for(k=0;k<m.aryCurrentSelectedImageIndicesInBuffer.length;k++){var l=m.aryCurrentSelectedImageIndicesInBuffer[k];var j=m.GetImageControl(l);if(null!=j){j.SetSelect(true);j.Show()}}};e.prototype.__OnlySetCurrentIndex=function(i){var k=this,j=k.cCurrentIndex;k.cCurrentIndex=i;if(j!=i){k.__fireEvent("onResetCurrentIndex",i)}if(k.aryCurrentSelectedImageIndicesInBuffer[0]!=k.cCurrentIndex){k.aryCurrentSelectedImageIndicesInBuffer=[];k.aryCurrentSelectedImageIndicesInBuffer.push(k.cCurrentIndex)}};e.prototype.__MousewheelChanged=function(i){if(i.__MousewheelValue>0){i.__MousewheelUp(i.__MousewheelValue)}else{if(i.__MousewheelValue<0){i.__MousewheelDown(-i.__MousewheelValue)}}i.__MousewheelValue=0};e.prototype.__MousewheelUp=function(l){var m=this;if(m.bSingleMode==false){if(m.__GetIfHScroll()==true||m.__GetIfVScroll()==true){var j=0,k=0;if(m.bVerticalMode==true){j=m.__GetFirstVisibleRow()*m.imagesPerColumn;k=j-l*m.imagesPerColumn}else{j=m.__GetFirstVisibleColumn();k=j-l}if(k<0){k=0}f.output(m,"__MousewheelUp(baseIndex, index): "+[j,k].join(","));m.__SetScrollByIndex(k)}}else{var i=m.GetImageControl(m.cCurrentIndex);if(null!=i){i.ImageMoveUp()}}};e.prototype.__MousewheelDown=function(l){var m=this;if(m.bSingleMode==false){if(m.__GetIfHScroll()==true||m.__GetIfVScroll()==true){var j=0,k=0;if(m.bVerticalMode==true){j=m.__GetFirstVisibleRow()*m.imagesPerColumn;k=j+l*m.imagesPerColumn}else{j=m.__GetFirstVisibleColumn();k=j+l}if(j+m.imagesPerColumn*m.imagesPerRow<m.aryModelImageControl.length){f.output(m,"__MousewheelDown(baseIndex, index): "+[j,k].join(","));m.__SetScrollByIndex(k,true)}}}else{var i=m.GetImageControl(m.cCurrentIndex);if(null!=i){i.ImageMoveDown()}}};e.prototype.__Previous=function(){var i=this;i.Go(i.cCurrentIndex-1);return true};e.prototype.__DoLeftArrow=function(){var j=this;if(j.bSingleMode==false){j.Go(j.cCurrentIndex-1)}else{var i=j.GetImageControl(j.cCurrentIndex);if(null!=i){i.ImageMoveLeft()}}return true};e.prototype.__Next=function(){var i=this;i.Go(i.cCurrentIndex+1);return true};e.prototype.__DoRightArrow=function(){var j=this;if(j.bSingleMode==false){j.__SetCurrentIndexInner(j.cCurrentIndex+1,true)}else{var i=j.GetImageControl(j.cCurrentIndex);if(null!=i){i.ImageMoveRight()}}return true};e.prototype.__PreviousUp=function(){var k=this;if(k.bSingleMode==false){var j=k.cCurrentIndex-k.imagesPerColumn;if(j>=0){k.Go(j)}}else{var i=k.GetImageControl(k.cCurrentIndex);if(null!=i){i.ImageMoveUp()}}return true};e.prototype.__NextDown=function(){var k=this;if(k.bSingleMode==false){var j=k.cCurrentIndex+k.imagesPerColumn;if(j<k.aryModelImageControl.length){k.__SetCurrentIndexInner(j,true)}}else{var i=k.GetImageControl(k.cCurrentIndex);if(null!=i){i.ImageMoveDown()}}return true};e.prototype.__PageUp=function(){var l=this;if(l.bSingleMode==false){if(l.bVerticalMode==true){var j=l.__GetFirstVisibleRow()*l.imagesPerColumn;var k=j-l.imagesPerColumn*l.imagesPerRow;if(k>=0){l.__SetCurrentIndexInner(k,false)}else{l.__SetCurrentIndexInner(0,false)}}else{}}else{var i=l.GetImageControl(l.cCurrentIndex);if(null!=i){i.ImageMovePageUp()}}return true};e.prototype.__PageDown=function(){var l=this;if(l.bSingleMode==false){if(l.bVerticalMode==true){var j=l.__GetFirstVisibleRow()*l.imagesPerColumn;var k=j+l.imagesPerColumn*l.imagesPerRow;if(k<l.aryModelImageControl.length){l.__SetCurrentIndexInner(k,false)}else{l.__SetCurrentIndexInner(l.aryModelImageControl.length-1,false,false)}}else{}}else{var i=l.GetImageControl(l.cCurrentIndex);if(null!=i){i.ImageMovePageDown()}}return true};e.prototype.__Home=function(){var j=this;if(j.bSingleMode==false){j.__SetCurrentIndexInner(0,false)}else{var i=j.GetImageControl(j.cCurrentIndex);if(null!=i){i.ImageMoveHome()}}return true};e.prototype.__End=function(){var j=this;if(j.bSingleMode==false){j.__SetCurrentIndexInner(j.aryModelImageControl.length-1,false)}else{var i=j.GetImageControl(j.cCurrentIndex);if(null!=i){i.ImageMoveEnd()}}return true};e.prototype.__fireEvent=function(i,j){var k=this;if(c.isFunction(k[i])){return k[i](j)}return true};e.prototype.AddImage=function(m,k,q){var n=this,o=m*1,p,r,l,j;r=n.GetDataImageControlList();p=r.length;if(o<0||o>k){return false}l=o;for(;l<p;l++){j=r[l];j.imageIndex=(l+1)}j=new c.UI.ModelImageControl();j.bIsDirty=true;j.rawWidth=q;if(o>=p){j.imageIndex=p;o=p;r.push(j)}else{j.imageIndex=o;r.splice(o,0,j)}n.__bAddingImage=true;n.UpdateAllImage(r,o,o,p);n.__bAddingImage=false;return true};e.prototype.RemoveImage=function(l,j){var n=this,o=l*1,q=j*1,p,s,r;if(typeof(o)==="undefined"||o<0){return}s=n.GetDataImageControlList();p=s.length;if(p==1){n.RemoveAllImages();return}if(o>=p){o=p-1}else{var m=o,k;for(;m<s.length;m++){k=s[m];k.imageIndex=(m-1)}}r=s.splice(o,1);if(r&&r[0]){r[0].Clear()}n.UpdateAllImage(s,q,o,p-2);return true};e.prototype.MoveImage=function(k,s){var n=this,q,r,m,l,p,o,j;r=n.GetDataImageControlList();q=r.length;m=k;p=r[k];for(;m<r.length;m++){l=r[m];l.imageIndex=(m-1)}r.splice(k,1);m=s;for(;m<r.length;m++){l=r[m];l.imageIndex=(m+1)}r.splice(s,0,p);p.imageIndex=s;if(k<s){o=k;j=s}else{o=s;j=k}n.UpdateAllImage(r,n.GetCurrentImageIndex(),o,j);return true};e.prototype.GetCurrentImageIndex=function(){return this.cCurrentIndex};e.prototype.GetSelectedIndexes=function(){return this.aryCurrentSelectedImageIndicesInBuffer};e.prototype.HowManyImagesInBuffer=function(){return this.GetDataImageControlList().length};e.prototype.SwitchImage=function(k,j){var o=this,i,n,m,l;n=o.GetDataImageControlList();i=n.length;if(k<n.length&&k>=0&&j<n.length&&j>=0){m=n[k];m.imageIndex=j;l=n[j];l.imageIndex=k;n[j]=m;n[k]=l;o.UpdateImage(k,l.imageToShow,l.imageWidth,l.imageHeight,l.aryOverlayRectangleData,l.imageUrl);o.UpdateImage(j,m.imageToShow,m.imageWidth,m.imageHeight,m.aryOverlayRectangleData,m.imageUrl)}return true};e.prototype.GetIfAutoScroll=function(){return this.__IfAutoScroll};e.prototype.SetIfAutoScroll=function(i){this.__IfAutoScroll=i?true:false;return true};e.prototype.handlerKeyDownView=function(j){var k=this,i=true;if(!k.bFocus){return i}k.iCurrentRow=-1;k.iCurrentColumn=-1;switch(j.keyCode){case 37:i=false;k.__DoLeftArrow();break;case 39:i=false;k.__DoRightArrow();break;case 38:i=false;k.__PreviousUp();break;case 40:i=false;k.__NextDown();break;case 33:i=false;k.__PageUp();break;case 34:i=false;k.__PageDown();break;case 35:i=false;k.__End();break;case 36:i=false;k.__Home();break;case 82:break;case 107:k.ZoomIn();break;case 109:k.ZoomOut();break}if(i==false){c.stopPropagation(j)}return i};c.UI=c.UI||{};c.UI.ImageUIView=e;var a=function(j){var i=true;c.each(d,function(k){if(k instanceof c.UI.ImageUIView){if(k.bFocus){i=k.handlerKeyDownView(j);if(!i){return false}}}});return i};c.addEventListener(document.documentElement,"keydown",a);c.aryControlLoadImage=[];c.imageControlCount=0;c.AttachAndShowImage=function(){if(Dynamsoft.WebTwainEnv.ScanDirectly){return}if(c.aryControlLoadImage.length==0){setTimeout(c.AttachAndShowImage,500);return}var l=0;var n=c.aryControlLoadImage[0];c.aryControlLoadImage.splice(0,1);if(n.iControlIndex>=0&&n.iControlIndex<c.imageControlCount){var k=2,j=n.iWidth,m=n.iHeight;if(j>k){j-=k}if(m>k){m-=k}if(n.bOnlyFromServer){c.OnGetImageFromServer(n,n.modelImageControl,n.iImageIndex,j,m,n.BaseUrl,n.AttachImagesForControl)}else{c.OnGetImageByURL(n,n.modelImageControl,n.iImageIndex,j,m,n.BaseUrl,n.AttachImagesForControl)}}else{setTimeout(c.AttachAndShowImage,0)}};c.OnGetImageByURL=function(r,k,n,p,m,o,j){var i,q,l=r.imgControl;if(j){if(k.imageUrl&&k.imageUrl!=""){l.ClearImage();l.SetBindIndex(n);q=new Image();q.src=k.imageUrl;q.onload=function(){l.tmpImage=false;k.imageToShow=q;k.imageWidth=q.width;k.imageHeight=q.height;k.iImageControlWidth=p;k.iImageControlHeight=m;k.bIsDirty=false;j(l,k,n);q.onload=undefined;q.onerror=undefined;setTimeout(c.AttachAndShowImage,0)};q.onerror=function(t){var u=l.GetBindIndex(),v=r.View,s;s=v.GetDataImageControlList().length;if(u>=0&&u<s){q.ready_src=k.imageUrl;setTimeout(function(){if(q.ready_src){q.src=q.ready_src}else{q.src="data:,";q.onload=undefined;q.onerror=undefined;q=null;l.tmpImage=false}q.ready_src=undefined},3000)}else{q.src="data:,";q.onload=undefined;q.onerror=undefined;q=null;l.tmpImage=false;setTimeout(c.AttachAndShowImage,0)}};if(l.tmpImage){l.tmpImage.src="data:,";l.tmpImage.onload=undefined}l.tmpImage=q}else{c.OnGetImageFromServer(r,k,n,p,m,o,j)}}else{setTimeout(c.AttachAndShowImage,0)}return true};c.OnGetImageFromServer=function(r,k,n,p,m,o,j){var i,q,l=r.imgControl;if(j&&o){l.ClearImage();l.SetBindIndex(n);i=f.getImageUrl(o,n,p,m);q=new Image();q.src=i;q.onload=function(){l.tmpImage=false;k.imageToShow=q;k.imageWidth=q.width;k.imageHeight=q.height;k.imageUrl=i;k.iImageControlWidth=p;k.iImageControlHeight=m;k.bIsDirty=false;j(l,k,n);q.onload=undefined;q.onerror=undefined;setTimeout(c.AttachAndShowImage,0)};q.onerror=function(t){var u=l.GetBindIndex(),v=r.View,s;s=v.GetDataImageControlList().length;if(u>=0&&u<s){q.ready_src=f.getImageUrl(o,l.GetBindIndex(),p,m);setTimeout(function(){if(q.ready_src){q.src=q.ready_src}else{q.src="data:,";q.onload=undefined;q.onerror=undefined;q=null;l.tmpImage=false}q.ready_src=undefined},3000)}else{q.src="data:,";q.onload=undefined;q.onerror=undefined;q=null;l.tmpImage=false;setTimeout(c.AttachAndShowImage,0)}};if(l.tmpImage){l.tmpImage.src="data:,";l.tmpImage.onload=undefined}l.tmpImage=q}else{setTimeout(c.AttachAndShowImage,0)}return true};setTimeout(c.AttachAndShowImage,500)})(Dynamsoft.Lib);(function(c){if(!c.product.bChromeEdition){return}var g="eng",e=c.DOM,b={btninfo:["previous","next","","rotateleft","rotate","rotateright","deskew","crop","erase","changeimagesize","flip","mirror","","zoomin","originalsize","zoomout","stretch","fit","fitw","fith","print","","hand","rectselect","zoom","","restore","save"],titlelan:["eng","chi"],titles:[["Previous Image","Next Image","","Rotate Left","Rotate","Rotate Right","Deskew","Crop Selected Area","Erase","Change Image Size","Flip","Mirror","","Zoom In","Original Size","Zoom Out","Stretch Mode","Fit Canvas","Fit Horizontally","Fit Vertically","Print","","Hand","Select","Zoom","","Restore","Save Changes"],["Previous Image","Next Image","","Rotate Left","Rotate","Rotate Right","Deskew","Crop Selected Area","Erase","Change Image Size","Flip","Mirror","","Zoom In","Original Size","Zoom Out","Stretch Mode","Fit Canvas","Fit Horizontally","Fit Vertically","Print","","Hand","Select","Zoom","","Restore","Save Changes"]]},d=c.html5.Funs2,f={isFunction:function(h){return h&&typeof(h)==="function"},init:function(k,i){var l=k,j=i||{},h=Math.floor(Math.random()*100000+1);l.container=j.Container;l.containerWidth=j.width?j.width:0;l.containerHeight=j.height?j.height:0;l.width=l.containerWidth;l.height=l.containerHeight;l.defaultIndex=0;l.bEdit=j.bEdit||false;l.evt_switch=j.evt_switch||"";l.evt_mouseMove=j.evt_mouseMove||"";l.evt_mouseIn=j.evt_mouseIn||"";l.evt_mouseOut=j.evt_mouseOut||"";l.evt_mouseClick=j.evt_mouseClick||"";l.evt_mouseDblClick=j.evt_mouseDblClick||"";l.selectionImageBorderColor=false;l.backgroundColor="rgb(255, 255, 255)";l.onRefreshUI=j.onRefreshUI||false;l.onMouseRightClick=j.onMouseRightClick||false;l.onMouseClick=j.onMouseClick||false;l.onMouseDoubleClick=j.onMouseDoubleClick||false;l.onMouseMove=j.onMouseMove||false},addClass:function(i,h){var j=c.one(i);if(j){j.addClass(h)}},removeClass:function(i,h){var j=c.one(i);if(j){j.removeClass(h)}},__createButton:function(m,i,l,h,k){var j=document.createElement("img");j.src=Dynamsoft.WebTwainEnv.ResourcesPath+"/reference/imgs/"+i+".png";j.className="dynamsoft-dwt-Editor_Buttons_"+i;j.title=l;j.style.width=h+"px";j.style.height=k+"px";this.__btnBindEvents(m,j,i);return j},__btnBindEvents:function(j,i,h){switch(h){case"previous":i.onclick=function(){j.previous_btn()};break;case"next":i.onclick=function(){j.next_btn()};break;case"rotateleft":i.onclick=function(){j.RotateLeft()};break;case"rotate":i.onclick=function(){j.RotateAnyAngle(this)};break;case"rotateright":i.onclick=function(){j.RotateRight()};break;case"deskew":i.onclick=function(){j.Deskew()};break;case"crop":i.onclick=function(){j.Crop_btn()};break;case"erase":i.onclick=function(){j.Erase_btn()};break;case"changeimagesize":i.onclick=function(){j.ChangeImageSizeGetinput(this)};break;case"flip":i.onclick=function(){j.Flip()};break;case"mirror":i.onclick=function(){j.Mirror()};break;case"zoomin":i.onclick=function(){j.ZoomIn()};break;case"originalsize":i.onclick=function(){j.OriginalSize()};break;case"zoomout":i.onclick=function(){j.ZoomOut()};break;case"stretch":i.onclick=function(){j.StrechMode()};break;case"fit":i.onclick=function(){j.FitsWindowSize()};break;case"fitw":i.onclick=function(){j.FitsWindowWidth()};break;case"fith":i.onclick=function(){j.FitsWindowHeight()};break;case"print":i.onclick=function(){j.print()};break;case"hand":i.onclick=function(){j.Hand_btn()};break;case"rectselect":i.onclick=function(){j.RectSelect_btn()};break;case"zoom":i.onclick=function(){j.Zoom_btn()};break;case"restore":i.style.display="none";i.onclick=function(){j.RestoreImage()};break;case"save":i.style.display="none";i.onclick=function(){j.SaveImage()};break}},getToolBar:function(u,k,x){var t=this,s;for(var p=0;p<b.titlelan.length;p++){if(b.titlelan[p]==g){s=b.titles[p];break}else{s=b.titles[0]}}var m=document.createElement("ul"),w,r,q;var n=b.btninfo.length,v=false,l;var h=(k/n-4)>(x-4)?(x-4):(k/n-4);h=Math.floor(h);m.style.paddingTop="2px";for(r=0;r<n;r++){w=document.createElement("li"),_w=h;w.style.floatLeft="true";l=b.btninfo[r];if(l==""){q=document.createElement("span");q.style.paddingLeft=h+"px";w.appendChild(q)}else{if(l=="hand"||l=="rectselect"||l=="zoom"){_w=h-6;v=true}else{v=false}q=t.__createButton(u,l,s[r],_w,_w);if(v){q.style.padding="2px"}w.appendChild(q)}m.appendChild(w)}w=document.createElement("li");w.style["float"]="right";var y=t.__createButton(u,"close","Click to Close Window",h,h);y.onclick=function(){u.CloseImageEditor()};w.appendChild(y);m.appendChild(w);return m},output:function(i,h){if(Dynamsoft.WebTwainEnv.Debug){c.log(h)}}};function a(k,i){var m=this,j=i||{},h,l='<div class="D_ImageUIEditor dynamsoft-dwt-noPaddingnoMarginInside dynamsoft-dwt-thinborder"></div>';m._UIManager=k;m.aryModelImageControl=m.__NewAryModelImageControl(i.aryModelImageControl);m._UIView;m.iControlWidth=0;m.iControlHeight=0;m._stwain=i.stwain;m.BaseUrl=i.BaseUrl;m.cIndex=i.cIndex;m.totalImagesCount=m.aryModelImageControl.length;m._IfImageChanged=false;f.init(m,j);h=m.container;h.append(l);m.UIEditor=h.one(".D_ImageUIEditor");m.bShow=false;m.zoom=1;m.aspectRatio=1;m.__fitWindowType=0;m.toolbar={self:null,filled:false,width:0,height:0};m.Left=0;m.Top=0;m.Right=0;m.Bottom=0;window.onresize=function(){m.ShowImageEditorEx(-1,-1,-1,-1)}}a.prototype.__NewAryModelImageControl=function(k){var n=this;var l=[];var j=0;for(j=0;j<k.length;j++){var h=new c.UI.ModelImageControl(),m=k[j];if(m.bOriginalImage){h.bIsDirty=true;h.imageToShow=null;h.imageWidth=-1;h.imageHeight=-1;h.iImageControlWidth=-1;h.iImageControlHeight=-1}else{h.bIsDirty=m.bIsDirty;h.imageToShow=m.imageToShow;h.imageWidth=m.imageWidth;h.imageHeight=m.imageHeight;h.iImageControlWidth=m.iImageControlWidth;h.iImageControlHeight=m.iImageControlHeight}h.imageIndex=m.imageIndex;h.aryOverlayRectangleData=[];l.push(h)}return l};a.prototype.ShowImageEditorEx=function(i,l,h,k){var j=this;h=window.innerWidth;k=window.innerHeight;i=0;l=0;j.width=h-2;j.height=k-2;j.UIEditor.css({display:"",width:j.width+"px",height:j.height+"px",position:"fixed",left:i,top:l,"z-index":"9999"});j.isFitWindow=true;document.documentElement.scrollLeft=0;document.documentElement.scrollTop=0;document.body.style.overflow="hidden";if(j.toolbar.filled){j.toolbar.filled=false}j.toolbar.width=j.width;j.toolbar.height=Math.ceil(j.height/20<20?20:j.height/20);this.updateEditor();return true};a.prototype.updateEditor=function(){var o=this;f.output(o,'Editor is under mode "'+o.mode+'"');if(o.toolbar.self){if(!o.bShow){return}if(o.toolbar.width+o.toolbar.height==0){f.addClass(o.toolbar.self,"dynamsoft-dwt-notdisplayed")}else{o.toolbar.self.style.width=o.toolbar.width+"px";o.toolbar.self.style.height=o.toolbar.height+"px";if(!o.toolbar.filled){o.toolbar.filled=true;while(o.toolbar.self.firstChild){o.toolbar.self.removeChild(o.toolbar.self.firstChild)}o.toolbar.self.appendChild(f.getToolBar(o,o.toolbar.width,o.toolbar.height));if(o._IfImageChanged){var k=c.one(o.toolbar.self).one(".dynamsoft-dwt-Editor_Buttons_save"),n=c.one(o.toolbar.self).one(".dynamsoft-dwt-Editor_Buttons_restore");k[0].style.display="";n[0].style.display=""}}f.removeClass(o.toolbar.self,"dynamsoft-dwt-notdisplayed");f.removeClass(o.toolbar.self,"dynamsoft-dwt-overlay")}o.iControlWidth=o.width-2;o.iControlHeight=(o.height-o.toolbar.height-2);c.log("ChangeImageViewSize: "+[o.iControlWidth,o.iControlHeight].join(","));o._UIView.ChangeImageViewSize(o.iControlWidth,o.iControlHeight);o.updateMode()}else{var h=(Math.floor(Math.random()*1000+1)).toString();var l,m,j=["D_ImageUIEditor","dynamsoft-dwt-noPaddingnoMarginInside","dynamsoft-dwt-thinborder"];l=document.createElement("div");l.id="dynamsoft-dwt-viewerToolbar"+h;l.style.width=o.toolbar.width+"px";l.style.height=o.toolbar.height+"px";l.style.whiteSpace="normal";l.className="dynamsoft-dwt-viewerToolbar";m=document.createElement("div");m.id="ds-dwt-imageViewer"+h;m.style.width=o.width+"px";m.style.height=(o.height-o.toolbar.height)+"px";m.style.backgroundColor=o.backgroundColor;m.className="ds-dwt-imageViewer";o.UIEditor.css({width:o.width+"px",height:o.height+"px"});o.UIEditor.append(l);o.UIEditor.append(m);o.iControlWidth=o.width-2;o.iControlHeight=(o.height-o.toolbar.height-2);var i={Container:o.container.one(".ds-dwt-imageViewer"),Width:o.iControlWidth,Height:o.iControlHeight,borderWidth:0,aryModelImageControl:o.aryModelImageControl};i.onImageAreaSelected=function(s){c.log("__onImageAreaSelected: "+[s.left,s.top,s.right,s.bottom].join(","));o.Left=s.left;o.Top=s.top;o.Right=s.right;o.Bottom=s.bottom;var r,p,q;r=c.one(o.toolbar.self).one(".dynamsoft-dwt-Editor_Buttons_crop");if(r&&r[0]){q=r[0].src;q=q.replace("crop_grey.","crop.");r[0].src=q;r.style("cursor","pointer")}p=c.one(o.toolbar.self).one(".dynamsoft-dwt-Editor_Buttons_erase");if(p&&p[0]){q=p[0].src;q=q.replace("erase_grey.","erase.");p[0].src=q;p.style("cursor","pointer")}};i.onImageAreaDeSelected=function(){c.log("__onImageAreaDeSelected: ");o.Left=0;o.Top=0;o.Right=0;o.Bottom=0;if(c.one(o.toolbar.self)){o.__SetCropButtonGrey(false);o.__SetEraseButtonGrey(false)}};i.onZoomChanged=function(p){o.__SetZoomInButtonEnable(!p.isMax);o.__SetZoomOutButtonEnable(true);o.__SetCropButtonGrey(true);o.__SetEraseButtonGrey(true)};o._UIView=new c.UI.ImageUIView(i);o._UIView.BaseUrl=o.BaseUrl;o._UIView.cCurrentIndex=o.cIndex;o._UIView.__fireEvent("onResetCurrentIndex",o.cIndex);o._UIView.SetViewMode(-1,-1);o.UIEditor.attr("class",j.join(" "));o.toolbar.self=document.getElementById("dynamsoft-dwt-viewerToolbar"+h);o.updateEditor()}};a.prototype.updateMode=function(k){var l=this,j;var i=c.one(l.toolbar.self).one(".dynamsoft-dwt-Editor_Buttons_next"),h=c.one(l.toolbar.self).one(".dynamsoft-dwt-Editor_Buttons_previous");if(l.totalImagesCount>1){if(i&&i[0]){if(l.cIndex==l.totalImagesCount-1){j=i[0].src;j=j.replace("next.","next_grey.");i[0].src=j;i[0].style.cursor="auto"}else{j=i[0].src;j=j.replace("next_grey.","next.");i[0].src=j;i[0].style.cursor="pointer"}if(l.cIndex==0){j=h[0].src;j=j.replace("previous.","previous_grey.");h[0].src=j;h[0].style.cursor="auto"}else{j=h[0].src;j=j.replace("previous_grey.","previous.");h[0].src=j;h[0].style.cursor="pointer"}}}else{if(i&&i[0]){j=i[0].src;j=j.replace("next.","next_grey.");i[0].src=j;i[0].style.cursor="auto";j=h[0].src;j=j.replace("previous.","previous_grey.");h[0].src=j;h[0].style.cursor="auto"}}l.__SetCropButtonGrey(true);l.__SetEraseButtonGrey(true);l.RectSelect_btn()};a.prototype.CloseImageEditor=function(){var h=this;c.hide("dynamsoft_ImgSizeEditor");c.hide("dynamsoft_RotateAnyAngle");window.onresize=null;if(h._IfImageChanged){h.ShowDialogForSaveImage(-1,true);return}document.body.style.overflow="";h.__HideImageEditorInner();h._UIManager._UIEditor=null;h._UIManager=null;h._stwain=null;h.evt_switch=null;h.evt_mouseMove=null;h.evt_mouseIn=null;h.evt_mouseOut=null;h.evt_mouseClick=null;h.evt_mouseDblClick=null;h.onRefreshUI=false;h.onMouseRightClick=false;h.onMouseClick=false;h.onMouseDoubleClick=false;h.onMouseMove=false};a.prototype.__HideImageEditorInner=function(){var h=this;if(h._UIView){h._UIView.Clear();delete h._UIView;h._UIView=false}h.aryModelImageControl=[];h.UIEditor=null;h.container.remove()};a.prototype.previous_btn=function(){var j=this,h,i=c.one(j.toolbar.self).one(".dynamsoft-dwt-Editor_Buttons_previous");if(i&&i[0]){h=i[0].src;if(h.indexOf("grey")!=-1){return}else{j.previous()}}};a.prototype.next_btn=function(){var j=this,h,i=c.one(j.toolbar.self).one(".dynamsoft-dwt-Editor_Buttons_next");if(i&&i[0]){h=i[0].src;if(h.indexOf("grey")!=-1){return}else{j.next()}}};a.prototype.previous=function(){var h=this;h.go(h.cIndex-1)};a.prototype.next=function(){var h=this;h.go(h.cIndex+1)};a.prototype.go=function(h){var i=this;if(i._IfImageChanged){i.ShowDialogForSaveImage(h,false);return}i.__goInner(h)};a.prototype.__goInner=function(k){var l=this;if(typeof(k)!=="undefined"){if(k<0||k>=l.totalImagesCount){return}l.cIndex=k;if(l._UIView){l._UIView.ShowImage(k,l.aryModelImageControl[l.cIndex])}l._UIManager.getView().SetCurrentIndexOnly(k)}var i=c.one(l.toolbar.self).one(".dynamsoft-dwt-Editor_Buttons_previous"),h=c.one(l.toolbar.self).one(".dynamsoft-dwt-Editor_Buttons_next");if(k==0){if(i&&i[0]){var j=i[0].src;j=j.replace("previous.","previous_grey.");i[0].src=j;i[0].style.cursor="auto";if(l.totalImagesCount>1){j=h[0].src;j=j.replace("next_grey.","next.");h[0].src=j;h[0].style.cursor="pointer"}}}else{if(k==l.totalImagesCount-1){if(h&&h[0]){var j=h[0].src;j=j.replace("next.","next_grey.");h[0].src=j;h[0].style.cursor="auto";if(l.totalImagesCount>1){j=i[0].src;j=j.replace("previous_grey.","previous.");i[0].src=j;i[0].style.cursor="pointer"}}}else{if(l.totalImagesCount>1){if(i&&i[0]){var j=i[0].src;j=j.replace("previous_grey.","previous.");i[0].src=j;i[0].style.cursor="pointer"}if(h&&h[0]){var j=h[0].src;j=j.replace("next_grey.","next.");h[0].src=j;h[0].style.cursor="pointer"}}}}l._stwain._OnBitmapChanged(["0",l.cIndex.toString(),4,l.cIndex,l._UIView.sHowManyImages]);if(l._IfImageChanged){return}};a.prototype.Rotate=function(h,i){var j=this;if(typeof h==="undefined"||typeof i==="undefined"){alert("Not enough paramters")}else{j._IfImageChanged=true;j._stwain.Rotate(j.cIndex,h,i)}};a.prototype.RotateEx=function(h,j,i){var k=this;if(typeof h==="undefined"||typeof j==="undefined"||typeof i==="undefined"){alert("Not enough paramters")}else{k._IfImageChanged=true;k._stwain.RotateEx(k.cIndex,h,j,i)}};a.prototype.RotateLeft=function(){var h=this;h._IfImageChanged=true;h._stwain.RotateLeft(h.cIndex)};a.prototype.RotateAnyAngle=function(m){var j=this;c.hide("dynamsoft_ImgSizeEditor");if(!c.get("dynamsoft_RotateAnyAngle")){var p=['<div id="dynamsoft_RotateAnyAngle" class="dynamsoft-dwt-imgSizeEditor" style="display:none; z-index: 99999;">',"<ul>",'<li><label for="dynamsoft_Angle"><b>Angle :</b>','<input type="text" id="dynamsoft_Angle" style="width:50%;" size="10"/></label></li>','<li><label for="dynamsoft_Angle_InterpolationMethod"><b>Interpolation:</b>&nbsp;','<select size="1" id="dynamsoft_Angle_InterpolationMethod"><option value = ""></option></select></li>','<li><label for="dynamsoft_KeepSize"><b></b>','<input type="checkbox" id="dynamsoft_KeepSize"/>Keep size</label></li>',"</ul>","<div>",'<input id="dynamsoft_btnRotateAnyAngleOK" type="button" value="  OK  "/>','<span><input id= "dynamsoft_btnCancelRotateAnyAngle" type="button" value="Cancel" /></span>',"</div>","</div>"];c.one("body").append(p.join(""))}var q=c.get("dynamsoft_Angle_InterpolationMethod");q.options.length=0;q.options.add(new Option("NearestNeighbor",1));q.options.add(new Option("Bilinear",2));q.options.add(new Option("Bicubic",3));q=null;var k=c.get("dynamsoft_btnRotateAnyAngleOK");k.onclick=function(){var t=c.get("dynamsoft_Angle").value;c.get("dynamsoft_Angle").className="";re=/^\d+$/;if(!re.test(t)||t<=0){c.get("dynamsoft_Angle").className+=" invalid";c.get("dynamsoft_Angle").focus();alert("Error: The angle you entered is invalid.");return}var s=c.get("dynamsoft_KeepSize");var r=s.checked;var o=j.RotateEx(t,r,c.get("dynamsoft_Angle_InterpolationMethod").selectedIndex+1);if(j._stwain.ErrorCode==0){c.hide("dynamsoft_RotateAnyAngle");return}};var i=c.get("dynamsoft_btnCancelRotateAnyAngle");i.onclick=function(){c.hide("dynamsoft_RotateAnyAngle")};var h=c.get("dynamsoft_RotateAnyAngle");c.toggle("dynamsoft_RotateAnyAngle");var l=m.y;if(!l){l=m.offsetTop+1}var n=m.x;if(!n){n=m.offsetLeft+1}h.style.top=l+m.offsetHeight+document.documentElement.scrollTop+"px";h.style.left=n+document.documentElement.scrollLeft+"px";c.get("dynamsoft_Angle").value="45"};a.prototype.RotateRight=function(){var h=this;h._IfImageChanged=true;h._stwain.RotateRight(h.cIndex)};a.prototype.Deskew=function(){var h=this;h.RotateEx(h._stwain.GetSkewAngle(h.cIndex),true,1)};a.prototype.Flip=function(){var h=this;h._IfImageChanged=true;h._stwain.Flip(h.cIndex)};a.prototype.Mirror=function(){var h=this;h._IfImageChanged=true;h._stwain.Mirror(h.cIndex)};a.prototype.ChangeImageSize=function(i,h,j){var k=this;k._IfImageChanged=true;k._stwain.ChangeImageSize(k.cIndex,i,h,j)};a.prototype.ChangeImageSizeGetinput=function(m){var j=this;c.hide("dynamsoft_RotateAnyAngle");if(!c.get("dynamsoft_ImgSizeEditor")){var p=['<div id="dynamsoft_ImgSizeEditor" class="dynamsoft-dwt-imgSizeEditor" style="display:none;z-index: 99999;">',"<ul>",'<li><label for="dynamsoft_img_height"><b>New Height :</b>','<input type="text" id="dynamsoft_img_height" style="width:50%;" size="10"/>pixel</label></li>','<li><label for="dynamsoft_img_width"><b>New Width :</b>&nbsp;','<input type="text" id="dynamsoft_img_width" style="width:50%;" size="10"/>pixel</label></li>',"<li>Interpolation method:",'<select size="1" id="dynamsoft_InterpolationMethod"><option value = ""></option></select></li>',"</ul>","<div>",'<input id="dynamsoft_btnChangeImageSizeOK" type="button" value="  OK  "/>','<span><input id= "dynamsoft_btnCancelChange" type="button" value="Cancel" /></span>',"</div>","</div>"];c.one("body").append(p.join(""))}var q=c.get("dynamsoft_InterpolationMethod");q.options.length=0;q.options.add(new Option("NearestNeighbor",1));q.options.add(new Option("Bilinear",2));q.options.add(new Option("Bicubic",3));q=null;var h=c.get("dynamsoft_btnChangeImageSizeOK");h.onclick=function(){var s=c.get("dynamsoft_img_width").value,o=c.get("dynamsoft_img_height").value;c.get("dynamsoft_img_width").className="";c.get("dynamsoft_img_height").className="";re=/^\d+$/;if(!re.test(o)||o<=0){c.get("dynamsoft_img_height").className+=" invalid";c.get("dynamsoft_img_height").focus();alert("Error: The height you entered is invalid.");return}if(!re.test(s)||s<=0){c.get("dynamsoft_img_width").className+=" invalid";c.get("dynamsoft_img_width").focus();alert("Error: The width you entered is invalid.");return}var r=j.ChangeImageSize(s,o,c.get("dynamsoft_InterpolationMethod").selectedIndex+1);if(j._stwain.ErrorCode==0){c.hide("dynamsoft_ImgSizeEditor");return}};var k=c.get("dynamsoft_btnCancelChange");k.onclick=function(){c.hide("dynamsoft_ImgSizeEditor")};var i=c.get("dynamsoft_ImgSizeEditor");c.toggle("dynamsoft_ImgSizeEditor");var l=m.y;if(!l){l=m.offsetTop+1}var n=m.x;if(!n){n=m.offsetLeft+1}i.style.top=l+m.offsetHeight+document.documentElement.scrollTop+"px";i.style.left=n+document.documentElement.scrollLeft+"px";if(j.aryModelImageControl[j.cIndex].imageToShow){c.get("dynamsoft_img_width").value=j.aryModelImageControl[j.cIndex].imageToShow.width;c.get("dynamsoft_img_height").value=j.aryModelImageControl[j.cIndex].imageToShow.height}else{c.get("dynamsoft_img_width").value=0;c.get("dynamsoft_img_height").value=0}return false};a.prototype.Crop_btn=function(){var j=this,h,i=c.one(j.toolbar.self).one(".dynamsoft-dwt-Editor_Buttons_crop");if(i&&i[0]){h=i[0].src;if(h.indexOf("grey")!=-1){return}else{j.Crop()}}};a.prototype.Erase_btn=function(){var j=this,i,h=c.one(j.toolbar.self).one(".dynamsoft-dwt-Editor_Buttons_erase");if(h&&h[0]){i=h[0].src;if(i.indexOf("grey")!=-1){return}else{j.Erase()}}};a.prototype.Crop=function(){var l=this;var k=l.Left;var j=l.Top;var i=l.Right;var h=l.Bottom;if(parseInt(k)-parseInt(i)!=0&&parseInt(j)-parseInt(h)!=0){l._IfImageChanged=true;l._stwain.Crop(l.cIndex,parseInt(k),parseInt(j),parseInt(i),parseInt(h));l.__SetCropButtonGrey(true);l.__SetEraseButtonGrey(true)}else{f.output(l,"No area selected for cropping");return}};a.prototype.Erase=function(){var l=this;var k=l.Left;var j=l.Top;var i=l.Right;var h=l.Bottom;if(parseInt(k)-parseInt(i)!=0&&parseInt(j)-parseInt(h)!=0){l._IfImageChanged=true;l._stwain.Erase(l.cIndex,parseInt(k),parseInt(j),parseInt(i),parseInt(h));l.__SetEraseButtonGrey(true)}else{f.output(l,"No area selected for cropping");return}};a.prototype.StrechMode=function(){var h=this;if(h._UIView){h._UIView.SetIfFitWindowAndType(4)}h.__SetZoomInButtonEnable(true);h.__SetZoomOutButtonEnable(true);h.__SetCropButtonGrey(true);h.__SetEraseButtonGrey(true);return};a.prototype.FitsWindowSize=function(){var h=this;if(h._UIView){h._UIView.SetIfFitWindowAndType(0)}h.__SetZoomInButtonEnable(true);h.__SetZoomOutButtonEnable(true);h.__SetCropButtonGrey(true);h.__SetEraseButtonGrey(true);return};a.prototype.FitsWindowWidth=function(h){var i=this;if(i._UIView){i._UIView.SetIfFitWindowAndType(2)}i.__SetZoomInButtonEnable(true);i.__SetZoomOutButtonEnable(true);i.__SetCropButtonGrey(true);i.__SetEraseButtonGrey(true);return};a.prototype.FitsWindowHeight=function(h){var i=this;if(i._UIView){i._UIView.SetIfFitWindowAndType(1)}i.__SetZoomInButtonEnable(true);i.__SetZoomOutButtonEnable(true);i.__SetCropButtonGrey(true);i.__SetEraseButtonGrey(true);return};a.prototype.ZoomIn=function(){var h=this;if(h._UIView&&h._UIView.ZoomIn()){h.__SetZoomInButtonEnable(true);h.__SetZoomOutButtonEnable(true)}else{h.__SetZoomInButtonEnable(false);h.__SetZoomOutButtonEnable(true)}h.__SetCropButtonGrey(true);h.__SetEraseButtonGrey(true)};a.prototype.ZoomOut=function(){var h=this;if(h._UIView&&h._UIView.ZoomOut()){h.__SetZoomOutButtonEnable(true);h.__SetZoomInButtonEnable(true)}else{h.__SetZoomOutButtonEnable(false);h.__SetZoomInButtonEnable(true)}h.__SetCropButtonGrey(true);h.__SetEraseButtonGrey(true)};a.prototype.OriginalSize=function(){var h=this;if(h._UIView){h._UIView.SetZoom(1)}h.__SetZoomInButtonEnable(true);h.__SetZoomOutButtonEnable(true);h.__SetCropButtonGrey(true);h.__SetEraseButtonGrey(true);return};a.prototype.Hand_btn=function(){var i=this,h=EnumDWT_MouseShape.Hand;if(i._UIView){i._UIView.SetMouseShapeByIndex(i.cIndex,h)}i.__EnableMouseShapButtons(h)};a.prototype.RectSelect_btn=function(){var i=this,h=EnumDWT_MouseShape.Crosshair;if(i._UIView){i._UIView.SetMouseShapeByIndex(i.cIndex,h)}i.__EnableMouseShapButtons(h)};a.prototype.Zoom_btn=function(){var i=this,h=EnumDWT_MouseShape.Zoom;if(i._UIView){i._UIView.SetMouseShapeByIndex(i.cIndex,h)}i.__EnableMouseShapButtons(h)};a.prototype.__EnableMouseShapButtons=function(o){var j=this,n=c.one(j.toolbar.self),p,m,k;if(n){var h=n.one(".dynamsoft-dwt-Editor_Buttons_hand"),i=n.one(".dynamsoft-dwt-Editor_Buttons_rectselect"),l=n.one(".dynamsoft-dwt-Editor_Buttons_zoom");f.removeClass(h.parent(),"dynamsoft-dwt-EditorButton-selected");f.removeClass(i.parent(),"dynamsoft-dwt-EditorButton-selected");f.removeClass(l.parent(),"dynamsoft-dwt-EditorButton-selected");if(o==EnumDWT_MouseShape.Hand){f.addClass(h.parent(),"dynamsoft-dwt-EditorButton-selected")}else{if(o==EnumDWT_MouseShape.Crosshair){f.addClass(i.parent(),"dynamsoft-dwt-EditorButton-selected")}else{if(o==EnumDWT_MouseShape.Zoom){f.addClass(l.parent(),"dynamsoft-dwt-EditorButton-selected")}}}}};a.prototype.print=function(){var h=this;if(h._UIView){h._UIView.PrintCurrent()}};a.prototype.RestoreImage=function(){var h=this;h.__RestoreImageInner(true,-1)};a.prototype.__RestoreImageInner=function(k,i,n){var o=this,l;if(o.cIndex==-1){if(n){n()}return}var j=function(r,u,s){if(k==true){c.log("__RestoreImageInner: "+[u.imageIndex].join(","));u.bOriginalImage=true;if(o._UIView&&r.GetBindIndex()==s){o._UIView.AttachImagesForControl(r,u)}}o._IfImageChanged=false;var p=o.aryModelImageControl[s];if(p!=null){p.imageToShow=u.imageToShow;p.imageWidth=u.imageWidth;p.imageHeight=u.imageHeight;p.imageUrl=u.imageUrl}o._UIManager.getView().SetDataImageControl(s);var q=c.one(o.toolbar.self).one(".dynamsoft-dwt-Editor_Buttons_save"),t=c.one(o.toolbar.self).one(".dynamsoft-dwt-Editor_Buttons_restore");if(q&&q[0]){q[0].style.display="none";t[0].style.display="none"}if(n){n()}if(i==-1){o._stwain._OnBitmapChanged(["0",o.cIndex.toString(),4,o.cIndex,o._UIView.sHowManyImages])}};var m=true;if(o._UIView&&o._IfImageChanged==true){var h=o._UIView.GetImageControl(o.cIndex);if(null!=h){h.SetCurrentIndex(o.cIndex);o.OnGetImageFromServerForEdit(h,o.aryModelImageControl[o.cIndex],o.cIndex,1,j);m=false}}if(m){if(n){n()}}};a.prototype.OnGetImageFromServerForEdit=function(h,m,k,l,n){var o=this,j,i;if(n&&o.BaseUrl){h.ClearImage();h.SetBindIndex(k);j=d.getUrlByAct(o.BaseUrl,k,l);i=new Image();i.src=j;i.onload=function(){h.tmpImage=false;m.imageToShow=i;m.imageWidth=i.width;m.imageHeight=i.height;m.imageUrl=j;m.bIsDirty=false;n(h,m,k);i.onerror=undefined;i.onload=undefined};i.onerror=function(r){var s=h.GetBindIndex(),q=o._stwain,p=q.HowManyImagesInBuffer;if(s>=0&&s<p){i.ready_src=d.getImageUrl(o.BaseUrl,h.GetBindIndex(),l);setTimeout(function(){if(i.ready_src){i.src=i.ready_src}else{i.src="data:,";i.onload=undefined;i.onerror=undefined;i=null;h.tmpImage=false}i.ready_src=undefined},3000)}else{i.src="data:,";i.onload=undefined;i.onerror=undefined;i=null;h.tmpImage=false}};if(h.tmpImage){h.tmpImage.src="data:,";h.tmpImage.onload=undefined}h.tmpImage=i}return true};a.prototype.ChangeSize=function(i,j){var k=this;if(i>=0){k.containerWidth=i}if(j>=0){k.containerHeight=j}k.width=k.containerWidth-2;if(k.width<0){k.width=0}k.height=k.containerHeight-2;if(k.height<0){k.height=0}k.UIEditor.css({width:k.width+"px",height:k.height+"px"})};a.prototype.SaveImage=function(){var h=this;h.__SaveImageInner(true,function(){h._stwain._OnBitmapChanged(["0",h.cIndex.toString(),4,h.cIndex,h._UIView.sHowManyImages])})};a.prototype.__SaveImageInner=function(j,m){var n=this,k;if(n.cIndex==-1){if(m){m()}return}if(!n._IfImageChanged){alert("You have not changed the current image");if(m){m()}return}var i=function(q,t,r){if(j==true){c.log("__SaveImageInner: "+[t.imageIndex].join(","));t.bOriginalImage=true;if(n._UIView&&q.GetBindIndex()==r){n._UIView.AttachImagesForControl(q,t)}}n._IfImageChanged=false;var o=n.aryModelImageControl[r];if(o!=null){o.imageToShow=t.imageToShow;o.imageWidth=t.imageWidth;o.imageHeight=t.imageHeight;o.imageUrl=t.imageUrl}n._UIManager.getView().SetDataImageControl(r);var p=c.one(n.toolbar.self).one(".dynamsoft-dwt-Editor_Buttons_save"),s=c.one(n.toolbar.self).one(".dynamsoft-dwt-Editor_Buttons_restore");if(p&&p[0]){p[0].style.display="none";s[0].style.display="none"}if(m){m()}};var l=true;if(n._UIView&&n._IfImageChanged==true){var h=n._UIView.GetImageControl(n.cIndex);if(null!=h){h.SetCurrentIndex(n.cIndex);n.OnGetImageFromServerForEdit(h,n.aryModelImageControl[n.cIndex],n.cIndex,2,i);l=false}}if(l){if(m){m()}}};a.prototype.ShowDialogForSaveImage=function(i,l){var m=this;var j=['<div class="dynamsoft-dwt-dlg-tips">',"<div>","You have changed the image, do you want to keep the change(s)?","</div>",'<div style="width: 200px;white-space:nowrap;margin-left: auto;margin-right: auto;">','<input class="dynamsoft_btnSave" style="width: 100px; height:30px; margin-right: 10px; margin-top: 10px;"  type="button" value="  OK  "/>','<input class="dynamsoft_btnCancel" style="width: 100px; height:30px;"  type="button" value="  NO  " />',"</div>","</div>"];Dynamsoft.WebTwainEnv.ShowDialog(420,0,j.join(""),true);var h=c.one(".dynamsoft_btnSave").getEL();if(h){h.onclick=function(){m.__SaveImageInner(false,function(){var n=m._stwain._strDWTControlContainerID;DCP_DWT_OnClickCloseInstall(n);c.bChangeImage=1;if(i==-1){m.__HideImageEditorInner()}else{m.__goInner(i)}if(l){document.body.style.overflow=""}})}}var k=c.one(".dynamsoft_btnCancel").getEL();if(k){k.onclick=function(){m.__RestoreImageInner(false,i,function(){var n=m._stwain._strDWTControlContainerID;DCP_DWT_OnClickCloseInstall(n);c.bChangeImage=0;if(i==-1){m.__HideImageEditorInner()}else{m.__goInner(i)}if(l){document.body.style.overflow=""}})}}};a.prototype.__SetCropButtonGrey=function(j){var l=this;l.Left=0;l.Top=0;l.Right=0;l.Bottom=0;var k=c.one(l.toolbar.self).one(".dynamsoft-dwt-Editor_Buttons_crop");if(k&&k[0]){var i=k[0].src;i=i.replace("crop.","crop_grey.");k[0].src=i;k.style("cursor","auto")}if(l._UIView&&j){var h=l._UIView.GetImageControl(l.cIndex);if(null!=h){h.SetSelectedImageArea(0,0,0,0)}}};a.prototype.__SetEraseButtonGrey=function(k){var l=this;l.Left=0;l.Top=0;l.Right=0;l.Bottom=0;var i=c.one(l.toolbar.self).one(".dynamsoft-dwt-Editor_Buttons_erase");if(i&&i[0]){var j=i[0].src;j=j.replace("erase.","erase_grey.");i[0].src=j;i.style("cursor","auto")}if(l._UIView&&k){var h=l._UIView.GetImageControl(l.cIndex);if(null!=h){h.SetSelectedImageArea(0,0,0,0)}}};a.prototype.__SetZoomInButtonEnable=function(h){var k=this;var j=c.one(k.toolbar.self).one(".dynamsoft-dwt-Editor_Buttons_zoomin");if(j&&j[0]){var i=j[0].src;if(h==true){i=i.replace("zoomin_grey.","zoomin.");j[0].src=i;j.style("cursor","pointer")}else{i=i.replace("zoomin.","zoomin_grey.");j[0].src=i;j.style("cursor","auto")}}};a.prototype.__SetZoomOutButtonEnable=function(h){var k=this;var j=c.one(k.toolbar.self).one(".dynamsoft-dwt-Editor_Buttons_zoomout");if(j&&j[0]){var i=j[0].src;if(h==true){i=i.replace("zoomout_grey.","zoomout.");j[0].src=i;j.style("cursor","pointer")}else{i=i.replace("zoomout.","zoomout_grey.");j[0].src=i;j.style("cursor","auto")}}};a.prototype.refresh=function(j){var k=this;k.cIndex=j;if(k._UIView){k._UIView.SetDataImageControl(j)}if(k._IfImageChanged){var h=c.one(k.toolbar.self).one(".dynamsoft-dwt-Editor_Buttons_save"),i=c.one(k.toolbar.self).one(".dynamsoft-dwt-Editor_Buttons_restore");if(h&&h[0]){h[0].style.display="";i[0].style.display=""}}k.__SetCropButtonGrey(true);k.__SetEraseButtonGrey(true)};c.UI=c.UI||{};c.UI.ImageUIEditor=a})(Dynamsoft.Lib);(function(c){if(!c.product.bPluginEdition&&!c.product.bActiveXEdition){return}if(!Object.defineProperty){Object.defineProperty=function(n,k,m){var j=n[k],h=function(){return m.get.apply(n,[j])},l=function(p){return j=m.set.apply(n,[p])};if(n.__defineGetter__){n.__defineGetter__(k,h);n.__defineSetter__(k,l)}else{var i=function(q){if(event.propertyName==k){n.detachEvent("onpropertychange",i);var p=l(n[k]);n[k]=h;n[k].toString=h;n.attachEvent("onpropertychange",i)}};n[k]=h;n[k].toString=h;n.attachEvent("onpropertychange",i)}}}var b=!0,d=!1,f={isFunction:function(h){return h&&typeof(h)==="function"},checkErrorString:function(i){var h=i.getSWebTwain().ErrorCode;if(h==0){return b}return d},wrapperRet:function(k,i,h,l,j){if(f.checkErrorString(k)){if(f.isFunction(h)){if(j){h(k.getSWebTwain().HTTPPostResponseString)}else{h()}}}else{if(f.isFunction(l)){if(j){l(k.getSWebTwain().ErrorCode,k.getSWebTwain().ErrorString,k.getSWebTwain().HTTPPostResponseString)}else{l(k.getSWebTwain().ErrorCode,k.getSWebTwain().ErrorString)}}}return i},getImageType:function(i){var h=i.length;if(h<4){return -1}var j=i.lastIndexOf(".");if(j===-1){return -1}var k=i.slice(j).toLowerCase();if(k===".bmp"||k===".dib"){return 0}if(k===".jpg"||k===".jpe"||k===".jpeg"||k===".jfif"){return 1}if(k===".tif"||k===".tiff"){return 2}if(k===".png"){return 3}if(k===".pdf"){return 4}if(k===".gif"){return 5}return -1},replaceLocalFilename:function(h){var i=h;if(c.env.bFileSystem){i=decodeURI(i)}return i},makeParams:function(){var h=arguments;if(h===undefined||h.length===0){return undefined}else{return h}}};c.wrapperRet=f.wrapperRet;c.DynamicLoadAddonFuns=[];c.attachAddon=function(h){c.each(c.DynamicLoadAddonFuns,function(i){if(c.isFunction(i)){i(h)}})};var e=0,g=1,a=1;c.attachProperty=function(h){var i=function(m,l,j){var k;if(l!==e&&l!==g){k=l}else{k={};if(l){k.set=j?function(n){n=n*1;h.getSWebTwain()[m]=n;return b}:function(n){h.getSWebTwain()[m]=n;return b}}}if(!k.get){k.get=function(){return h.getSWebTwain()[m]}}Object.defineProperty(h,m,k)};i("ErrorCode",e);i("ErrorString",e);i("LogLevel",g,a);i("Manufacturer",g);i("ProductFamily",g);i("ProductKey",{set:function(j){Dynamsoft.WebTwainEnv.ProductKey=j;h.getSWebTwain().ProductKey=j;return b}});i("ProductName",g);i("VersionInfo",g);i("BitDepth",g);i("Brightness",g);i("Contrast",g);i("CurrentSourceName",e);i("DataSourceStatus",e);i("DefaultSourceName",e);i("Duplex",e);i("IfAppendImage",g);i("IfAutoBright",g);i("IfAutoDiscardBlankpages",g);i("IfAutoFeed",g);i("IfAutomaticBorderDetection",g);i("IfAutomaticDeskew",g);i("IfAutoScan",g);i("IfDisableSourceAfterAcquire",g);i("IfDuplexEnabled",g);i("IfFeederEnabled",g);i("IfFeederLoaded",e);i("IfModalUI",g);i("IfPaperDetectable",e);i("IfScanInNewThread",g);i("IfShowCancelDialogWhenImageTransfer",g);i("IfShowUI",g);i("IfShowIndicator",g);i("IfUseTwainDSM",g);i("IfUIControllable",e);i("ImageBitsPerPixel",e);i("ImageCaptureDriverType",g);i("ImageLayoutDocumentNumber",e);i("ImageLayoutFrameBottom",e);i("ImageLayoutFrameLeft",e);i("ImageLayoutFrameNumber",e);i("ImageLayoutFrameRight",e);i("ImageLayoutFrameTop",e);i("ImageLayoutPageNumber",e);i("ImageLength",e);i("ImagePixelType",e);i("ImageWidth",e);i("ImageXResolution",e);i("ImageYResolution",e);i("MagData",e);i("MagType",e);i("PageSize",g,a);i("PendingXfers",e);i("PixelFlavor",g);i("PixelType",g);i("Resolution",g,a);i("SourceCount",e);i("TransferMode",g);i("Unit",g);i("XferCount",g,a);i("Capability",g);i("CapCurrentIndex",g);i("CapCurrentValue",g);i("CapDefaultIndex",e);i("CapDefaultValue",e);i("CapDescription",g);i("CapMaxValue",g);i("CapMinValue",g);i("CapNumItems",g);i("CapStepSize",g);i("CapType",g);i("CapValue",g);i("CapValueString",g);i("CapValueType",g);i("AllowMultiSelect",g);i("BackgroundColor",g);i("BackgroundFillColor",g);i("BlankImageCurrentStdDev",e);i("BlankImageMaxStdDev",g);i("BlankImageThreshold",g);i("CurrentImageIndexInBuffer",{set:function(j){if(j!=h.getSWebTwain().CurrentImageIndexInBuffer){h.getSWebTwain().CurrentImageIndexInBuffer=j}return b}});i("FitWindowType",g);i("HowManyImagesInBuffer",g);i("IfFitWindow",g);i("ImageMargin",g);i("MaxImagesInBuffer",g);i("MouseX",e);i("MouseY",e);i("SelectedImagesCount",g);i("SelectionImageBorderColor",g);i("Zoom",g);i("MouseShape",g);i("HTTPPostResponseString",e);i("AsyncMode",g);i("FTPPassword",g);i("FTPPort",{set:function(j){if(j!==""){j=j*1;h.getSWebTwain().FTPPort=j;return b}return d}});i("FTPUserName",g);i("HTTPPort",{set:function(j){if(j!==""){j=j*1;h.getSWebTwain().HTTPPort=j}else{j=c.detect.ssl?443:80;h.getSWebTwain().HTTPPort=j}return b}});i("HTTPPassword",g);i("HTTPUserName",g);i("IfPASVMode",g);i("IfShowProgressBar",g);i("ProxyServer",g);i("IfShowFileDialog",g);i("IfTiffMultiPage",g);i("PDFAuthor",g);i("PDFCompressionType",g);i("PDFCreationDate",g);i("PDFCreator",g);i("PDFKeywords",g);i("PDFModifiedDate",g);i("PDFProducer",g);i("PDFSubject",g);i("PDFTitle",g);i("PDFVersion",g);i("TIFFCompressionType",g);i("JPEGQuality",{set:function(j){j=j*1;if(j>=100){j=100}h.getSWebTwain().JPEGQuality=j;return b}});i("HttpContentTypeFieldValue",g);i("SelectionRectAspectRatio",g);i("IfAllowLocalCache",g);i("_AutoCropMethod",g);i("BrokerProcessType",g);i("BorderStyle",g);i("IfShowPrintUI",g);i("VScrollBar",g);i("EnableInteractiveZoom",g);i("ImageEditorIfEnableEnumerator",g);i("ImageEditorIfReadonly",g);i("ImageEditorIfModal",g);i("ImageEditorWindowTitle",g);i("IfSSL",g);i("AllowPluginAuthentication",g);i("HttpFieldNameOfUploadedImage",g);i("MaxInternetTransferThreads",g);i("MaxUploadImageSize",g);i("IfOpenImageWithGDIPlus",g);i("BufferMemoryLimit",g);i("Width",{get:function(){return h.getSWebTwain().style.width},set:function(j){var k=this;h._ChangeWidth(j);return b}});i("Height",{get:function(){return h.getSWebTwain().style.height},set:function(j){var k=this;h._ChangeHeight(j);return b}});i("IfThrowException",g);i("IfAutoScroll",g);i("ShowPageNumber",{get:function(){return d},set:function(j){return d}})};c.attachMethod=function(h){var i=h;h.RegisterEvent=function(j,l){var k=["__",j].join("");i[k]=l;i.getSWebTwain().RegisterEvent(j,l);return b};h.onEvent=function(j,k){i.RegisterEvent(j,k);return b};h.on=function(j,k){i.RegisterEvent(j,k);return b};h.CancelAllPendingTransfers=function(){return i.getSWebTwain().CancelAllPendingTransfers()};h.CloseSource=function(){return i.getSWebTwain().CloseSource()};h.CloseSourceManager=function(){return i.getSWebTwain().CloseSourceManager()};h.DisableSource=function(){return i.getSWebTwain().DisableSource()};h.FeedPage=function(){return i.getSWebTwain().FeedPage()};h.GetDeviceType=function(){return i.getSWebTwain().GetDeviceType()};h.GetSourceNameItems=function(j){return i.getSWebTwain().GetSourceNameItems(j)};h.SourceNameItems=function(j){return i.getSWebTwain().GetSourceNameItems(j)};h.GetSourceNames=function(){return[]};h.GetSourceType=function(j){return i.getSWebTwain().GetSourceType(j)};h.OpenSource=function(){return i.getSWebTwain().OpenSource()};h.OpenSourceManager=function(){return i.getSWebTwain().OpenSourceManager()};h.ResetImageLayout=function(){return i.getSWebTwain().ResetImageLayout()};h.RewindPage=function(){return i.getSWebTwain().RewindPage()};h.SelectSource=function(){return i.getSWebTwain().SelectSource()};h.SelectSourceByIndex=function(j){return i.getSWebTwain().SelectSourceByIndex(j)};h.SetFileXferInfo=function(j,l){var k=f.replaceLocalFilename(j);return i.getSWebTwain().SetFileXferInfo(k,l)};h.SetImageLayout=function(m,l,k,j){return i.getSWebTwain().SetImageLayout(m,l,k,j)};h.CapGet=function(){return i.getSWebTwain().CapGet()};h.CapGetCurrent=function(){return i.getSWebTwain().CapGetCurrent()};h.CapGetDefault=function(){return i.getSWebTwain().CapGetDefault()};h.CapGetFrameBottom=function(j){return i.getSWebTwain().CapGetFrameBottom(j)};h.CapGetFrameLeft=function(j){return i.getSWebTwain().CapGetFrameLeft(j)};h.CapGetFrameRight=function(j){return i.getSWebTwain().CapGetFrameRight(j)};h.CapGetFrameTop=function(j){return i.getSWebTwain().CapGetFrameTop(j)};h.CapGetHelp=function(){return i.getSWebTwain().CapGetHelp()};h.CapGetLabel=function(){return i.getSWebTwain().CapGetLabel()};h.CapGetLabels=function(){return i.getSWebTwain().CapGetLabels()};h.CapIfSupported=function(j){return i.getSWebTwain().CapIfSupported(j)};h.CapReset=function(){return i.getSWebTwain().CapReset()};h.CapSet=function(){return i.getSWebTwain().CapSet()};h.CapSetFrame=function(k,n,m,l,j){return i.getSWebTwain().CapSetFrame(k,n,m,l,j)};h.GetCapItems=function(j){return i.getSWebTwain().GetCapItems(j)};h.GetCapItemsString=function(j){return i.getSWebTwain().GetCapItemsString(j)};h.SetCapItems=function(k,j){i.getSWebTwain().SetCapItems(k,j);return f.checkErrorString(i)};h.SetCapItemsString=function(k,j){i.getSWebTwain().SetCapItemsString(k,j);return f.checkErrorString(i)};h.AddText=function(p,j,r,q,n,l,m,k){return i.getSWebTwain().AddText(p,j,r,q,n,l,m,k)};h.CreateTextFont=function(l,x,r,q,t,u,m,v,j,s,n,p,w,k){return i.getSWebTwain().CreateTextFont(l,x,r,q,t,u,m,v,j,s,n,p,w,k)};h.CopyToClipboard=function(j){return i.getSWebTwain().CopyToClipboard(j)};h.Erase=function(l,n,m,k,j){return i.getSWebTwain().Erase(l,n,m,k,j)};h.GetImageBitDepth=function(j){return i.getSWebTwain().GetImageBitDepth(j)};h.GetImageWidth=function(j){return i.getSWebTwain().GetImageWidth(j)};h.GetImageHeight=function(j){return i.getSWebTwain().GetImageHeight(j)};h.GetImageSize=function(k,j,l){return i.getSWebTwain().GetImageSize(k,j,l)};h.GetImageSizeWithSpecifiedType=function(j,k){return i.getSWebTwain().GetImageSizeWithSpecifiedType(j,k)};h.GetImageXResolution=function(j){return i.getSWebTwain().GetImageXResolution(j)};h.GetImageYResolution=function(j){return i.getSWebTwain().GetImageYResolution(j)};h.GetSelectedImageIndex=function(j){return i.getSWebTwain().GetSelectedImageIndex(j)};h.SetSelectedImageIndex=function(k,j){i.getSWebTwain().SetSelectedImageIndex(k,j);return f.checkErrorString(i)};h.GetSelectedImagesSize=function(j){return i.getSWebTwain().GetSelectedImagesSize(j)};h.GetSkewAngle=function(j){return i.getSWebTwain().GetSkewAngle(j)};h.GetSkewAngleEx=function(l,n,m,k,j){return i.getSWebTwain().GetSkewAngleEx(l,n,m,k,j)};h.IsBlankImage=function(j){return i.getSWebTwain().IsBlankImage(j)};h.IsBlankImageEx=function(l,n,m,k,j,p){return i.getSWebTwain().IsBlankImageEx(l,n,m,k,j,p)};h.Mirror=function(j){return i.getSWebTwain().Mirror(j)};h.OverlayRectangle=function(n,q,p,l,k,j,m){i.getSWebTwain().OverlayRectangle(n,q,p,l,k,j,m);return f.checkErrorString(i)};h.RemoveAllImages=function(){var j;i.getSWebTwain().RemoveAllImages();j=f.checkErrorString(i);if(j){i.__innerRefreshImage()}return j};h.RemoveAllSelectedImages=function(){var j;i.getSWebTwain().RemoveAllSelectedImages();j=f.checkErrorString(i);if(j){i.__innerRefreshImage()}return j};h.RemoveImage=function(j){return i.getSWebTwain().RemoveImage(j)};h.Rotate=function(m,k,l){var j=parseInt(m),n,p;n=i.getSWebTwain().Rotate(j,k,l);p=(n==1);return p};h.RotateEx=function(n,l,m,j){var k=parseInt(n),p,q;p=i.getSWebTwain().RotateEx(k,l,m,j);q=(p==1);return q};h.RotateLeft=function(k){var j=parseInt(k),l,m;l=i.getSWebTwain().RotateLeft(j);m=(l==1);return m};h.RotateRight=function(k){var j=parseInt(k),l,m;l=i.getSWebTwain().RotateRight(j);m=(l==1);return m};h.ChangeImageSize=function(m,q,j,k){var l=parseInt(m),n,p;n=i.getSWebTwain().ChangeImageSize(l,q,j,k),p=(n==1);return p};h.Flip=function(k){var j=parseInt(k),l,m;l=i.getSWebTwain().Flip(j);m=(l==1);return m};h.Crop=function(m,q,p,l,j){var k=parseInt(m),n,s;n=i.getSWebTwain().Crop(k,q,p,l,j);s=(n==1);return s};h.CropToClipboard=function(m,q,p,l,j){var k=parseInt(m),n,s;n=i.getSWebTwain().CropToClipboard(k,q,p,l,j);s=(n==1);return s};h.CutFrameToClipboard=function(m,q,p,l,j){var k=parseInt(m),n,s;n=i.getSWebTwain().CutFrameToClipboard(k,q,p,l,j);s=(n==1);return s};h.CutToClipboard=function(k){var j=parseInt(k),l,m;l=i.getSWebTwain().CutToClipboard(j);m=(l==1);return m};h.SetDPI=function(p,k,n,j,l){var m=parseInt(p);return i.getSWebTwain().SetDPI(m,k,n,j,l)};h.SetViewMode=function(k,j){return i.getSWebTwain().SetViewMode(k,j)};h.GetViewModeH=function(){return i.getSWebTwain().GetViewModeH()};h.GetViewModeV=function(){return i.getSWebTwain().GetViewModeV()};h.MoveImage=function(m,l){var k=parseInt(m),j=parseInt(l);return i.getSWebTwain().MoveImage(k,j)};h.SwitchImage=function(m,l){var k=parseInt(m),j=parseInt(l);return i.getSWebTwain().SwitchImage(k,j)};h.Print=function(){return i.getSWebTwain().Print()};h.checkErrorString=function(){var k=i.ErrorCode;if(k===-2115){return b}if(k===-2003){var j=window.open("","ErrorMessage","height=500,width=750,top=0,left=0,toolbar=no,menubar=no,scrollbars=no, resizable=no,location=no, status=no");j.document.writeln(i.HTTPPostResponseString)}return(k===0)};h.FileExists=function(j){var k=f.replaceLocalFilename(j);return i.getSWebTwain().FileExists(k)};h.SaveAllAsMultiPageTIFF=function(j,n,l){var m=f.replaceLocalFilename(j),k;k=i.getSWebTwain().SaveAllAsMultiPageTIFF(m);return f.wrapperRet(i,k,n,l)};h.SaveAllAsPDF=function(j,m,k){var l=f.replaceLocalFilename(j);_ret=i.getSWebTwain().SaveAllAsPDF(l);return f.wrapperRet(i,_ret,m,k)};h.SaveAsBMP=function(j,l,n,k){var m=f.replaceLocalFilename(j);_ret=i.getSWebTwain().SaveAsBMP(m,l);return f.wrapperRet(i,_ret,n,k)};h.SaveAsJPEG=function(j,l,n,k){var m=f.replaceLocalFilename(j);_ret=i.getSWebTwain().SaveAsJPEG(m,l);return f.wrapperRet(i,_ret,n,k)};h.SaveAsPDF=function(j,l,n,k){var m=f.replaceLocalFilename(j);_ret=i.getSWebTwain().SaveAsPDF(m,l);return f.wrapperRet(i,_ret,n,k)};h.SaveAsPNG=function(j,l,n,k){var m=f.replaceLocalFilename(j);_ret=i.getSWebTwain().SaveAsPNG(m,l);return f.wrapperRet(i,_ret,n,k)};h.SaveAsTIFF=function(j,l,n,k){var m=f.replaceLocalFilename(j);_ret=i.getSWebTwain().SaveAsTIFF(m,l);return f.wrapperRet(i,_ret,n,k)};h.SaveSelectedImagesAsMultiPagePDF=function(j,n,l){var m=f.replaceLocalFilename(j),k;k=i.getSWebTwain().SaveSelectedImagesAsMultiPagePDF(m);return f.wrapperRet(i,k,n,l)};h.SaveSelectedImagesAsMultiPageTIFF=function(j,n,l){var m=f.replaceLocalFilename(j),k;k=i.getSWebTwain().SaveSelectedImagesAsMultiPageTIFF(m);return f.wrapperRet(i,k,n,l)};h.SaveSelectedImagesToBase64Binary=function(){return i.getSWebTwain().SaveSelectedImagesToBase64Binary()};h.ShowFileDialog=function(k,j,r,m,p,q,l,n){return i.getSWebTwain().ShowFileDialog(k,j,r,m,p,q,l,n)};h.FTPDownload=function(n,m,l,k){var j=i.getSWebTwain().FTPDownload(n,m);return f.wrapperRet(i,j,l,k)};h.FTPDownloadDirectly=function(p,n,j,m,l){var k=i.getSWebTwain().FTPDownloadDirectly(p,n,j);return f.wrapperRet(i,k,m,l)};h.FTPDownloadEx=function(p,n,l,m,k){var j=i.getSWebTwain().FTPDownloadEx(p,n,l);return f.wrapperRet(i,j,m,k)};h.FTPUpload=function(p,l,n,m,k){var j=i.getSWebTwain().FTPUpload(p,l,n);return f.wrapperRet(i,j,m,k)};h.FTPUploadDirectly=function(p,j,n,m,l){var k=i.getSWebTwain().FTPUploadDirectly(p,j,n);return f.wrapperRet(i,k,m,l)};h.FTPUploadEx=function(q,l,p,m,n,k){var j=i.getSWebTwain().FTPUploadEx(q,l,p,m);return f.wrapperRet(i,j,n,k)};h.FTPUploadAllAsMultiPageTIFF=function(n,m,l,k){var j=i.getSWebTwain().FTPUploadAllAsMultiPageTIFF(n,m);return f.wrapperRet(i,j,l,k)};h.FTPUploadAllAsPDF=function(n,m,l,k){var j=i.getSWebTwain().FTPUploadAllAsPDF(n,m);return f.wrapperRet(i,j,l,k)};h.FTPUploadAsMultiPagePDF=function(n,m,l,k){var j=i.getSWebTwain().FTPUploadAsMultiPagePDF(n,m);return f.wrapperRet(i,j,l,k)};h.FTPUploadAsMultiPageTIFF=function(n,m,l,k){var j=i.getSWebTwain().FTPUploadAsMultiPageTIFF(n,m);return f.wrapperRet(i,j,l,k)};h.HTTPDownload=function(m,l,p,k){var j,n=f.getImageType(l);return i.HTTPDownloadEx(m,l,n,p,k)};h.HTTPDownloadDirectly=function(n,m,j,p,l){var k;k=i.getSWebTwain().HTTPDownloadDirectly(n,m,j);return f.wrapperRet(i,k,p,l)};h.HTTPDownloadEx=function(m,l,n,p,k){var j;j=i.getSWebTwain().HTTPDownloadEx(m,l,n);return f.wrapperRet(i,j,p,k)};h.HTTPUploadThroughPostDirectly=function(n,k,j,q,p,m){var l;l=i.getSWebTwain().HTTPUploadThroughPostDirectly(n,k,j,q);return f.wrapperRet(i,l,p,m,true)};h.HTTPUploadThroughPost=function(n,m,j,q,p,l){var k;k=i.getSWebTwain().HTTPUploadThroughPost(n,m,j,q);return f.wrapperRet(i,k,p,l,true)};h.HTTPUploadThroughPostEx=function(n,m,j,r,p,q,l){var k;k=i.getSWebTwain().HTTPUploadThroughPostEx(n,m,j,r,p);return f.wrapperRet(i,k,q,l,true)};h.ClearAllHTTPFormField=function(){i.getSWebTwain().ClearAllHTTPFormField();return f.checkErrorString(i)};h.SetHTTPFormField=function(k,j){i.getSWebTwain().SetHTTPFormField(k,j);return f.checkErrorString(i)};h.HTTPUploadAllThroughPostAsMultiPageTIFF=function(m,j,p,n,l){var k;k=i.getSWebTwain().HTTPUploadAllThroughPostAsMultiPageTIFF(m,j,p);return f.wrapperRet(i,k,n,l,true)};h.HTTPUploadThroughPostAsMultiPageTIFF=function(m,j,p,n,l){var k;k=i.getSWebTwain().HTTPUploadThroughPostAsMultiPageTIFF(m,j,p);return f.wrapperRet(i,k,n,l,true)};h.HTTPUploadAllThroughPostAsPDF=function(m,j,p,n,l){var k;k=i.getSWebTwain().HTTPUploadAllThroughPostAsPDF(m,j,p);return f.wrapperRet(i,k,n,l,true)};h.HTTPUploadThroughPostAsMultiPagePDF=function(m,j,p,n,l){var k;k=i.getSWebTwain().HTTPUploadThroughPostAsMultiPagePDF(m,j,p);return f.wrapperRet(i,k,n,l,true)};h.HTTPUploadThroughPutDirectly=function(n,k,j,p,m){var l;l=i.getSWebTwain().HTTPUploadThroughPutDirectly(n,k,j);return f.wrapperRet(i,l,p,m)};h.HTTPUploadThroughPut=function(m,l,j,p,k){var n=f.getImageType(j);return i.HTTPUploadThroughPutEx(m,l,j,n,p,k)};h.HTTPUploadThroughPutEx=function(n,m,j,p,q,l){var k;k=i.getSWebTwain().HTTPUploadThroughPutEx(n,m,j,p);return f.wrapperRet(i,k,q,l)};h.HTTPUploadAllThroughPutAsMultiPageTIFF=function(m,j,p,l){var k=-1,n=2;return i.HTTPUploadThroughPutEx(m,k,j,n,p,l)};h.HTTPUploadThroughPutAsMultiPageTIFF=function(m,j,p,l){var k=-2,n=2;return i.HTTPUploadThroughPutEx(m,k,j,n,p,l)};h.HTTPUploadAllThroughPutAsPDF=function(m,j,p,l){var k=-1,n=4;return i.HTTPUploadThroughPutEx(m,k,j,n,p,l)};h.HTTPUploadThroughPutAsMultiPagePDF=function(m,j,p,l){var k=-2,n=4;return i.HTTPUploadThroughPutEx(m,k,j,n,p,l)};h.ShowImageEditor=function(){return i.getSWebTwain().ShowImageEditor()};h.SetCookie=function(j){i.getSWebTwain().SetCookie(j);return b};h.LoadImageFromBase64Binary=function(j,k){return i.getSWebTwain().LoadImageFromBase64Binary(j,k)};h.SaveSelectedImagesToBytes=function(k,j){return i.getSWebTwain().SaveSelectedImagesToBytes(k,j)};h.LoadImageFromBytes=function(l,j,k){return i.getSWebTwain().LoadImageFromBytes(l,j,k)};h.UnregisterEvent=function(j,k){return i.getSWebTwain().UnregisterEvent(j,k)};h.SetImageWidth=function(j,k){return i.getSWebTwain().SetImageWidth(j,k)};h.HTTPDownloadThroughPost=function(m,l,n,p,k){var j;j=i.getSWebTwain().HTTPDownloadThroughPost(m,l,n);return f.wrapperRet(i,j,p,k)};h.SetCustomDSDataEx=function(j){return i.getSWebTwain().SetCustomDSDataEx(j)};h.SetCustomDSData=function(j){return i.getSWebTwain().SetCustomDSData(j)};h.GetCustomDSDataEx=function(){return i.getSWebTwain().GetCustomDSDataEx()};h.GetCustomDSData=function(j){return i.getSWebTwain().GetCustomDSData(j)};h.ChangeBitDepth=function(k,j,l){return i.getSWebTwain().ChangeBitDepth(k,j,l)};h.ConvertToGrayScale=function(j){return i.getSWebTwain().ConvertToGrayScale(j)};h.ShowImageEditorEx=function(k,n,j,m,l){return i.getSWebTwain().ShowImageEditorEx(k,n,j,m,l)};h.ClearTiffCustomTag=function(){i.getSWebTwain().ClearTiffCustomTag();return f.checkErrorString(i)};h.SetTiffCustomTag=function(k,j,l){i.getSWebTwain().SetTiffCustomTag(k,j,l);return f.checkErrorString(i)};h.IsBlankImageExpress=function(j){return i.getSWebTwain().IsBlankImageExpress(j)};h._ChangeWidth=function(k){var j=document.getElementById(h._strDWTInnerContainerID),m;if(c.isString(k)){if(k.length>0){if(k.charAt(k.length-1)==="%"){m=k}}}if(!m){var l=parseInt(k);if(l&&l>2){m=(l-2)+"px"}}if(m){i._strWidth=m;i.getSWebTwain().style.width=m;if(j){j.style.width=m}}return b};h._ChangeHeight=function(k){var j=document.getElementById(h._strDWTInnerContainerID),m;if(c.isString(k)){if(k.length>0){if(k.charAt(k.length-1)==="%"){m=k}}}if(!m){var l=parseInt(k);if(l){m=l+"px"}}if(m){i._strHeight=m;i.getSWebTwain().style.height=m;if(j){j.style.height=m}}return b};h.SetSize=function(j,k){var l=this;l._ChangeWidth(j);l._ChangeHeight(k);return b};h.SetSelectedImageArea=function(l,n,m,k,j){return i.getSWebTwain().SetSelectedImageArea(l,n,m,k,j)};h.SetVideoRotateMode=function(j){return i.getSWebTwain().SetVideoRotateMode(j)};h.SetOpenSourceTimeout=function(j){return i.getSWebTwain().SetOpenSourceTimeout(j)};h.GetLicenseInfo=function(){return{}};h.SetHTTPHeader=function(j,k){return false};h.GetImageURL=function(j,k,l){return""};h.LoadDibFromClipboard=function(l,k){var j;j=i.getSWebTwain().LoadDibFromClipboard();return f.wrapperRet(i,j,l,k)};h.LoadImage=function(j,n,l){var m=f.replaceLocalFilename(j),k;k=i.getSWebTwain().LoadImage(m);return f.wrapperRet(i,k,n,l)};h.LoadImageEx=function(k,n,q,m){var p=f.replaceLocalFilename(k),j=n,l;if(j==EnumDWT_ImageType.IT_ALL){j=-1}l=i.getSWebTwain().LoadImageEx(p,j);return f.wrapperRet(i,l,q,m)};h.EnableSource=function(l,m,k){var j;j=i.AcquireImage(l,m,k);return j};h.AcquireImage=function(s,r,p){var j=i.getSWebTwain(),q,m=null,n=null,l=null;if(c.isUndefined(p)&&(c.isFunction(s)&&c.isFunction(r)||c.isFunction(s)&&c.isUndefined(r)||c.isFunction(s)&&r==null||s==null&&c.isFunction(r))){m=null;if(c.isFunction(s)){n=s}if(c.isFunction(r)){l=r}}else{if(!c.isUndefined(s)){m=s}if(c.isFunction(r)){n=r}if(c.isFunction(p)){l=p}}if(m!==undefined&&m!==null){var k;k=m.SelectSourceByIndex;if(k!=null&&typeof(k)!="undefined"){j.SelectSourceByIndex(k);j.CloseSource();j.OpenSource()}k=m.IfShowUI;if(k!=null&&typeof(k)!="undefined"){j.IfShowUI=k}k=m.PixelType;if(k!=null&&typeof(k)!="undefined"){j.PixelType=k}k=m.Resolution;if(k!=null&&typeof(k)!="undefined"){j.Resolution=k}k=m.IfFeederEnabled;if(k!=null&&typeof(k)!="undefined"){j.IfFeederEnabled=k}k=m.IfDuplexEnabled;if(k!=null&&typeof(k)!="undefined"){j.IfDuplexEnabled=k}k=m.IfDisableSourceAfterAcquire;if(k!=null&&typeof(k)!="undefined"){j.IfDisableSourceAfterAcquire=k}}q=j.AcquireImage();return q};h._innerFun=function(j,k,l){var q=i.getSWebTwain(),n=q[j];if(typeof(n)==="function"){return n.apply(q,k)}else{return n}};h.ActiveUI=function(k,j){};h.first=function(){var j=i.HowManyImagesInBuffer,k;if(j>0){i.CurrentImageIndexInBuffer=0;i.__innerRefreshImage()}return b};h.previous=function(){var j=i.HowManyImagesInBuffer,k;if(j>0){k=i.CurrentImageIndexInBuffer;if(k>0){i.CurrentImageIndexInBuffer=k-1;i.__innerRefreshImage()}}return b};h.next=function(){var j=i.HowManyImagesInBuffer,k;if(j>0){k=i.CurrentImageIndexInBuffer;if(k>=0&&k<j-1){i.CurrentImageIndexInBuffer=k+1;i.__innerRefreshImage()}}return b};h.last=function(){var j=i.HowManyImagesInBuffer,k;if(j>0){i.CurrentImageIndexInBuffer=j-1;i.__innerRefreshImage()}return b};h.__innerRefreshImage=function(){var j=i.HowManyImagesInBuffer,k;if(j>0){k=i.CurrentImageIndexInBuffer;if(i.__OnRefreshUI){i.__OnRefreshUI(k,j)}}};h._attachEvents=function(){var j=i.getSWebTwain(),k;k=Dynamsoft.Lib.detect.getVersionArray(new String(i.VersionInfo));if(k.length<=2||k[0]<9||k[0]==9&&k[1]<=2){return}if(i.__OnPostTransfer!=""){j.RegisterEvent("OnPostTransfer",i.__OnPostTransfer)}if(i.__OnPostAllTransfers!=""){j.RegisterEvent("OnPostAllTransfers",i.__OnPostAllTransfers)}if(i.__OnMouseClick!=""){j.RegisterEvent("OnMouseClick",i.__OnMouseClick)}if(i.__OnPostLoad!=""){j.RegisterEvent("OnPostLoad",i.__OnPostLoad)}if(i.__OnImageAreaSelected!=""){j.RegisterEvent("OnImageAreaSelected",i.__OnImageAreaSelected)}if(i.__OnMouseDoubleClick!=""){j.RegisterEvent("OnMouseDoubleClick",i.__OnMouseDoubleClick)}if(i.__OnMouseRightClick!=""){j.RegisterEvent("OnMouseRightClick",i.__OnMouseRightClick)}if(i.__OnTopImageInTheViewChanged!=""){j.RegisterEvent("OnTopImageInTheViewChanged",i.__OnTopImageInTheViewChanged)}if(i.__OnImageAreaDeSelected!=""){j.RegisterEvent("OnImageAreaDeSelected",i.__OnImageAreaDeSelected)}if(i.__OnGetFilePath!=""){j.RegisterEvent("OnGetFilePath",i.__OnGetFilePath)}if(i.__OnAfterOperate!=""){j.RegisterEvent("OnAfterOperate",i.__OnAfterOperate)}if(i.__OnBeforeOperate!=""){j.RegisterEvent("OnBeforeOperate",i.__OnBeforeOperate)}if(i.__OnOperateStatus!=""){j.RegisterEvent("OnOperateStatus",i.__OnOperateStatus)}if(i.__OnBitmapChanged!=""){j.RegisterEvent("OnBitmapChanged",i.__OnBitmapChanged)}if(i.__OnMouseMove!=""){j.RegisterEvent("OnMouseMove",i.__OnMouseMove)}if(i.__OnPreAllTransfers!=""){j.RegisterEvent("OnPreAllTransfers",i.__OnPreAllTransfers)}if(i.__OnPreTransfer!=""){j.RegisterEvent("OnPreTransfer",i.__OnPreTransfer)}if(i.__OnSourceUIClose!=""){j.RegisterEvent("OnSourceUIClose",i.__OnSourceUIClose)}if(i.__OnTransferCancelled!=""){j.RegisterEvent("OnTransferCancelled",i.__OnTransferCancelled)}if(i.__OnTransferError!=""){j.RegisterEvent("OnTransferError",i.__OnTransferError)}if(i.__OnInternetTransferPercentage!=""){j.RegisterEvent("OnInternetTransferPercentage",i.__OnInternetTransferPercentage)}if(i.__OnInternetTransferPercentageEx!=""){j.RegisterEvent("OnInternetTransferPercentageEx",i.__OnInternetTransferPercentageEx)}}}})(Dynamsoft.Lib);(function(b){if(!b.product.bActiveXEdition){return}var c={noControl:function(d){if(b.isFunction(b.detect.onNoControl)){b.detect.onNoControl(d._strDWTControlContainerID,d._strWidth,d._strHeight)}else{var e=b.detect.arySTwains;for(var f=0;f<e.length;f++){var g=e[f];if(!g._vPluginExist){g._createNonInstallDivPlugin();b.show(g._strDWTNonInstallInnerContainerID);b.hide(g._strDWTInnerContainerID)}}}}};function a(d){var e=this,f=d||{};e._strDWTControlContainerID=f.containerID||"dwtcontrolContainer";e._strWidth=f.width||270;e._strHeight=f.height||350;if(b.isString(e._strWidth)&&e._strWidth.indexOf("%")>0){}else{e._strWidth=[parseInt(e._strWidth),"px"].join("")}if(b.isString(e._strHeight)&&e._strHeight.indexOf("%")>0){}else{e._strHeight=[parseInt(e._strHeight),"px"].join("")}e._strObjectName=e._strDWTControlContainerID+"_Obj";e.__config=f;e.__OnPluginReady=f.onPluginReady;e.__OnPluginNotReady=f.onPluginNotReady;e.Addon={};e._strDWTInnerContainerID=e._strDWTControlContainerID+"_CID";e._strDWTNonInstallInnerContainerID=e._strDWTControlContainerID+"_NonInstallCID";var g=document.createElement("div");document.body.appendChild(g);e._fakeControl=g;e._createControl()}a.prototype._createControl=function(){var e;var h=this,g=h._strWidth,d=h._strHeight,f;if(b.isString(g)){if(g.indexOf("%")>0){g="100%"}else{g=parseInt(g)+2+"px"}}if(b.isString(d)){if(d.indexOf("%")>0){d="100%"}else{d=parseInt(d)+2+"px"}}if(!Dynamsoft.WebTwainEnv.ActiveXInstallWithCAB){f=['<div id="',h._strDWTInnerContainerID,'" style="width:',g,";height:",d,'">','<object id="',h._strObjectName,'" style="width:',h._strWidth,";height:",h._strHeight,';border:1px solid #AAAAAA"',' classid="clsid:',Dynamsoft.WebTwainEnv.Trial?b.product.strTrialClassID:b.product.strFullClassID,'" viewastext>','<param name="wmode" value="transparent"/>',"</object>","</div>"]}else{f=['<div id="',h._strDWTInnerContainerID,'" style="width:',g,";height:",d,'">','<object id="',h._strObjectName,'" style="width:',h._strWidth,";height:",h._strHeight,';border:1px solid #AAAAAA"',' codebase="',(b.env.bWin64)?b.product.getActiveXCABx64Path():b.product.getActiveXCABx86Path(),"#version=",Dynamsoft.WebTwainEnv.ActiveXVersion,'"',' classid="clsid:',Dynamsoft.WebTwainEnv.Trial?b.product.strTrialClassID:b.product.strFullClassID,'" viewastext>','<param name="wmode" value="transparent"/>',"</object>","</div>"]}f.push('<div id="',h._strDWTNonInstallInnerContainerID,'" style="width: ',g,';display:none"></div>');e=document.getElementById(h._strDWTControlContainerID);if(e){e.innerHTML=f.join("")}h._fakeControl._objWebTwain=null;h._fakeControl.getSWebTwain=function(){var i=this;if(i._objWebTwain===null){i._objWebTwain=document.getElementById(h._strObjectName)}return i._objWebTwain}};a.prototype.getInstance=function(){var e=this,d=e._fakeControl.getSWebTwain();if(d){return e._fakeControl}return false};b.detect._controlDetect=function(){var f=b.detect.arySTwains,e=f[0],d=e&&e._fakeControl&&e._fakeControl.getSWebTwain();if(d){if(d.ErrorCode==0){clearInterval(b.detect._varSeed);for(var g=0;g<f.length;g++){var j=f[g],h=j._fakeControl.getSWebTwain();b.__innerInitEvents(j._fakeControl,j.__config);j._fakeControl.__OnRefreshUI=j.__config.onRefreshUI||"";b.attachProperty(j._fakeControl);b.attachMethod(j._fakeControl);j._fakeControl._attachEvents();b.attachAddon(j._fakeControl);h.ProductKey=Dynamsoft.WebTwainEnv.ProductKey;h.BrokerProcessType=b.product._iBrokerProcessType;if(!b.env.bWin){j._objectWebTwain.ImageCaptureDriverType=b.product._iImageCaptureDriverType}if(b.isFunction(j.__OnPluginReady)){j.__OnPluginReady()}}}else{if(!Dynamsoft.WebTwainEnv.ActiveXInstallWithCAB){if(!b.detect.bNoControlEvent){c.noControl(e);b.detect.bNoControlEvent=true}}if(b.isFunction(d.__OnPluginNotReady)){d.__OnPluginNotReady()}}}else{clearInterval(b.detect._varSeed)}};b.ie={};b.ie.DynamicWebTwain=function(d){var e=new a(d);b.detect.arySTwains.push(e);return e};b.ie.closeAll=function(){var d=b.detect.arySTwains,e,g,f;for(e=0;e<d.length;e++){g=d[e];if(g&&g._fakeControl){f=g._fakeControl.getSWebTwain();if(f&&f.ErrorCode==0){f.RemoveAllImages()}}}b.detect.arySTwains=[]};Dynamsoft.WebTwainEnv.RemoveAllAuthorizations=function(){return false}})(Dynamsoft.Lib);(function(b){if(!b.product.bPluginEdition){return}var c=document,f=navigator,e,d={noControl:function(g){if(b.isFunction(b.detect.onNoControl)){b.detect.onNoControl(g._strDWTControlContainerID,g._strWidth,g._strHeight)}else{var h=b.detect.arySTwains;for(var j=0;j<h.length;j++){var k=h[j];if(!k._vPluginExist){k._createNonInstallDivPlugin();b.show(k._strDWTNonInstallInnerContainerID);b.hide(k._strDWTInnerContainerID)}}}}};function a(g){var h=this,i=g||{};h._strDWTControlContainerID=i.containerID||"dwtcontrolContainer";h._strWidth=i.width||270;h._strHeight=i.height||350;if(b.isString(h._strWidth)&&h._strWidth.indexOf("%")>0){}else{h._strWidth=[parseInt(h._strWidth),"px"].join("")}if(b.isString(h._strHeight)&&h._strHeight.indexOf("%")>0){}else{h._strHeight=[parseInt(h._strHeight),"px"].join("")}h._strObjectName=h._strDWTControlContainerID+"_Obj";b.__innerInitEvents(h,i);h.__OnPluginReady=i.onPluginReady;h.__OnPluginNotReady=i.onPluginNotReady;h.__OnRefreshUI=i.onRefreshUI||"";h._objectWebTwain=null;h._strDWTInnerContainerID=h._strDWTControlContainerID+"_CID";h._strDWTNonInstallInnerContainerID=h._strDWTControlContainerID+"_NonInstallCID";h._vNotAllowedForChrome=false;h._vPluginExist=false;h.Addon={}}e=a.prototype;e.getSWebTwain=function(){var g=this;return g._objectWebTwain};e.getInstance=function(){var g=this;if(g._objectWebTwain){return g}return false};e._createControl=function(){var l=this,i,k=l._strWidth,h=l._strHeight,j;if(b.isString(k)){if(k.indexOf("%")>0){k="100%"}else{k=parseInt(k)+2+"px"}}if(b.isString(h)){if(h.indexOf("%")>0){h="100%"}else{h=parseInt(h)+2+"px"}}j=['<div id="',l._strDWTInnerContainerID,'" style="width:',k,";height:",h,'">'];if(b.env.bIE){if(!Dynamsoft.WebTwainEnv.ActiveXInstallWithCAB){j.push('<object id="',l._strObjectName,'" style="width:',l._strWidth,";height:",l._strHeight,';border:1px solid #AAAAAA"',' classid="clsid:',Dynamsoft.WebTwainEnv.Trial?b.product.strTrialClassID:b.product.strFullClassID,'" viewastext>','<param name="wmode" value="transparent"/>',"</object>")}else{j.push('<object id="',l._strObjectName,'" style="width:',l._strWidth,";height:",l._strHeight,';border:1px solid #AAAAAA"',' codebase="',(b.env.bWin64)?b.product.getActiveXCABx64Path():b.product.getActiveXCABx86Path(),"#version=",Dynamsoft.WebTwainEnv.ActiveXVersion,'"',' classid="clsid:',Dynamsoft.WebTwainEnv.Trial?b.product.strTrialClassID:b.product.strFullClassID,'" viewastext>','<param name="wmode" value="transparent"/>',"</object>")}}else{var g=l._strWidth;if(b.isString(g)&&g.indexOf("%")==-1){g=(parseInt(g)-2)+"px"}j.push('<embed id="',l._strObjectName,'" style="display: inline; width:',g,";height:",l._strHeight,'" type="',b.product.strMIMEType,'"',' pluginspage="',(b.env.bWin)?b.product.getMSIPath():b.product.getPKGPath(),'"></embed>')}j.push('</div><div id="',l._strDWTNonInstallInnerContainerID,'" style="width: ',k,';display:none"></div>');i=b.get(l._strDWTControlContainerID);if(i){i.innerHTML=j.join("")}l._objectWebTwain=b.get(l._strObjectName)};e._notAllowedForChrome=function(){if(!b.env.bIE){ua=(f.userAgent.toLowerCase());if(ua.match(/chrome\/([\d.]+)/)){if(this.__OnNotAllowedForChrome){this.__OnNotAllowedForChrome(_this._strDWTInnerContainerID)}else{this._createNonAllowedDivPlugin();b.get(this._strDWTNonInstallInnerContainerID).style.display="inline";b.get(this._strDWTInnerContainerID).style.display="none"}}}};e._createNonAllowedDivPlugin=function(){var k=this;o=b.get(k._strDWTNonInstallInnerContainerID);if(o.innerHTML!=""){return}var h=k._strHeight;if(b.isString(h)&&h.indexOf("%")==-1){h=(parseInt(h)-10)+"px"}var j=['<div style="display: block; border:1px solid black; width:',k._strWidth,";height:",h,'">','<div style="margin: 200px 0 0 0; padding: 5px; font-size: 16px;line-height: 30px; ">',"<div>The Component is not allowed to run on this site.</div>",'<div>Please click <img src="',Dynamsoft.WebTwainEnv.ResourcesPath+'/reference/imgs/plug-in-blocked.png"/>','at the right end of the address bar and click "<b>Always allow plug-ins</b>". Then refresh/restart the browser.</div>',"</div></div>"].join("");o.innerHTML=j;for(var g=0;g<c.links.length;g++){if(c.links[g].className=="DWT_CloseNonAllowedDiv"){c.links[g].onclick=function(){b.get(k._strDWTNonInstallInnerContainerID).style.display="none";b.get(k._strDWTInnerContainerID).style.display="inline"}}}};e._createNonInstallDivPlugin=function(){var k=this,j=b.get(k._strDWTNonInstallInnerContainerID);if(j.innerHTML!=""){return}var h="";if(Dynamsoft.WebTwainEnv.ActiveXInstallWithCAB&&b.env.bIE){var i=["<div style='display: block; border:solid black 1px; text-align:center; width:",k._strWidth,";height:",k._strHeight,"'>","<ul style='padding-top:100px;'>","<li>The Component is not installed</li>","<li>You need to download and install the ActiveX to use this sample.</li>","<li>Please follow the instructions in the information bar.</li>","</ul></div>"].join("")}else{var g=("https:"==location.protocol?"https://":"http://");if(b.product.bChromeEdition){h=b.product.getChromeEditionPath()}else{if(!Dynamsoft.WebTwainEnv.ActiveXInstallWithCAB&&b.env.bIE){if(b.env.bWin64){h=b.product.getActiveXCABx64Path()}else{h=b.product.getActiveXCABx86Path()}}else{h=(b.env.bWin)?b.product.getMSIPath():b.product.getPKGPath()}}var i=["<div style='display: block; border:solid black 1px; text-align:center; width:",k._strWidth,";height:",k._strHeight,"'>","<ul style='padding-top:100px;'>","<li>The Component is not installed</li>","<li>You need to download and install to use this sample.</li>","<li>Please click the below link to download it.</li>","<li>After the installation, please RESTART your browser.</li>","<li><a href='",h,"'>Download</a></li>","</ul></div>"].join("")}j.innerHTML=i};b.detect._controlDetect=function(){var m=b.detect.arySTwains,k=m[0],h=k&&k._objectWebTwain;if(h){if(h.ErrorCode==0){clearInterval(b.detect._varSeed);for(var n=0;n<m.length;n++){var q=m[n];b.attachProperty(q);b.attachMethod(q);q._attachEvents();b.attachAddon(q);q._objectWebTwain.ProductKey=Dynamsoft.WebTwainEnv.ProductKey;q._objectWebTwain.BrokerProcessType=b.product._iBrokerProcessType;if(!b.env.bWin){q._objectWebTwain.ImageCaptureDriverType=b.product._iImageCaptureDriverType}if(b.isFunction(q.__OnPluginReady)){q.__OnPluginReady()}}}else{var p=f.mimeTypes;if(!b.env.bIE){var g=true;f.plugins.refresh(false);if(b.env.iPluginLength!=f.plugins.length){for(var n=0;n<p.length;n++){if(p[n].type.toLowerCase().indexOf(b.product.strMIMEType.toLowerCase())>-1){location.reload()}}}for(var n=0;n<p.length;n++){if(p[n].type.toLowerCase().indexOf(b.product.strMIMEType.toLowerCase())>-1){for(var l=0;l<m.length;l++){var q=m[l];g=false;q._vPluginExist=true;if(q._vNotAllowedForChrome==false){q._notAllowedForChrome();q._vNotAllowedForChrome=true}}}}if(g&&!b.detect.bNoControlEvent){d.noControl(k);b.detect.bNoControlEvent=true}}else{if(!Dynamsoft.WebTwainEnv.ActiveXInstallWithCAB){if(!b.detect.bNoControlEvent){d.noControl(k);b.detect.bNoControlEvent=true}}}if(b.isFunction(k.__OnPluginNotReady)){k.__OnPluginNotReady()}}}else{clearInterval(b.detect._varSeed)}};b.plugin={};b.plugin.DynamicWebTwain=function(g){var h=new a(g);h._createControl();b.detect.arySTwains.push(h);return h};b.plugin.closeAll=function(){var g=b.detect.arySTwains,h,k,j;for(h=0;h<g.length;h++){k=g[h];if(k&&k._objectWebTwain){j=k._objectWebTwain;if(j&&j.ErrorCode==0){j.RemoveAllImages()}}}b.detect.arySTwains=[]};Dynamsoft.WebTwainEnv.RemoveAllAuthorizations=function(){return false}})(Dynamsoft.Lib);(function(a,H){var K=dynamsoft.navInfo,Q=dynamsoft.dcp,O=!1,T="The Dynamic Web TWAIN module is not installed.",w={curPortIndex:0,bConnected:false,versionInfo:function(Z,Y){var X=0,V=function(af,ac){var ab=[w._getPreUrl(Z[w.curPortIndex]),"f/VersionInfo?ts=",a.now()].join(""),aa,ae;aa=[H.Trial?"dwt_trial_":"dwt_",a.replaceAll(H.ServerVersionInfo,",","")].join("");ae=a.stringify({id:"1",method:"VersionInfo",version:aa,parameter:[]});if(H.OnWebTwainInitMessage){var ad="checking WebTwain version ...";H.OnWebTwainInitMessage(ad,EnumDWT_InitMsg.Info)}a.ajax({method:"POST",url:ab,data:ae,onSuccess:af,onError:ac})},W=function(){w.curPortIndex++;w.bConnected=false;if(w.curPortIndex<Z.length){setTimeout(function(){V(U,W)},1000)}else{H.OnWebTwainInitMessage&&H.OnWebTwainInitMessage(T,EnumDWT_InitMsg.NotInstalledError);Y&&setTimeout(function(){Y(O,T)},0)}},U=function(ab){var aa=Q._getJSON(ab);if(aa&&"result" in aa){aa=aa.result;if(a.isArray(aa)&&aa.length>0){Y&&setTimeout(function(){var ac=Z[w.curPortIndex],af=aa[0],ad=aa.length>1?aa[1]:"";if(ad!==""){H.OnWebTwainInitMessage&&H.OnWebTwainInitMessage(ad,EnumDWT_InitMsg.Error)}else{var ae="The WebTwain version is: "+af;H.OnWebTwainInitMessage&&H.OnWebTwainInitMessage(ae,EnumDWT_InitMsg.Info)}Y(ac,af,ad)},0);return}}setTimeout(W,1000)};w.curPortIndex=0;V(U,W)},_getPreUrl:function(U){var V;if(K.bSSL){V="https://"}else{V="http://"}return[V,dynamsoft.dcp.ip,":",U,"/"].join("")}};a.DynamicWebTwain=O;var J=window,n=J.document,k,o,R="This browser is currently not supported.",C="Duplicate ID detected for creating Dynamic Web TWAIN objects, please check and modify.",L=a.each,f="dwt",j=0,E=1,v=2,x=3,B=!0,O=!1,d=function(U){if(a.product.bPluginEdition){a.DynamicWebTwain=a.plugin.DynamicWebTwain;a.closeAll=a.plugin.closeAll;if(a.isFunction(U)){U()}}else{if(a.product.bActiveXEdition){a.DynamicWebTwain=a.ie.DynamicWebTwain;a.closeAll=a.ie.closeAll;if(a.isFunction(U)){U()}}}};a.__innerInitEvents=function(V,U){U&&L(["onAfterOperate","onBeforeOperate","onOperateStatus","onBitmapChanged","onGetFilePath","onImageAreaDeSelected","onImageAreaSelected","onMouseClick","onMouseDoubleClick","onMouseMove","onMouseRightClick","onPreAllTransfers","onPreTransfer","onPostLoad","onPostTransfer","onPostAllTransfers","onSourceUIClose","onTopImageInTheViewChanged","onTransferCancelled","onTransferError","onInternetTransferPercentage","onInternetTransferPercentageEx"],function(W){V["__O"+W.substring(1)]=U[W]||""})};a.replaceControl=function(V,U){H.ContainerMap[V]=U};k=function(af,X,ac,U){var V=(navigator.userAgent.toLowerCase()),ae=a.product;if(U&&U._customIP&&(!a.isLocalIP(U._ip))){if(a.isFunction(OnRemoteWebTwainNotFoundCallback)){var Y=U._ssl?U._portSSL:U._port;OnRemoteWebTwainNotFoundCallback(ae.name,U._ip,Y,U._ssl)}return}if(a.env.bMac){if(af){var W=a.one("#"+af);W.before(a.install._strNonInstallDIV);var ab=a.get(a.install._divDWTNonInstallContainerID);if(ab){ab.style.width=X;ab.style.height=ac}a.show(a.install._divDWTNonInstallContainerID);a.hide(af)}if(a.install._divDWTemessageContainer!=""){a.hide(a.install._divDWTemessageContainer)}if(a.isFunction(OnWebTwainNotFoundOnMacCallback)){var Z=ae.bChromeEdition?ae.getChromeEditionPath():ae.getPKGPath();OnWebTwainNotFoundOnMacCallback(ae.name,Z,ae.bChromeEdition,a.env.bIE,a.env.bSafari,a.detect.ssl,a.env.strIEVersion)}}else{if(a.env.bLinux){if(af){var W=a.one("#"+af);W.before(a.install._strNonInstallDIV);var ab=a.get(a.install._divDWTNonInstallContainerID);if(ab){ab.style.width=X;ab.style.height=ac}a.show(a.install._divDWTNonInstallContainerID);a.hide(af)}if(a.install._divDWTemessageContainer!=""){a.hide(a.install._divDWTemessageContainer)}if(a.isFunction(OnWebTwainNotFoundOnLinuxCallback)){var aa,ad;aa=ae.getLinuxHTML5DebPath();ad=ae.getLinuxHTML5RpmPath();OnWebTwainNotFoundOnLinuxCallback(ae.name,aa,ad,ae.bChromeEdition,a.env.bIE,a.env.bSafari,a.detect.ssl,a.env.strIEVersion)}}else{if(V.match(/chrome\/([\d.]+)/)||V.match(/opera.([\d.]+)/)||V.match(/version\/([\d.]+).*safari/)||V.match(/firefox\/([\d.]+)/)||H.IfUseActiveXForIE10Plus==O||(!H.ActiveXInstallWithCAB&&a.env.bIE)){if(af){var W=a.one("#"+af);W.before(a.install._strNonInstallDIV);var ab=a.get(a.install._divDWTNonInstallContainerID);if(ab){ab.style.width=X;ab.style.height=ac}a.show(a.install._divDWTNonInstallContainerID);a.hide(af)}if(a.install._divDWTemessageContainer!=""){a.hide(a.install._divDWTemessageContainer)}if(a.isFunction(OnWebTwainNotFoundOnWindowsCallback)){var Z="";if(!H.ActiveXInstallWithCAB){if(ae.bChromeEdition){Z=ae.getChromeEditionPath()}else{if(a.env.bIE){if(a.env.bWin64){Z=ae.getActiveXCABx64Path()}else{Z=ae.getActiveXCABx86Path()}}else{Z=ae.getMSIPath()}}}else{Z=ae.bChromeEdition?ae.getChromeEditionPath():ae.getMSIPath()}OnWebTwainNotFoundOnWindowsCallback(ae.name,Z,ae.bChromeEdition,a.env.bIE,a.env.bSafari,a.detect.ssl,a.env.strIEVersion)}}}}};o=function(U){var V=(navigator.userAgent.toLowerCase());if(V.match(/chrome\/([\d.]+)/)){a.one("#"+U).before(a.install._strNonInstallDIV);a.show(a.install._divDWTNonInstallContainerID);a.hide(U);if(a.install._divDWTemessageContainer!=""){a.hide(a.install._divDWTemessageContainer)}if(a.isFunction(OnWebTwainOldPluginNotAllowedCallback)){OnWebTwainOldPluginNotAllowedCallback(a.product.name)}}};a.detect.getVersionArray=function(U){var V=U.toLowerCase().replace(a.product.name.toLowerCase()+" ","");V=V.replace("trial".toLowerCase(),"");V=a.replaceAll(V,"[.]",",");return V.split(",")};a.detect.isDWTVersionLatest=function(V){if(a.isUndefined(V)){return O}var Y=V.toString().toLowerCase();var X=a.detect.getVersionArray(Y),U,Z;if(a.env.bIE&&(a.product.bPluginEdition||a.product.bActiveXEdition)){U=H.ActiveXVersion}else{if(a.product.bPluginEdition){U=H.PluginVersion}else{U=H.ServerVersionInfo}}U=a.replaceAll(new String(U),"[.]",",");Z=U.split(",");index=X.length>Z.length?X.length:Z.length;for(var W=0;W<index;W++){if(X[W]==null){X[W]=0}if(Z[W]==null){Z[W]=0}if(parseInt(X[W])<parseInt(Z[W])){return O}else{if(parseInt(X[W])>parseInt(Z[W])){return B}}}return B};var M=function(W,Z){if(a.isFunction(OnWebTwainNeedUpgradeCallback)){var U={},Y;if(a.env.bWin){if(a.product.bChromeEdition){U["default"]=a.product.getChromeEditionPath()}else{if(!H.ActiveXInstallWithCAB&&a.env.bIE){if(a.env.bWin64){U["default"]=a.product.getActiveXCABx64Path()}else{U["default"]=a.product.getActiveXCABx86Path()}}else{U["default"]=a.product.getMSIPath()}}Y=EnumDWT_PlatformType.enumWindow}else{if(a.env.bLinux){var X,V;X=a.product.getLinuxHTML5DebPath();V=a.product.getLinuxHTML5RpmPath();U["default"]=X;U.deb=X;U.rpm=V;Y=EnumDWT_PlatformType.enumLinux}else{if(a.product.bChromeEdition){U["default"]=a.product.getChromeEditionPath()}else{U["default"]=a.product.getPKGPath()}Y=EnumDWT_PlatformType.enumMac}}OnWebTwainNeedUpgradeCallback(a.product.name,U,a.product.bChromeEdition,Y,a.env.bIE,a.env.bSafari,a.detect.ssl,a.env.strIEVersion,a.detect.bPromptJSOrServerOutdated,W,Z)}},m=function(U,W){if(!a.detect.bNeedUpgradeEvent&&!a.detect.isDWTVersionLatest(W.VersionInfo)){a.detect.bNeedUpgradeEvent=B;if(!H.UseDefaultInstallUI&&a.isFunction(H.OnWebTwainNeedUpgrade)){H.OnWebTwainNeedUpgrade();return}if(W&&W._customIP&&(!a.isLocalIP(W._ip))){if(a.isFunction(OnRemoteWebTwainNeedUpgradeCallback)){var V=W._ssl?W._portSSL:W._port;OnRemoteWebTwainNeedUpgradeCallback(a.product.name,W._ip,V,W._ssl)}return}a.one("#"+U).before(a.install._strNonInstallDIV);a.show(a.install._divDWTNonInstallContainerID);a.hide(U);if(a.install._divDWTemessageContainer!=""){a.hide(a.install._divDWTemessageContainer)}M()}};var r=function(U){var V=U||{};if(V.basePath){a.env.basePath=V.basePath}if(V.pathType){a.env.pathType=V.pathType}if(!a.isUndefined(V.bDiscardBlankImage)){a.config.bDiscardBlankImage=V.bDiscardBlankImage}if(V.msgPrefix){a.config.msgPrefix=V.msgPrefix}if(V.msgSuffix){a.config.msgSuffix=V.msgSuffix}if(V.detectType){a.detect.detectType=V.detectType}if(V.tryTimes){a.detect.tryTimes=V.tryTimes}if(V.onReady){H.OnWebTwainReady=V.onReady}if(V.onNotAllowedForChrome){a.detect.onNotAllowedForChrome=V.onNotAllowedForChrome}if(V.onNoControl){a.detect.onNoControl=V.onNoControl}},G=function(X){var U=H.Containers,Y,W,aa,ab,Z;if(U.length>0){DCP_DWT_OnClickCloseInstall();if(!a.isUndefined(X)){ab=X._strDWTControlContainerID;Z=X}else{for(W=0;W<U.length;W++){if(u(U[W])){ab=U[W].ContainerId;Z=H.ContainerMap[ab];if(Z){break}}}}if(Z){if(a.product.bChromeEdition){var ac=Z.LogLevel;if(Z.ErrorCode==-2207){if(!H.UseDefaultInstallUI&&a.isFunction(H.OnWebTwainNeedUpgradeWebJavascript)){H.OnWebTwainNeedUpgradeWebJavascript(Z.ErrorString)}else{if(!a.detect.bPromptJSOrServerOutdated){a.detect.bPromptJSOrServerOutdated=B}}}}m(ab,Z)}}for(W=0;W<U.length;W++){aa=U[W].ContainerId;Y=H.ContainerMap[aa];if(Y){if(a.product.bChromeEdition){h(Y);if(Y.Width<=0||Y.Height<=0){if(Y.Width<=0){Y.Width=270}if(Y.Height<=0){Y.Height=350}}}else{Y.IfAllowLocalCache=true}}Y=null}U=null;var V=dynamsoft.initOrder;if(V[0]==f){V.splice(0,1)}H.inited=B;if(a.isFunction(H.OnWebTwainReady)){H.OnWebTwainReady()}else{if(a.isFunction(Dynamsoft_OnReady)){Dynamsoft_OnReady()}}},h=function(U){U.IfAllowLocalCache=B;U.BrokerProcessType=1;U.IfShowFileDialog=B;U.IfDisableSourceAfterAcquire=B;if(a.env.bMac||a.env.bLinux){U.ImageCaptureDriverType=3}},u=function(U){var V;if(!U||!U.ContainerId||U.ContainerId==""){return O}if(!a.get(U.ContainerId)){return O}return B},i=function(U){if(u(U)){var V;V=H.ContainerMap[U.ContainerId];if(V){return O}return B}return O},b=function(){if(!a.detect.StartWSTimeoutId&&a.detect.arySTwains.length==0){a.detect.StartWSTimeoutId=setTimeout(function(){a.detect.StartWSTimeoutId=O;a.startWS()},100)}},t=function(){if(!a.detect.StartWSByIPTimeoutId&&a.detect.arySTwainsByIP.length==0){a.detect.StartWSByIPTimeoutId=setTimeout(function(){a.detect.StartWSByIPTimeoutId=O;a.startWSByIP()},100)}};a.detect.__WebTwainCommonMain=function(U,W){var V=H.UseDefaultInstallUI;if(V){U.onNotAllowedForChrome=o;U.onNoControl=k}else{U.onNotAllowedForChrome=H.OnWebTwainOldPluginNotAllowed;U.onNoControl=H.OnWebTwainNotFound}r(U);if(a.isFunction(W)){W()}};a.detect.__WebTwainMain=function(X,V){var U,W;U={containerID:X.ContainerId||"dwtcontrolContainer",width:X.Width,height:X.Height,HTTPPort:(a.detect.ssl?443:80)};a.detect.__WebTwainCommonMain(U,function(){var aa,Y,ab,Z;if(a.product.bChromeEdition){U.onWSReady=function(ac){a.replaceControl(U.containerID,ac);if(a.isFunction(V)){V(ac)}};aa=a.DynamicWebTwain(U)}else{U.onPluginReady=function(){a.replaceControl(U.containerID,aa.getInstance())};U.onPluginNotReady=function(){if(a.isFunction(Dynamsoft_OnNotReady)){Dynamsoft_OnNotReady()}};aa=new a.DynamicWebTwain(U);ab=0;Z=H.Containers;for(Y=Z.length-1;Y>=0;Y--){_c=Z[Y];if(u(_c)){ab++}}if(a.detect.arySTwains.length==ab){a.detect._varSeed=setInterval(a.detect._controlDetect,200)}}return aa})};H.Unload=function(){var W=H.Containers,Z,U,Y,V,X;if(a.closeAll){a.closeAll()}if(W){if(a.product.bChromeEdition){X=H.ContainerMap;for(U=0;U<W.length;U++){V=W[U].ContainerId;if(V&&a.get(V)&&(V in X)){Y=X[V];if(Y){Y.__unload();delete X[V]}}}}else{X=H.ContainerMap;for(U=W.length-1;U>=0;U--){V=W[U].ContainerId;if(V){Y=a.get(V);if(Y){if((V in X)&&X[V]){delete X[V]}Y.innerHTML=""}}}}}a.page.bUnload=B;if(a.page.OnUnload){a.page.OnUnload()}};var I=function(){var W=H.Containers,V,U,X;for(U=0;U<W.length;U++){if(u(W[U])){X=W[U].ContainerId;V=H.ContainerMap[X];if(!V){setTimeout(I,200);return}}}W=null;G()},e=function(){var V,W=H.Containers,U,X=O;if(a.config.usingMainMode){return}if(!W||W.length===0){a.log("DEnv.Containers does not set.");return}a.DynamicWebTwain=a.html5.DynamicWebTwain;a.closeAll=a.html5.closeAll;for(V=W.length-1;V>=0;V--){U=W[V];if(i(U)){X=U;break}}if(!X){return}b();for(V=0;V<W.length;V++){U=W[V];if(u(U)){if(U==X){a.detect.__WebTwainMain(U,G);break}a.detect.__WebTwainMain(U)}}},y=function(){if(a.config.usingMainMode){return}d(function(){var U,V=H.Containers;if(V===O||V.length===0){a.log("DEnv.Containers does not set.");return}for(U=0;U<V.length;U++){_c=V[U];if(i(_c)){a.detect.__WebTwainMain(_c)}}setTimeout(I,100)})},z=function(ac,ab,Y,V){var Z,W=ac,aa=false;if(!a.isString(W)||W==""||!a.isFunction(a.UI.ImageUIView)){aa=true;W="_dwtNoUI_"+a.getRandom()}if(!a.product.bChromeEdition){if(a.isFunction(V)){V(R)}return O}if(H.Containers&&!aa){var X,U=H.Containers;for(X=0;X<U.length;X++){if(U[X].ContainerId==W){if(a.isFunction(V)){V(C)}return O}}}Z=H.DynamicDWTMap[W];if(Z){if(a.isFunction(Y)){Y(Z)}return B}if(ab){t()}else{b()}a.html5.CreateDWTObject(W,ab,aa,function(ae){DCP_DWT_OnClickCloseInstall();H.DynamicContainers.push(W);H.DynamicDWTMap[W]=ae;h(ae);var ad=ae.LogLevel;if(ae.ErrorCode==-2207){if(!a.detect.bPromptJSOrServerOutdated){a.detect.bPromptJSOrServerOutdated=B}}m(W,ae);if(a.isFunction(Y)){Y(ae)}})};H.Load=function(){if(a.detect.scriptLoaded){H.Unload();P()}else{setTimeout(H.Load,200)}};H.CreateDWTObject=function(V,ab,W,aa,Z,U){q();if(H.initQueue.length==0){var X,ac,Y;if(arguments.length<=3){X=dynamsoft.dcp.ip}else{X=ab;ac=W;Y=aa}setTimeout(function(){A(X,ac,Y)},10)}H.initQueue.push(arguments)};var q=function(){var U=dynamsoft.initOrder,W=O;for(var V=0;V<U.length;V++){if(U[V]==f){W=B;break}}if(!W){U.push(f)}},N=function(X,W){var V=X.split(","),U=W.split(",");return(V.length>3&&a.trim(V[0])==U[0]&&a.trim(V[1])==U[1]&&a.trim(V[2])==U[2]&&a.trim(V[3])==U[3])},g=function(V,U){if(a.isLocalIP(V)){a.LS.item("DWT_port",U);a.LS.item("DWT_ssl",K.bSSL?"true":"false")}},l=function(Y){var X,U,W="",V=Y;if(K.bMac){X="MacDWT_"}else{if(K.bLinux){X="LinuxDWT_"}else{X="WinDWT_"}}if(!K.bFileSystem){W="?t="+a.getRandom()}U=H.Trial?"Trial_":"";if(V.length>0&&V[V.length-1]!="/"){V=V+"/"}return[V,X,U,a.replaceAll(H.ServerVersionInfo,",","."),".zip",W].join("")},p=function(Y){var U,V,X="",W=Y;U="DynamicWebTWAINModule";if(!K.bFileSystem){X="?t="+a.getRandom()}V=H.Trial?"Trial":"";if(W.length>0&&W[W.length-1]!="/"){W=W+"/"}return[W,U,V,".msi",X].join("")},s=function(Z,W,U){var ad=O,aa=O,X=a.detect,Y=Z.dwtPort,ab=dynamsoft.navInfo,ac,V=1;if(ab.bWin){V=U>0?(U+1):1}if(X.dcpStatus==v){if(a.isFunction(Z.callback)){Z.callback()}return}if(Y){ac=[Y]}else{ac=[];a.each(X.ports,function(ae){if(ab.bSSL){ae.ssl&&ac.push(ae.port)}else{!ae.ssl&&ac.push(ae.port)}})}w.versionInfo(ac,function(af,ae){if(ae&&ae.length>0){if(N(ae,H.ServerVersionInfo)){a.detect.hideMask();X.dcpStatus=v;a.product.ip=dynamsoft.dcp.ip;g(dynamsoft.dcp.ip,af);if(a.isFunction(Z.callback)){Z.callback()}return}}if(W){if(V>3){a.detect.hideMask();X.dcpStatus=x;if(a.isFunction(Z.dwtFailedCallback)){Z.dwtFailedCallback()}return}else{setTimeout(function(){s(Z,B,V)},1000)}}else{var ah=l(H.ResourcesPath),ag=function(ak){var al=0;dynamsoft.dcp.loadZip(ak,al,function(){if(a.isFunction(OnWebTWAINDllDownloadSuccessful)){OnWebTWAINDllDownloadSuccessful()}if(H.OnWebTwainInitMessage){var am;if(ab.bSSL&&a.env.bFirefox){am="Please REFRESH your browser.";H.OnWebTwainInitMessage&&H.OnWebTwainInitMessage(am,EnumDWT_InitMsg.DownloadNotRestartError);return}am="The Dynamic Web TWAIN module loaded.";H.OnWebTwainInitMessage(am,EnumDWT_InitMsg.Info)}setTimeout(function(){s(Z,B,V)},3000)},aj)},aj=function(ak,an,am){a.detect.hideMask();var ap=B;if(H.OnWebTwainInitMessage){var aq="Failed to download the Dynamic Web TWAIN module.";H.OnWebTwainInitMessage(aq,EnumDWT_InitMsg.DownloadError)}if(a.isFunction(OnWebTWAINDllDownloadFailure)){var ao={},al;if(am.status==404){a.Errors.WebTwainModuleNotExist(ao);al=B}else{a.Errors.WebTwainModuleDownloadFailure(ao);al=O}ap=OnWebTWAINDllDownloadFailure(a.product.name,ao._errorCode,ao._errorString);if(al){ap=O}}if(ab.bWin){X.dcpStatus=x;if(a.isFunction(Z.dwtFailedCallback)){Z.dwtFailedCallback()}return}if(ap){a.detect.showMask();setTimeout(function(){s(Z,O,V)},500)}};if(H.OnWebTwainInitMessage){var ai="Downloading the Dynamic Web TWAIN module.";H.OnWebTwainInitMessage(ai,EnumDWT_InitMsg.Info)}new a.ajax({method:"GET",url:ah,async:true,dataType:"blob",onSuccess:ag,onError:aj})}})},D=function(Z){var X=dynamsoft.initOrder,ab=false;if(X.length>0&&X[0]===f){var ad=function(){if(H.OnWebTwainInitMessage){var af="Please download and install the Dynamic Web TWAIN.";H.OnWebTwainInitMessage(af,EnumDWT_InitMsg.Info)}if(!a.isLocalIP(dynamsoft.dcp.ip)){if(a.isFunction(OnRemoteWebTwainNotFoundCallback)){var ae=K.bSSL;OnRemoteWebTwainNotFoundCallback(a.product.name,dynamsoft.dcp.ip,Z.dwtPort,ae)}}else{k()}},V=function(){a.detect.showMask()},W=function(){a.detect.hideMask()},Y=function(){var af=false;if(a.isFunction(OnWebTwainShowUpdatingDialog)){af=OnWebTwainShowUpdatingDialog()}if(!af){var ae=['<div class="dynamsoft-dwt-dlg-tips dynamsoft-dwt-dlg-center">',"Dynamsoft Service is updating ...","</div>",'<div style="padding-top:35px"></div>'];H.ShowDialog(365,0,ae.join(""),0,1)}return true},U=function(){var ae=false;if(a.isFunction(OnWebTwainCloseUpdatingDialog)){ae=OnWebTwainCloseUpdatingDialog()}!ae&&H.CloseDialog();return true},aa=function(ae,af){ab=true;M(ae,af)},ac=function(){if(!ab){ac=null;Z.dwtFailedCallback=function(){if(a.isFunction(OnWebTWAINModuleDownloadManually)){var ag,ah={"default":p(H.ResourcesPath+"/MSI/")};if(K.bMac){ag=EnumDWT_PlatformType.enumMac}else{if(K.bLinux){ag=EnumDWT_PlatformType.enumLinux}else{ag=EnumDWT_PlatformType.enumWindow}}OnWebTWAINModuleDownloadManually(ah,ag,a.env.bSafari,a.detect.ssl)}};a.detect.showMask();s(Z,O,0);return true}var ae=a.install._dlgInstall,af=500;if(!ae||!ae.open){ab=false;af=0}setTimeout(ac,af)};dynamsoft.managerEnv.IfUpdateService=Dynamsoft.WebTwainEnv.IfUpdateService;dynamsoft.dcp.checkDcpForUpdate(ad,V,W,Y,U,aa,ac)}else{if(!a.env.stopCheckingForService){setTimeout(function(){D(Z)},1000)}}},P=function(){a.page.bUnload=O;if(a.product.bChromeEdition){q();D({callback:e,ip:dynamsoft.dcp.ip})}else{y()}},F=function(V,ac,W,aa,Z,U){var ad=O,X=O,af,Y,ab,ae;if(arguments.length<=3){ab=ac;ae=W}else{X=ac;af=W;Y=aa;ab=Z;ae=U}if(!a.product.bChromeEdition){if(a.isFunction(U)){U(R)}return O}if(!a.detect.onNoControl){a.detect.onNoControl=k}if(X&&af&&Y&&af>0&&Y>0){ad={ip:X,port:af,portSSL:Y}}z(V,ad,ab,ae)},A=function(X,V,W){if(a.detect.scriptLoaded){var U=K.bSSL?W:V;dynamsoft.dcp.ip=X;D({callback:c,ip:X,dwtPort:U})}else{setTimeout(function(){A(X,V,W)},200)}},c=function(){var Y=dynamsoft.initOrder,Z=O;if(Y.length>0&&Y[0]===f){var ad=H.initQueue,ab;if(ad.length>0){Z=B;for(ab=0;ab<ad.length;ab++){if(ab==0){var V,ae,X,ac,aa,U,W=ad[ab];if(W.length<=3&&W.length>0){V=W[0];if(W.length>1){aa=W[1]}if(W.length>2){U=W[2]}F(V,aa,U)}else{if(W.length>4){V=W[0];ae=W[1];X=W[2];ac=W[3];if(W.length>4){aa=W[4]}if(W.length>5){U=W[5]}F(V,ae,X,ac,aa,U)}}}else{F.apply(J,ad[ab])}}ad.splice(0)}}if(!Z){setTimeout(c,100)}};H.DeleteDWTObject=function(X){var W=H.DynamicDWTMap,U;if(!a.product.bChromeEdition){return O}if(W&&X in W){var V=W[X];if(V){delete W[X];V.__unload()}}for(U=0;U<H.DynamicContainers.length;U++){if(H.DynamicContainers[U]==X){H.DynamicContainers.splice(U,1);break}}a.detect.hideMask();return B};H.GetWebTwain=function(V){var X=V,W,U;W=H.Containers;if(!X&&W&&W.length>0){for(U=0;U<W.length;U++){if(u(W[U])){X=W[U].ContainerId;break}}}W=H.DynamicContainers;if(!X&&W&&W.length>0){X=W[0]}W=null;if(X&&a.get(X)){var Y=H.ContainerMap;if(Y&&(X in Y)){return Y[X]}Y=H.DynamicDWTMap;if(Y&&(X in Y)){return Y[X]}}return null};var S=function(){if(!a.isUndefined(H.ProductKey)){setTimeout(function(){var U=a.env.bFileSystem,X=a.env.basePath,V=Dynamsoft.WebTwainEnv.ResourcesPath;if(!U){var Z=V;if(typeof(Z)=="undefined"||Z==""){V=X}else{if(Z.length>0&&Z[0]!="/"&&Z.indexOf("//")<0&&X!=""){V=[X,"/",Z].join("")}}if(V.length>0&&V[V.length-1]=="/"){V=V.substr(0,V.length-1)}Dynamsoft.WebTwainEnv.ResourcesPath=V}var Y="?t=20180120",W=B;if(a.env.bSafari){W=O}a.getScript([V,"/dynamsoft.webtwain.install.js",Y].join(""),W,function(){var ab=[V,"/reference/dynamsoft_dwt_html5.css",Y].join(""),aa=function(){a.detect.scriptLoaded=B;if(H.AutoLoad){P()}};if(a.env.bSafari){a.getCss(ab);aa()}else{a.getCss(ab,aa)}})},100)}else{setTimeout(S,100)}};a.ready(function(){var U=a.get("dynamsoft_waiting");if(U){U.parentNode.removeChild(U)}S()});if(!J.Dynamsoft_OnClickInstallButton){J.Dynamsoft_OnClickInstallButton=function(){a.hide("dwt-btn-install");a.hide("dwt-install-url-div")}}a.main=function(W,U){var V=function(){if(a.DynamicWebTwain){a.WebTwain=a.DynamicWebTwain;a.product._strChromeEditionPath=a.product.getChromeEditionPath();a.product._strMSIPath=a.product.getMSIPath();a.product._strPKGPath=a.product.getPKGPath();a.product.version=H.ServerVersionInfo;a.product.IEVersion=H.ActiveXVersion;if(a.isFunction(W)){W()}if(a.product.bChromeEdition){}else{a.detect._varSeed=setInterval(a.detect._controlDetect,200)}}else{a.log("Error: the Dynamic Web Twain install failed.")}},X=function(){if(a.product.bChromeEdition){a.DynamicWebTwain=a.html5.DynamicWebTwain;a.closeAll=a.html5.closeAll;V()}else{d(V)}};a.config.usingMainMode=B;H.UseDefaultInstallUI=O;H.OnWebTwainOldPluginNotAllowed=U.onNotAllowedForChrome;H.OnWebTwainNotFound=U.onNoControl;a.ready(function(){a.detect.__WebTwainCommonMain(U,X)})}})(Dynamsoft.Lib,Dynamsoft.WebTwainEnv);
dynamsoft.managerEnv.resourcesPath = Dynamsoft.WebTwainEnv.ResourcesPath;
// patch for v13.4
(function (DL) {
	
	if(DL.env.bWin || DL.env.bWin64) 
		Dynamsoft.WebTwainEnv.ServerVersionInfo='13,3,1,0326';


	var Funs2 = DL.html5.Funs2;
	
    DL.UI.ImageUIEditor.prototype.print = function () {

		var _this = this, _viewer = _this._UIView;
        if (!_viewer || _viewer.cCurrentIndex < 0) {
            return;
        }
		var url = Funs2.getImageUrl(_viewer.BaseUrl, _viewer.cCurrentIndex, -1, -1),
			aryModelImageControl = _viewer.GetDataImageControlList();

        var objModelImageControl = aryModelImageControl[_viewer.cCurrentIndex]; 
        
        var aryPrintUrl = [];
        var objPrintUrl = new DL.UI.PrintUrl(url, objModelImageControl.imageWidth, objModelImageControl.imageHeight);
		aryPrintUrl.push(objPrintUrl);
		    
        Funs2.print(aryPrintUrl);
		return true;
	};
	
	DL.UI.ImageUIManager.prototype.Print = function (){
		var _this = this, _viewer = _this.getView();
        if (_viewer.cCurrentIndex < 0) {
            return;
        }
        var aryPrintUrl = [],
			aryModelImageControl = _viewer.GetDataImageControlList();
			
		for(i = 0; i<  aryModelImageControl.length; i++)
		{
             var url = Funs2.getImageUrl(_viewer.BaseUrl, i, -1, -1);
             var objModelImageControl = aryModelImageControl[i]; 
             var objPrintUrl = new DL.UI.PrintUrl(url, objModelImageControl.imageWidth, objModelImageControl.imageHeight);
		     aryPrintUrl.push(objPrintUrl);
		} 
        
        Funs2.print(aryPrintUrl);

		return true;
	};
})(Dynamsoft.Lib);
Dynamsoft.PdfVersion="10.2.0.1123";Dynamsoft.PdfMacVersion="2017,12,28,12,14";Dynamsoft.PdfLinuxVersion="2017,12,27,20,22";var EnumDWT_ConvertMode=EnumDWT_ConverMode={CM_DEFAULT:0,CM_RENDERALL:1,CM_AUTO:1};(function(a){if(!a.product.bChromeEdition){return}var b=function(d){var e=a.html5.Funs,c;c={PDF:{Download:function(k,n,g){var j=d,l;Dynamsoft.Lib.cancelFrome=2;var i=function(){if(Dynamsoft.Lib.isFunction(n)){n()}return true},o=function(){if(Dynamsoft.Lib.isFunction(g)){g(j.ErrorCode,j.ErrorString)}return false};if(!e.checkProductKey(j,{Core:true})){return o()}if(!e.checkProductKey(j,{PDFRasterizer:true},true)){return o()}var f=j._innerFun("GetAddOnVersion",e.makeParams("pdf"));if(a.env.bMac&&f==Dynamsoft.PdfMacVersion){i();return true}else{if(a.env.bLinux&&f==Dynamsoft.PdfLinuxVersion){i();return true}else{if(f==Dynamsoft.PdfVersion){i();return true}}}if(!k||k==""){Dynamsoft.Lib.Errors.Pdf_InvalidRemoteFilename(j);o();return false}if(e.isServerInvalid(j)){o();return false}l="get";Dynamsoft.Lib.showProgress(j,"Download",true);var m=function(q){var r=(q.total===0)?100:Math.round(q.loaded*100/q.total),s=[q.loaded," / ",q.total].join("");j._OnPercentDone([0,r,"","http"])},h=true;j._OnPercentDone([0,-1,"Downloading PDF Rasterizer Module...","http"]);if(!Dynamsoft.Lib.isFunction(n)){h=false}return e.loadHttpBlob(j,l,k,h,function(p){j._OnPercentDone([0,-1,"Loading..."]);var q=100;j.__LoadImageFromBytes(p,q,"",h,i,o)},function(){Dynamsoft.Lib.closeProgress("Download");o()},m)},ConvertToImage:function(j,n,h,k){var l=e.replaceLocalFilename(j);var g="ConvertPDFToImage";var i=function(f){e.hideMask(g);if(h){h()}return true},o=function(f){e.hideMask(g);if(k){k()}return false};e.showMask(g);d._innerSend(g,e.makeParams(l,n),true,i,o);return true},SetPassword:function(f){return d._innerFun("SetPDFPassword",e.makeParams(f))},SetConvertMode:function(f){var g=f;if(g==2){g=EnumDWT_ConvertMode.CM_RENDERALL}if(g==EnumDWT_ConvertMode.CM_RENDERALL){if(!a.html5.Funs.checkProductKey(d,{PDFRasterizer:true},true)){return false}}return d._innerFun("SetPDFConvertMode",e.makeParams(g))},GetConvertMode:function(){return d._innerFun("GetPDFConvertMode")},SetResolution:function(f){return d._innerFun("SetPDFResolution",e.makeParams(f))},IsTextBasedPDF:function(g){var h=e.replaceLocalFilename(g);return d._innerFun("IsTextBasedPDF",e.makeParams(h))}}};d.__addon=d.__addon||{};a.mix(d.__addon,c)};a.DynamicLoadAddonFuns.push(b)})(Dynamsoft.Lib);(function(a){if(!a.product.bPluginEdition&&!a.product.bActiveXEdition){return}var b=function(e){var d=false,c,f;if(e.getSWebTwain()&&e.getSWebTwain().Addon){d=true}if(!d){return false}f=e.getSWebTwain();c={PDF:{Download:function(k,g,i){var j=f.GetAddOnVersion("pdf");if(j==Dynamsoft.PdfVersion){if(Dynamsoft.Lib.isFunction(g)){g()}return true}var h=f.DownloadAddon(k);return a.wrapperRet(e,h,g,i)},ConvertToImage:function(h,k,g,j){var i=f.ConvertPDFToImage(h,k);return a.wrapperRet(e,i,g,j)},SetPassword:function(g){var h=f.SetPDFPassword(g);return a.wrapperRet(e,h)},SetConvertMode:function(h){var i=h;if(i==2){i=EnumDWT_ConvertMode.CM_RENDERALL}var g=f.SetPDFConvertMode(i);return a.wrapperRet(e,g)},SetResolution:function(h){var g=f.SetPDFResolution(h);return a.wrapperRet(e,g)},IsTextBasedPDF:function(g){var h=f.IsTextBasedPDF(g);return a.wrapperRet(e,h)}}};e.Addon=e.Addon||{};a.mix(e.Addon,c)};a.DynamicLoadAddonFuns.push(b)})(Dynamsoft.Lib);
(function(X){X.ResourcesPath="https://www.dynamsoft.com/library/dwt/Resources";X.AutoLoad=true;X.Containers=[{ContainerId:"dwtcontrolContainer",Width:270,Height:350}];X.Trial=true;X.ActiveXInstallWithCAB=false;X.IfUpdateService=false;
X.ProductKey="t0068UwAAALLuN8xmc8N9DA+/zSmASNQbLAz3ena1CuQsIeL25rnhr1dXjw44ucOQ++eeR2iYimJUdWTg8P5FXpTQrzcfBjA=";})(Dynamsoft.WebTwainEnv);
